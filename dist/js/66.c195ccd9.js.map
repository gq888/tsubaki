{"version":3,"file":"js/66.c195ccd9.js","mappings":"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","sources":["webpack://tsubaki-game-library/./src/components/GameResultModal.vue","webpack://tsubaki-game-library/./src/components/GameResultModal.vue?ec76","webpack://tsubaki-game-library/./src/components/GameControls.vue","webpack://tsubaki-game-library/./src/components/GameControls.vue?bc01","webpack://tsubaki-game-library/./src/utils/eventBus.js"],"sourcesContent":["<template>\n  <transition>\n    <div v-if=\"true\" :class=\"['lose', customClass]\" :style=\"computedModalStyle\">\n      <h1 v-if=\"title\">{{ title }}</h1>\n      <h1 v-if=\"subtitle\" class=\"small\">{{ subtitle }}</h1>\n\n      <!-- 用于显示额外内容的插槽 -->\n      <slot name=\"content\"></slot>\n\n      <!-- 用于显示卡片的插槽 -->\n      <slot name=\"cards\"></slot>\n\n      <!-- 使用 GameControls 组件替代手动按钮渲染 -->\n      <GameControls\n        :buttons=\"gameControlsButtons\"\n        @undo=\"handleAction('undo')\"\n        @goon=\"handleAction('goon')\"\n        @step=\"handleAction('step')\"\n        @auto=\"handleAction('auto')\"\n      />\n       \n       <!-- 底部空白区域，高度等于footerHeight -->\n       <!-- <div class=\"modal-footer-spacer\" :style=\"spacerStyle\"></div> -->\n    </div>\n  </transition>\n</template>\n\n<script>\nimport GameControls from \"./GameControls.vue\";\n\nexport default {\n  name: \"GameResultModal\",\n  components: {\n    GameControls\n  },\n  props: {\n    title: {\n      type: String,\n      default: \"\",\n    },\n    subtitle: {\n      type: String,\n      default: \"\",\n    },\n    buttons: {\n      type: Array,\n      default: () => [],\n    },\n    modalStyle: {\n      type: Object,\n      default: () => ({}),\n    },\n    customClass: {\n      type: String,\n      default: \"\",\n    },\n    footerHeight: {\n      type: Number,\n      default: 50, // 默认50px，转换为rem是3.125rem\n    },\n  },\n  computed: {\n    computedModalStyle() {\n      return {\n        ...this.modalStyle,\n        paddingBottom: `${this.footerHeight / 16}rem`\n      };\n    },\n    spacerStyle() {\n      return {\n        height: `${this.footerHeight / 16}rem`\n      };\n    },\n    gameControlsButtons() {\n      // 将原有的按钮配置转换为 GameControls 所需的格式\n      return this.buttons.map(button => ({\n        label: button.text,\n        action: button.callback.name || button.text.toLowerCase(),\n        disabled: button.disabled,\n        callback: button.callback\n      }));\n    }\n  },\n  methods: {\n    handleAction(action) {\n      // 根据动作类型找到对应的按钮并执行其回调\n      const button = this.buttons.find(btn => {\n        const actionName = btn.callback.name || btn.text.toLowerCase();\n        return actionName === action;\n      });\n      \n      if (button && button.callback) {\n        button.callback();\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n@import url(\"./sum.css\");\n\n/* GameControls 组件会自动处理按钮样式，这里不需要额外的样式 */\n</style>\n","import { render } from \"./GameResultModal.vue?vue&type=template&id=4d019896&scoped=true\"\nimport script from \"./GameResultModal.vue?vue&type=script&lang=js\"\nexport * from \"./GameResultModal.vue?vue&type=script&lang=js\"\n\nimport \"./GameResultModal.vue?vue&type=style&index=0&id=4d019896&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4d019896\"]])\n\nexport default __exports__","<template>\n  <div class=\"btns\">\n    <input\n      v-for=\"(button, index) in displayButtons\"\n      :key=\"button.id || index\"\n      type=\"button\"\n      :value=\"button.label\"\n      :disabled=\"button.disabled\"\n      @click=\"handleButtonClick(button.action)\"\n    />\n  </div>\n</template>\n\n<script>\nimport eventBus from \"../utils/eventBus.js\";\n\nexport default {\n  name: \"GameControls\",\n  props: {\n    // 使用数组定义按钮配置，优先级高于单独的show属性\n    buttons: {\n      type: Array,\n      default: () => [],\n    },\n    // 组件唯一标识，用于事件总线通信\n    instanceId: {\n      type: String,\n      default: () => `gameControls_${Math.random().toString(36).substr(2, 9)}`,\n    },\n\n    // 以下属性保持向后兼容性\n    showUndo: {\n      type: Boolean,\n      default: true,\n    },\n    showRestart: {\n      type: Boolean,\n      default: true,\n    },\n    showStep: {\n      type: Boolean,\n      default: true,\n    },\n    showAuto: {\n      type: Boolean,\n      default: true,\n    },\n\n    undoDisabled: {\n      type: Boolean,\n      default: false,\n    },\n    restartDisabled: {\n      type: Boolean,\n      default: false,\n    },\n    stepDisabled: {\n      type: Boolean,\n      default: false,\n    },\n    autoDisabled: {\n      type: Boolean,\n      default: false,\n    },\n    isAutoRunning: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  \n  // 使用watch监听按钮配置变化\n  watch: {\n    displayButtons: {\n      handler(newButtons) {\n        // 向事件总线广播按钮配置\n        eventBus.emit('game-controls:buttons-updated', {\n          instanceId: this.instanceId,\n          buttons: newButtons\n        });\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  \n  computed: {\n    // 根据buttons数组或单独的show属性生成要显示的按钮列表\n    displayButtons() {\n      // 如果提供了buttons数组，则使用它\n      if (this.buttons && this.buttons.length > 0) {\n        return this.buttons;\n      }\n\n      // 否则使用单独的show属性生成默认按钮列表（保持向后兼容）\n      const defaultButtons = [];\n\n      if (this.showUndo) {\n        defaultButtons.push({\n          label: \"◀︎\",\n          action: \"undo\",\n          disabled: this.undoDisabled,\n        });\n      }\n\n      if (this.showRestart) {\n        defaultButtons.push({\n          label: \"RESTART\",\n          action: \"goon\",\n          disabled: this.restartDisabled,\n        });\n      }\n\n      if (this.showAuto) {\n        defaultButtons.push({\n          label: this.isAutoRunning ? \"STOP\" : \"AUTO\",\n          action: \"auto\",\n          disabled: this.autoDisabled,\n        });\n      }\n\n      if (this.showStep) {\n        defaultButtons.push({\n          label: \"►\",\n          action: \"step\",\n          disabled: this.stepDisabled,\n        });\n      }\n\n      return defaultButtons;\n    },\n  },\n  methods: {\n    // 统一的按钮点击事件处理\n    handleButtonClick(action) {\n      this.$emit(action);\n    },\n\n    // 保留原有方法以保持兼容性\n    undo() {\n      this.$emit(\"undo\");\n    },\n    goon() {\n      this.$emit(\"goon\");\n    },\n    stepFn() {\n      this.$emit(\"step\");\n    },\n    pass() {\n      this.$emit(\"auto\");\n    },\n  },\n  \n  mounted() {\n    // 组件挂载时通知事件总线\n    eventBus.emit('game-controls:mounted', {\n      instanceId: this.instanceId,\n      buttons: this.displayButtons\n    });\n  },\n  \n  beforeUnmount() {\n    // 组件卸载时通知事件总线\n    eventBus.emit('game-controls:unmounted', {\n      instanceId: this.instanceId\n    });\n  },\n};\n</script>\n\n<style scoped>\n@import url(\"./sum.css\");\n\n/* 保持与原样式一致的按钮容器样式 */\n.btns {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.25rem 0;\n  flex-wrap: wrap;\n}\n\n/* 覆盖原有input样式以确保按钮一致性 */\n.btns input {\n  margin: 0.5rem 0;\n  color: #3c4245;\n  padding: 0.25rem 0.625rem;\n  border: 0.0625rem solid #dfcdc3;\n  background-color: #dfcdc3;\n  cursor: pointer;\n  font-size: 0.875rem;\n}\n\n.btns input:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n</style>\n","import { render } from \"./GameControls.vue?vue&type=template&id=63e7e383&scoped=true\"\nimport script from \"./GameControls.vue?vue&type=script&lang=js\"\nexport * from \"./GameControls.vue?vue&type=script&lang=js\"\n\nimport \"./GameControls.vue?vue&type=style&index=0&id=63e7e383&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-63e7e383\"]])\n\nexport default __exports__","// 简单的事件总线实现\nclass EventBus {\n  constructor() {\n    this.events = {};\n  }\n\n  // 订阅事件\n  on(event, callback) {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    this.events[event].push(callback);\n  }\n\n  // 取消订阅\n  off(event, callback) {\n    if (!this.events[event]) return;\n    \n    if (callback) {\n      // 移除特定回调\n      this.events[event] = this.events[event].filter(cb => cb !== callback);\n    } else {\n      // 移除所有回调\n      delete this.events[event];\n    }\n  }\n\n  // 发布事件\n  emit(event, ...args) {\n    if (!this.events[event]) return;\n    \n    this.events[event].forEach(callback => {\n      callback(...args);\n    });\n  }\n}\n\n// 导出单例实例\nexport default new EventBus();"],"names":["class","_createBlock","_Transition","_createElementBlock","_normalizeClass","$props","customClass","style","_normalizeStyle","$options","computedModalStyle","title","_hoisted_1","_toDisplayString","subtitle","_hoisted_2","_renderSlot","_ctx","$slots","undefined","_createVNode","_component_GameControls","buttons","gameControlsButtons","onUndo","_cache","$event","handleAction","onGoon","onStep","onAuto","name","components","GameControls","props","type","String","default","Array","modalStyle","Object","footerHeight","Number","computed","this","paddingBottom","spacerStyle","height","map","button","label","text","action","callback","toLowerCase","disabled","methods","find","btn","actionName","__exports__","render","_Fragment","_renderList","displayButtons","index","key","id","value","onClick","handleButtonClick","instanceId","Math","random","toString","substr","showUndo","Boolean","showRestart","showStep","showAuto","undoDisabled","restartDisabled","stepDisabled","autoDisabled","isAutoRunning","watch","handler","newButtons","eventBus","emit","deep","immediate","length","defaultButtons","push","$emit","undo","goon","stepFn","pass","mounted","beforeUnmount","EventBus","constructor","events","on","event","off","filter","cb","args","forEach"],"sourceRoot":""}