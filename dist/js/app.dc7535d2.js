(function(){"use strict";var e={432:function(e,t,s){s(4114),s(8111),s(7588);class i{constructor(){this.listeners=[]}getDelay(e){const t=localStorage.getItem(`game-delay-${e}`);if(t)return parseInt(t);const s=localStorage.getItem("game-global-delay");return s?parseInt(s):500}saveDelay(e,t,s=!1){if(s){localStorage.setItem("game-global-delay",t.toString());const e=Object.keys(localStorage);e.forEach(e=>{e.startsWith("game-delay-")&&"game-global-delay"!==e&&localStorage.removeItem(e)})}else e&&localStorage.setItem(`game-delay-${e}`,t.toString());this.notifyListeners(t,s,e)}reset(){localStorage.clear()}addListener(e){this.listeners.push(e)}removeListener(e){const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}notifyListeners(e,t,s){this.listeners.forEach(i=>{try{i({delay:e,applyToAll:t,gameName:s})}catch(r){console.error("Error in settings listener:",r)}})}}t.A=new i},2771:function(e,t,s){var i=s(5130),r=s(6768);const o={id:"app"};function n(e,t){const s=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",o,[(0,r.bF)(s)])}var a=s(1241);const l={},c=(0,a.A)(l,[["render",n]]);var h=c,d=s(1387),u=s(4232);const g={class:"row center"},f={class:"scrore"},m={class:"row"},p={class:"cardsul"},y={class:"row",style:{"margin-top":"0.625rem"}},v={class:"cardsul reverse"},w={class:"row center"},b={class:"scrore"};function k(e,t,s,i,o,n){const a=(0,r.g2)("CardImage"),l=(0,r.g2)("GameControls"),c=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(c,(0,r.v6)(e.gameLayoutProps,{"win-buttons":[{label:"GO ON",action:"goon",callback:e.goon}],"win-modal-style":{backgroundColor:"rgba(0, 0, 0, 0.7)"},"win-custom-class":"lose","lose-buttons":[{label:"AGAIN",action:"goon",callback:e.goon}],"lose-modal-style":{backgroundColor:"rgba(0, 0, 0, 0.7)"},"lose-custom-class":"lose","draw-buttons":[{label:"GO ON",action:"goon",callback:e.goon}],"draw-modal-style":{backgroundColor:"rgba(0, 0, 0, 0.7)"},"draw-custom-class":"draw lose",onGoon:e.goon}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",g,[t[0]||(t[0]=(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/17.webp"},null,-1)),(0,r.Lk)("span",f,(0,u.v_)(e.score1),1)]),(0,r.Lk)("div",m,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",p,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.arr1,e=>((0,r.uX)(),(0,r.Wv)(a,{key:e.id,class:"card","card-id":e.id},null,8,["card-id"]))),128))])])]),(0,r.Lk)("div",y,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",v,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.arr2,e=>((0,r.uX)(),(0,r.Wv)(a,{key:e.id,class:"card","card-id":e.id},null,8,["card-id"]))),128))])])]),(0,r.Lk)("div",w,[t[1]||(t[1]=(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/32.webp"},null,-1)),(0,r.Lk)("span",b,(0,u.v_)(e.score2),1)])]),"bottom-controls":(0,r.k6)(()=>[(0,r.bF)(l,{buttons:[{label:"HIT",action:"hitBtn",disabled:e.stepDisabled},{label:"PASS",action:"passBtn",disabled:e.autoDisabled}],onHitBtn:e.handleHitBtn,onPassBtn:e.pass},null,8,["buttons","onHitBtn","onPassBtn"])]),_:1},16,["win-buttons","lose-buttons","draw-buttons","onGoon"])}s(4114),s(8111),s(1701),s(2489),s(7588);class C{constructor(e={}){this.hitflag=!0,this.winflag=!1,this.loseflag=!1,this.drawflag=!1,this.history=[],this.isAutoRunning=!1,this.autoInterval=null,this.autoStepDelay=e.autoStepDelay/10||500,this.maxSteps=e.maxSteps||400,this._listeners={}}init(){this.hitflag=!0,this.winflag=!1,this.loseflag=!1,this.drawflag=!1,this.history=[],this.stopAuto(),this.emit("init")}recordOperation(e,t=!1){t?this.history.unshift(e):this.history.push(e),this.emit("historyUpdate",this.history)}undo(){if(0===this.history.length)return null;const e=this.history.pop();return this.emit("undo",e),this.emit("historyUpdate",this.history),this.winflag=!1,this.loseflag=!1,this.drawflag=!1,e}getStepCount(){return this.history.length}canUndo(){return this.history.length>0&&this.hitflag&&!this.isAutoRunning}async startAuto(e){if(this.isAutoRunning||this.winflag||this.loseflag||this.drawflag)return void console.log(`startAuto被跳过: isAutoRunning=${this.isAutoRunning}, win=${this.winflag}, lose=${this.loseflag}, draw=${this.drawflag}`);console.log("开始自动模式..."),this.isAutoRunning=!0,this.emit("autoStart");let t=0;try{while(this.isAutoRunning&&!this.winflag&&!this.loseflag&&!this.drawflag&&t<this.maxSteps)await e(),t++,await this.wait();t>=this.maxSteps&&(console.log(`达到最大步数${this.maxSteps}`),this.stopAuto())}catch(s){console.error("Auto mode error:",s)}finally{console.log(`自动模式结束，总共执行了${t}步`),this.stopAuto()}}stopAuto(){this.isAutoRunning&&(this.isAutoRunning=!1,this.autoInterval&&(clearInterval(this.autoInterval),this.autoInterval=null),this.emit("autoStop"))}setAutoStepDelay(e){this.autoStepDelay=e,this.emit("delayChanged",e)}getAutoStepDelay(){return this.autoStepDelay}async wait(e=null){const t=null!==e?e:this.autoStepDelay;return this.emit("beforeWait",t),new Promise(e=>setTimeout(e,t))}async step(e){if(this.hitflag&&!this.winflag&&!this.loseflag&&!this.drawflag){this.hitflag=!1;try{await e()}catch(t){console.error("Step error:",t)}finally{this.hitflag=!0}}}setWin(){this.winflag=!0,this.stopAuto(),this.emit("win")}setLose(){this.loseflag=!0,this.stopAuto(),this.emit("lose")}setDraw(){this.drawflag=!0,this.stopAuto(),this.emit("draw")}reset(e){this.stopAuto(),this.init(),e&&e(),this.emit("reset")}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){if(!this._listeners[e])return;const s=this._listeners[e].indexOf(t);s>-1&&this._listeners[e].splice(s,1)}emit(e,t){this._listeners[e]&&this._listeners[e].forEach(s=>{try{s(t)}catch(i){console.error(`Error in event listener for ${e}:`,i)}})}getState(){return{hitflag:this.hitflag,winflag:this.winflag,loseflag:this.loseflag,drawflag:this.drawflag,step:this.getStepCount(),isAutoRunning:this.isAutoRunning}}setState(e){Object.assign(this,e),this.emit("stateChange",this.getState())}static getDefaultComputedProperties(){return{hitflag(){const e=this.gameManager;return!e||e.hitflag},overflag(){const e=this.gameManager;return!!e&&(e.winflag||e.loseflag||e.drawflag)},winflag(){const e=this.gameManager;return!!e&&e.winflag},loseflag(){const e=this.gameManager;return!!e&&e.loseflag},drawflag(){const e=this.gameManager;return!!e&&e.drawflag},step(){const e=this.gameManager;return e?e.getStepCount():0},undoDisabled(){const e=this.gameManager;return!e||!e.canUndo()},restartDisabled(){const e=this.gameManager;return!e||!e.hitflag||e.isAutoRunning},stepDisabled(){const e=this.gameManager;return!e||!e.hitflag||e.isAutoRunning||this.overflag},autoDisabled(){const e=this.gameManager;return!e||!e.hitflag||this.overflag},canOperate(){const e=this.gameManager;return e&&e.hitflag&&!e.isAutoRunning},gameState(){const e=this.gameManager;return e?e.getState():{}}}}}var x=s(432);function M(e,t){let s,i,r=t-1;for(let o=0;o<1e3;o++)s=Math.floor(E()*r),i=e[r],e[r]=e[s],e[s]=i;return e}function S(e,t){if(!t)return!1;for(let s=0;s<t.length;s++)if(e[s]!=t[s])return!1;return!0}function L(e,t){for(let s=0;s<e.length>>1;s++){if(!S(e[s],t))continue;let i,r={};for(i=0;i<s;i++)if(r[e[s].join(".")]=r[e[s].join(".")]?r[e[s].join(".")]+1:1,!S(e[i],e[i+s+1]))break;if(i>=s)return s>40&&console.log("dead foreach",e,t,s),!1;let o=Object.values(r).indexOf(1);if(o<0)return!1}return!0}let _=1234;function P(e){_=e}function E(){return _=(9301*_+49297)%233280,_/233280}var I=s(5249);const T={cardGame:(e,t=500)=>F(e,{autoStepDelay:t,hasUndo:!0,hasRestart:!0}),simpleGame:(e,t=1e3)=>F(e,{autoStepDelay:t,hasUndo:!1,hasRestart:!0,customInit(){this.title&&this.title.includes("FISHING")&&(this.stepFn=async()=>{await this.gameManager.step(async()=>{let e,t=this["cards"+(this.step%4+1)];while(t.length<=0)this.gameManager.recordOperation(),t=this["cards"+(this.step%4+1)];for(await this.hit(t,this.arr),e=1;e<=4;e++)if(this.step%4+1!=e&&this["cards"+e].length>0)break;e>4?this.gameManager.setWin():this.gameManager.recordOperation()})}),this.title&&"Month"===this.title&&(this.stepFn=async()=>{this.cards2[12]>=4&&this.gameManager.setLose(),await this.gameManager.step(async()=>{await this.hit()})})}}),pairGame:(e,t=500,s={})=>F(e,{autoStepDelay:t,hasUndo:!1,hasRestart:!0,methods:s,customCleanup(){this._timer&&clearInterval(this._timer)}}),puzzleGame:(e,t=800,s={})=>F(e,{autoStepDelay:t,hasUndo:!0,hasRestart:!0,methods:s,customInit(){this.title&&(this.title.includes("24")||this.title.includes("PUZZLE"))&&(this.showHint=function(){console.log("显示提示")})}}),strategyGame:(e,t=1200)=>F(e,{autoStepDelay:t,hasUndo:!0,hasRestart:!0,customInit(){this.difficulty="normal",this.setDifficulty=function(e){this.difficulty=e}}}),actionGame:(e,t=300)=>F(e,{autoStepDelay:t,hasUndo:!1,hasRestart:!0,customInit(){this.score=0,this.combo=0,this.addScore=function(e){this.score+=e*(this.combo+1),this.combo++},this.resetCombo=function(){this.combo=0}}}),customGame:(e,t={})=>{const{autoStepDelay:s=500,hasUndo:i=!0,hasRestart:r=!0,features:o=[],customLogic:n=null}=t;return F(e,{autoStepDelay:s,hasUndo:i,hasRestart:r,customInit(){o.forEach(e=>{switch(e){case"timer":this.gameTime=0,this._gameTimer=null,this.startTimer=function(){this._gameTimer=setInterval(()=>{this.gameTime++},1e3)},this.stopTimer=function(){this._gameTimer&&(clearInterval(this._gameTimer),this._gameTimer=null)};break;case"score":this.score=0,this.highScore=parseInt(localStorage.getItem(`${this.title}_highScore`)||"0"),this.updateScore=function(e){this.score+=e,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem(`${this.title}_highScore`,this.highScore.toString()))};break;case"difficulty":this.difficulty="normal",this.setDifficulty=function(e){this.difficulty=e;const t={easy:800,normal:500,hard:300};this.gameManager.setAutoStepDelay(t[e]||500)};break}}),n&&"function"===typeof n&&n.call(this)},customCleanup(){this._gameTimer&&clearInterval(this._gameTimer)}})}};const A={month:"The game has 13 positions (12 months + 1 deck). Each turn, take the top card from the current position and move it to the position corresponding to its value. If the deck reaches 4 cards, the game ends.",fish:"A 4-player game where each player starts with cards. On your turn, draw the top card from your deck. If it matches a card in the center, collect those cards. Special cards let you take cards from other players. The player who collects all cards wins.",point24:"Use 4 given numbers and apply +, -, ×, ÷ operations to make the result equal to 24. Each number can be used exactly once. You can combine numbers by selecting an operator and clicking cards to perform calculations.",Tortoise:"A card matching game with hierarchical dependencies. Cards have z-index priorities and connection requirements. Match cards of the same value pair (cards with same base number). Cards can only be matched when all their prerequisite cards are already matched. Complete all pairs to win.",Sort:"A card sorting puzzle with 3 difficulty modes: simple (by number), medium (by color), and hard (by suit). Move cards to empty slots following specific rules. Cards can only be placed in valid positions. The goal is to arrange all cards in the correct order.",Pairs:"A memory matching game with 48 cards. Flip cards to find pairs. Cards are paired based on their base value (4 cards share the same base value). Find all matching pairs as quickly as possible to win.",Spider:"A classic Spider Solitaire game with 52 standard playing cards. Arrange cards in descending order by number. Cards can be moved in sequences to build foundations. The goal is to sort all cards by suit and rank to win.",GridBattle:"A strategy game on a 6x6 grid with two types of pieces: high (1) and low (0) grade. Pieces move according to specific rules defined by their positions. Win by eliminating all opponent's pieces of the opposite grade, or reach a draw when only one of each remains.",blackjack:"A card game using a 54-card deck. The goal is to get as close to 21 as possible without exceeding it. Cards 2-10 are worth their face value, J/Q/K are worth 10, and Aces can be worth 1 or 11. If your score exceeds 21, you bust. Both player and dealer start with 2 cards.",NumberMaze:"A 6x6 grid puzzle game with numbered blocks. Move number blocks to adjacent empty spaces to create a valid path from start (0) to end (99). The path must have strictly increasing numbers. Use strategy to rearrange blocks and find the optimal path. Win when a valid ascending path exists from start to end.",NumberSequence:"A strategic puzzle game on a 5x5 grid with numbered blocks (1-9). Build ascending sequences by selecting adjacent numbers (minimum 3). Selected sequences are cleared and blocks fall down to fill gaps. Clear all numbers to win. Plan your moves carefully as sequences must be strictly increasing and adjacent."};let $,O,z,G;function F(e,t={}){const{computed:s={},methods:i={},autoStepDelay:r=500,hasUndo:o=!0,hasRestart:n=!0,customInit:a=null,customCleanup:l=null}=t;return{...e,components:{...e.components,GameResultModal:$,GameControls:O,GameLayout:z,CardImage:G},data(){const t=e.data?e.data.call(this):{};return{types:I.bt,point:I.P_,...t,gameManager:new C({autoStepDelay:r}),customButtons:[]}},created(){this.setSeed(this.seed?this.seed:Date.now()),this.gameManager.init(),this.loadDelaySettings(),this._settingsChangeHandler=this.handleSettingsChanged.bind(this),x.A.addListener(this._settingsChangeHandler),this.handleUndo&&this.gameManager.on("undo",this.handleUndo),this.gameManager.on("beforeWait",()=>{this.renderTextView&&"function"===typeof this.renderTextView&&this.renderTextView()}),this.gameManager.on("historyUpdate",()=>{this.handleHistoryUpdate&&"function"===typeof this.handleHistoryUpdate&&this.handleHistoryUpdate(),this.autoCalc&&"function"===typeof this.autoCalc&&this.autoCalc()}),a&&a.call(this),e.created&&e.created.call(this),this.init&&this.init()},beforeUnmount(){this.gameManager.stopAuto(),this.gameManager.off("undo"),this.gameManager.off("beforeWait"),this.gameManager.off("historyUpdate"),this._settingsChangeHandler&&x.A.removeListener(this._settingsChangeHandler),l&&l.call(this),e.beforeUnmount&&e.beforeUnmount.call(this)},computed:{...C.getDefaultComputedProperties(),displayButtons(){const e=[];return o&&e.push({label:"◀︎",action:"undo",disabled:this.undoDisabled,id:"undo-btn"}),n&&e.push({label:"RESTART",action:"goon",disabled:this.restartDisabled,id:"restart-btn"}),e.push({label:this.isAutoRunning?"STOP":"AUTO",action:"auto",disabled:this.autoDisabled,id:"auto-btn"}),e.push({label:"►",action:"step",disabled:this.stepDisabled,id:"step-btn"}),e},gameLayoutProps(){const e=this.$route?.path?.substring(1)||"";return{title:this.title,displayButtons:this.displayButtons,winflag:this.winflag,loseflag:this.loseflag,drawflag:this.drawflag,step:this.step,gameRule:A[e],customButtons:this.collectedGameButtons}},collectedGameButtons(){return[...this.displayButtons,...this.customButtons.filter(e=>e.action)]},...e.computed,...s},methods:{getCardPlaceholderText:I.zT,setSeed(e){this.seed=e,P(e)},async wait(e=null){return this.gameManager.wait(e)},undo(){this.gameManager.undo()},async pass(){this.gameManager.isAutoRunning?this.gameManager.stopAuto():await this.gameManager.startAuto(async()=>{let e=new WeakMap,t=[];const s=function(s,i){if("string"!==typeof s||!s.startsWith("_")){if("object"===typeof i&&null!==i){if(e.has(i))return;const r=t.join(".")+(s?"."+s:"");e.set(i,r),t.push(s)}return i}},i=JSON.stringify(this.$data,s);await this.stepFn(),e=new WeakMap,t=[];const r=JSON.stringify(this.$data,s);i===r&&(console.warn("移动无效，游戏可能陷入死锁"),this.gameManager.stopAuto())})},goon(){this.gameManager.reset(()=>{this.init&&this.init()})},loadDelaySettings(){const e=this.$route?.path?.substring(1)||"",t=x.A.getDelay(e);this.gameManager.setAutoStepDelay(t)},handleSettingsChanged(e){const t=this.$route?.path?.substring(1)||"";(e.applyToAll||e.gameName===t)&&this.gameManager.setAutoStepDelay(e.delay)},getAvailableActions(){const e=[],t={undo:"undo",goon:"goon",step:"stepFn",auto:"pass"};return this.collectedGameButtons.forEach((s,i)=>{const r=s.method||t[s.action]||s.action;this[r]&&"function"===typeof this[r]?e.push({id:i+1,label:s.label||`${s.action.toUpperCase()}`,method:r,args:s.args||[],disabled:s.disabled||!1}):console.log(`未找到对应方法 ${r} 的操作按钮 ${s.action}`)}),e.filter(e=>!e.disabled)},...e.methods,...i}}}"undefined"===typeof window?($={name:"GameResultModal",template:"<div>Mock GameResultModal</div>",props:["title","subtitle","buttons","show"]},O={name:"GameControls",template:"<div>Mock GameControls</div>",props:["canUndo","canGoon","canRestart","canAuto","canStep"]},z={name:"GameLayout",template:"<div><slot name='game-content'></slot></div>",props:["title","winflag","loseflag","drawflag"]},G={name:"CardImage",template:"<div>Mock CardImage</div>",props:["src","alt"]}):($=(0,r.$V)(()=>s.e(115).then(s.bind(s,6115))),O=(0,r.$V)(()=>s.e(109).then(s.bind(s,4109))),z=(0,r.$V)(()=>s.e(304).then(s.bind(s,3304))),G=(0,r.$V)(()=>s.e(279).then(s.bind(s,9279))));const N={name:"Sum",data(){return{title:"BlackJack",cardsChg:[],arr1:[],arr2:[],number:54}},component:[],methods:{init(){this.arr1.splice(0),this.arr2.splice(0),0===this.cardsChg.length?this.refillCards():console.log("使用现有牌堆，剩余:",this.cardsChg.length,"张"),this.hit(this.arr1),this.hit(this.arr2),this.hit(this.arr1),this.hit(this.arr2)},hit(e){0===this.cardsChg.length&&(console.log("牌堆已空，重新洗牌..."),this.refillCards());var t=this.cardsChg.shift(),s=t>>2;e.push({id:t,value:++s>10?10:s}),this.gameManager.recordOperation()},refillCards(){this.cardsChg.splice(0);for(let e=0;e<this.number;e++)this.cardsChg.push(e);M(this.cardsChg,this.cardsChg.length),console.log("重新洗牌完成，新牌堆:",this.cardsChg.length,"张")},getScore(e){let t=0,s=this["arr"+e],i=!1;for(let r=0;r<s.length;r++)t+=s[r].value,1===s[r].value&&(i=!0);return t<=11&&!0===i?t+=10:t>21&&(t=0,2==e?this.gameManager.setLose():this.gameManager.setWin()),t},async stepFn(){this.score1===this.score2?this.gameManager.setDraw():this.score1<this.score2?this.hit(this.arr1):this.score1>this.score2&&this.gameManager.setLose()},handleHitBtn(){this.hit(this.arr2)},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║            黑杰克 (BlackJack)                 ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step}\n`),console.log("规则: 点数接近21获胜，超过21爆牌"),console.log("━━━ 牌堆 ━━━");const e=this.cardsChg?this.cardsChg.length:0;console.log(`  剩余: ${e} 张\n`),console.log("━━━ 庄家 ━━━");const t=this.getScore(1);if(this.arr1&&this.arr1.length>0){const e=this.arr1.map(e=>(0,I.zT)(e.id)).join(" ");console.log(`  ${e}`),console.log(`  分数: ${t}${t>21?" 💥 爆牌!":21===t?" 🎉 BlackJack!":""}\n`)}else console.log("  (无牌)\n");console.log("━━━ 玩家 ━━━");const s=this.getScore(2);if(this.arr2&&this.arr2.length>0){const e=this.arr2.map(e=>(0,I.zT)(e.id)).join(" ");console.log(`  ${e}`),console.log(`  分数: ${s}${s>21?" 💥 爆牌!":""}\n`)}else console.log("  (无牌)\n");return"渲染完成"},getAvailableActions(){const e=[];e.push({id:1,label:"重新开始 (RESTART)",method:"goon",args:[]});const t=this.getScore(1);return t<21&&e.push({id:2,label:"摘牌 (HIT)",method:"handleHitBtn",args:[]}),e.push({id:3,label:"停牌 (PASS)",method:"pass",args:[]}),e}},computed:{score1:function(){return this.getScore(1)},score2:function(){return this.getScore(2)}}};var B=T.strategyGame(N,1e3);const R=B;var X=R;const D=(0,a.A)(X,[["render",k],["__scopeId","data-v-453a8438"]]);var W=D;const U={class:"row flex-row",style:{"padding-top":"0.625rem","justify-content":"space-around"}},j={class:"flex-col center rela",style:{"max-width":"25%"}},V={class:"scrore"},q={class:"flex-col center rela",style:{"max-width":"25%"}},H={class:"scrore"},K={class:"flex-col center rela",style:{"max-width":"25%"}},Q={class:"scrore"},J={class:"flex-col center rela",style:{"max-width":"25%"}},Y={class:"scrore"},Z={class:"row"},ee={class:"cardsul",style:{"padding-left":"0",margin:"0","min-height":"9.375rem"}},te=["src"];function se(e,t,s,i,o,n){const a=(0,r.g2)("message"),l=(0,r.g2)("CardImage"),c=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(c,(0,r.v6)(e.gameLayoutProps,{"win-title":"",onStep:e.stepFn,onAuto:e.pass,onGoon:e.goon}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",U,[(0,r.Lk)("div",j,[(0,r.bF)(a,{class:"abso",style:{top:"4.375rem",left:"0",width:"100%"},show1:"1"},{default:(0,r.k6)(()=>[...t[0]||(t[0]=[(0,r.eW)("1",-1)])]),_:1}),t[1]||(t[1]=(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/32.webp"},null,-1)),(0,r.Lk)("span",{class:"diff",style:(0,u.Tr)({opacity:0!=e.diff1?1:0})},(0,u.v_)(e.diff1>0?"+":"")+(0,u.v_)(e.diff1),5),(0,r.Lk)("span",V,(0,u.v_)(e.score1),1)]),(0,r.Lk)("div",q,[(0,r.bF)(a,{class:"abso",style:{top:"4.375rem",left:"0",width:"100%"}},{default:(0,r.k6)(()=>[...t[2]||(t[2]=[(0,r.eW)("asfasfasdfasfdasdfasdfas",-1)])]),_:1}),t[3]||(t[3]=(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/31.webp"},null,-1)),(0,r.Lk)("span",{class:"diff",style:(0,u.Tr)({opacity:0!=e.diff2?1:0})},(0,u.v_)(e.diff2>0?"+":"")+(0,u.v_)(e.diff2),5),(0,r.Lk)("span",H,(0,u.v_)(e.score2),1)]),(0,r.Lk)("div",K,[(0,r.bF)(a,{class:"abso",style:{top:"4.375rem",left:"0",width:"100%"}},{default:(0,r.k6)(()=>[...t[4]||(t[4]=[(0,r.eW)("1",-1)])]),_:1}),t[5]||(t[5]=(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/29.webp"},null,-1)),(0,r.Lk)("span",{class:"diff",style:(0,u.Tr)({opacity:0!=e.diff3?1:0})},(0,u.v_)(e.diff3>0?"+":"")+(0,u.v_)(e.diff3),5),(0,r.Lk)("span",Q,(0,u.v_)(e.score3),1)]),(0,r.Lk)("div",J,[(0,r.bF)(a,{class:"abso",style:{top:"4.375rem",left:"0",width:"100%"}},{default:(0,r.k6)(()=>[...t[6]||(t[6]=[(0,r.eW)("1",-1)])]),_:1}),t[7]||(t[7]=(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/30.webp"},null,-1)),(0,r.Lk)("span",{class:"diff",style:(0,u.Tr)({opacity:0!=e.diff4?1:0})},(0,u.v_)(e.diff4>0?"+":"")+(0,u.v_)(e.diff4),5),(0,r.Lk)("span",Y,(0,u.v_)(e.score4),1)])]),(0,r.Lk)("div",Z,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",ee,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.arr,t=>((0,r.uX)(),(0,r.Wv)(l,{key:t,class:(0,u.C4)(["card m-0",{shanshuo:e.ssArr.indexOf(t)>=0,flyin1:e.flyin1.indexOf(t)>=0,flyin2:e.flyin2.indexOf(t)>=0,flyout1:e.flyout1.indexOf(t)>=0,flyout2:e.flyout2.indexOf(t)>=0}]),style:{"max-width":"25%"},"card-id":t},null,8,["class","card-id"]))),128))])])])]),"win-content":(0,r.k6)(()=>[(0,r.Lk)("h1",null,[(0,r.Lk)("img",{class:"avatar",src:"./static/avatar/"+[32,31,29,30][e.step%4]+".webp"},null,8,te),t[8]||(t[8]=(0,r.eW)("WIN! ",-1))])]),_:1},16,["onStep","onAuto","onGoon"])}const ie="undefined"===typeof window?{name:"message",template:"<div>Mock message</div>"}:(0,r.$V)(()=>s.e(82).then(s.bind(s,7082))),re={name:"Fish",components:{message:ie},data(){return{title:"FISHING CONTEST OF DOG TEAM",diff1:0,diff2:0,diff3:0,diff4:0,cards1:[],cards2:[],cards3:[],cards4:[],ssArr:[],flyin1:[],flyin2:[],flyout1:[],flyout2:[],arr:[],number:54}},methods:{init(){this.cards1.splice(0),this.cards2.splice(0),this.cards3.splice(0),this.cards4.splice(0);let e=this.cards1;this.arr.splice(0);for(let t=0;t<this.number;t++)e.push(t);M(e,this.number),this.cards2.push(...e.splice(-14)),this.cards3.push(...e.splice(-13)),this.cards4.push(...e.splice(-13))},time(e,t){return new Promise(s=>{setTimeout(()=>{s(),e()},t)})},async push(e,t){e.push(t)},async hit(e,t){var s=e.shift(),i=s>>2;if(13==i)return this.push(t,s),this.ssArr.push(s),await this.time(()=>{this.ssArr.splice(0);for(let e=1;e<=4;e++)e!=this.step%4+1&&t.push(...this["cards"+e].splice(0,53==s?5:3))},this.gameManager.autoStepDelay);var r=10==i?0:t.findIndex(e=>e>>2==i);this.push(t,s),r<0||(this.ssArr.push(s,t[r]),await this.time(()=>{this.ssArr.splice(0),e.push(...t.splice(r))},this.gameManager.autoStepDelay))},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              钓鱼游戏 (Fish)                  ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step}\n`),console.log("│ 玩家1(你) │  玩家2  │  玩家3  │  玩家4  │");const e=[];for(let t=1;t<=4;t++){const s=this[`cards${t}`];e.push(s.length>0?`${s.length}张`:"已出完")}if(console.log(`│${e[0].padStart(9," ")}│${e[1].padStart(9," ")}│${e[2].padStart(9," ")}│${e[3].padStart(9," ")}│`),console.log("\n━━━ 中央区域 ━━━"),this.arr.length>0){const e=this.arr.map(e=>(0,I.zT)(e)).join(" ");console.log(`  ${e}`)}else console.log("  (空)");return"渲染完成"}},computed:{score1:function(){return this.cards1.length},score2:function(){return this.cards2.length},score3:function(){return this.cards3.length},score4:function(){return this.cards4.length}},watch:{score4(e,t){this.diff4=e-t,this.time(()=>{this.diff4=0},this.gameManager.autoStepDelay)},score3(e,t){this.diff3=e-t,this.time(()=>{this.diff3=0},this.gameManager.autoStepDelay)},score2(e,t){this.diff2=e-t,this.time(()=>{this.diff2=0},this.gameManager.autoStepDelay)},score1(e,t){this.diff1=e-t,this.time(()=>{this.diff1=0},this.gameManager.autoStepDelay)}}};var oe=T.simpleGame(re,1e3);const ne=oe;var ae=ne;const le=(0,a.A)(ae,[["render",se],["__scopeId","data-v-a9f40ed8"]]);var ce=le;const he={class:"row center",style1:"overflow:scroll"},de={class:"flex-row center"},ue={class:"cardsul flex-row center",style:{"padding-left":"0"}},ge={class:"flex-col center m-0"},fe={class:"flex-row"},me=["onClick"],pe={class:"m-0"},ye={class:"cardsul flex-row center",style:{"padding-left":"0","margin-left":"1.25rem"}},ve={key:0,class:"flex-row center m-0"},we=["onClick"];function be(e,t,s,o,n,a){const l=(0,r.g2)("point24card"),c=(0,r.g2)("CardImage"),h=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(h,(0,r.v6)(e.gameLayoutProps,{"lose-subtitle":"NO EXP = 24",onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",he,[(0,r.Lk)("div",de,[(0,r.Lk)("ul",ue,[(0,r.Lk)("div",ge,[(0,r.bF)(l,{card:e.arr[0]},null,8,["card"]),(0,r.bo)((0,r.Lk)("div",fe,[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(4,t=>(0,r.Lk)("span",{key:t,class:(0,u.C4)(["sign center",{choose:e.sign==t}]),onClick:s=>e.canOperate&&e.clickSign(t)},(0,u.v_)(e.signs[t]),11,me)),64))],512),[[i.aG,e.step<3]]),0!=e.sign?((0,r.uX)(),(0,r.Wv)(c,{key:0,"card-id":"bg",class:"card align-center"})):(0,r.Q3)("",!0),t[0]||(t[0]=(0,r.Lk)("span",{class:"vertical m-0"},"=",-1)),(0,r.Lk)("span",pe,(0,u.v_)(e.calc(e.arr[0]).toFixed(2)),1)])]),(0,r.Lk)("ul",ye,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.arr,(t,s)=>((0,r.uX)(),(0,r.CE)("div",{key:s,class:"align-center flex-wrap flex-row center"},[0!=s?((0,r.uX)(),(0,r.CE)("div",ve,[(0,r.Lk)("span",{class:"sign center",onClick:i=>e.canOperate&&e.clickCard(t,s)},(0,u.v_)(e.signs[e.sign]),9,we),(0,r.bF)(l,{card:t,onClick:i=>e.canOperate&&e.clickCard(t,s)},null,8,["card","onClick"])])):(0,r.Q3)("",!0)]))),128))])])])]),_:1},16,["onUndo","onGoon","onStep","onAuto"])}const ke="undefined"===typeof window?{name:"point24card",template:"<div>Mock point24card</div>"}:(0,r.$V)(()=>s.e(526).then(s.bind(s,9526)));var Ce=[1,3,2,2,4,4];function xe(e,t,s){for(var i=0;i<t;i++)for(var r=i+1;r<t;r++){var o=[e[i],e[r]];e[r]=e[t-1];for(var n=0;n<6;n++)if(e[i]=[o[n%2],Ce[n],o[1*!(n%2)]],xe(e,t-1,s))return!0;e[i]=o[0],e[r]=o[1]}return 1==t&&Math.abs(Se(e[0])-s)<1e-7}let Me=[()=>{},(e,t)=>e+t,(e,t)=>e-t,(e,t)=>e*t,(e,t)=>e/t];function Se(e){if(Number.isFinite(e))return 1+(e>>2);{let[t,s,i]=e;return t=Se(t),i=Se(i),Me[s](t,i)}}function Le(e){return Number.isFinite(e)?e:Le(e[0])}const _e={name:"point24",components:{point24card:ke},data(){return{title:"Point24",sign:0,cards1:[],cards2:[0,0,0],signs:["UP","+","-","X","/"],arr:[],number:52}},methods:{init(){this.sign=0,this.cards1.splice(0),this.arr.splice(0);let e=this.cards1;for(let t=0;t<this.number;t++)e.push(t);M(e,this.number),this.arr.push(...e.splice(0,4)),this.autoCalc()},calc:Se,first:Le,process:xe,clickSign(e){this.sign=this.sign==e?0:e},recordOperation(e,t){this.gameManager.recordOperation({type:e,...t,timestamp:Date.now()})},handleUndo(e){switch(e.type){case"combine":this.cards2.splice(this.step,1),this.arr.splice(this.arr.findIndex(t=>this.first(t)==this.first(e.combined)),1,e.left,e.right);break}},clickCard(e,t){if(0!=t){if(-1===t)throw new Error("没找到该卡片");if(0!=this.sign){let e=this.arr[0],s=this.arr.splice(t,1)[0],i=[e,this.sign,s];this.arr.splice(0,1,i),this.sign=0,this.cards2.splice(this.step,1,i),this.recordOperation("combine",{left:e,right:s,combined:i})}else{let e=this.arr[0];this.arr.splice(0,1,this.arr[t]),this.arr.splice(t,1,e)}}else console.log("索引为0，直接返回")},async stepFn(){await this.gameManager.step(async()=>{if(this.step>=3)return void console.log("步数已达到3，检查游戏结果...");let e=this.cards2[this.step];this.sign=0;const t=this.arr.findIndex(t=>this.first(t)==this.first(e[0]));this.clickCard(e[0],t),await this.wait(),this.clickSign(e[1]),await this.wait();const s=this.arr.findIndex(t=>this.first(t)==this.first(e[2]));this.clickCard(e[2],s)})},autoCalc(){if(this.step>=3){try{const e=this.calc(this.arr[0]);24==e?(console.log("游戏胜利！"),this.gameManager.setWin()):(console.log("游戏失败！"),this.gameManager.setLose())}catch(a){console.log("计算过程出错:",a.message),this.gameManager.stopAuto()}return}let e=this.step,t=[...this.arr],s=this.process(t,t.length,24);if(!s)return void this.gameManager.setLose();if(this.cards2.splice(2,1,t[0]),e>=2)return;let i=t[0][0],r=t[0][2],o=Number.isFinite(i),n=Number.isFinite(r);this.cards2.splice(1,1,o?r:n?t[0][0]:Le(i)==Le(this.cards2[0])?r:i),e>=1||this.cards2.splice(0,1,o?Number.isFinite(r[0])?r[2]:r[0]:n?Number.isFinite(i[0])?i[2]:i[0]:i)},formulaToString(e){if(Number.isFinite(e))return(0,I.zT)(e);if(Array.isArray(e)&&3===e.length){const[t,s,i]=e,r=this.signs[s]||this.signs[0],o=this.formulaToString(t),n=this.formulaToString(i);return`(${o} ${r} ${n})`}return String(e)},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              24点游戏 (Point24)               ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step}\n`),console.log("━━━ 当前牌面 ━━━");const e=[];for(let t=0;t<4;t++)if(void 0!==this.arr[t]){const s=this.formulaToString(this.arr[t]);e.push(`[${t}] ${s}`)}return console.log(`  ${e.join("  ")}\n`),console.log("━━━ 可用运算符 ━━━"),console.log("  [+] 加  [-] 减  [×] 乘  [÷] 除\n"),this.history&&this.history.length>0&&(console.log("━━━ 计算历史 ━━━"),this.history.forEach((e,t)=>{console.log(`  ${t+1}. ${e}`)}),console.log("")),void 0!==this.result&&null!==this.result&&(console.log(`当前结果: ${this.result}`),24===this.result&&console.log("🎉 恭喜！达到24点！")),"渲染完成"}}};var Pe=T.puzzleGame(_e,800);const Ee=Pe;var Ie=Ee;const Te=(0,a.A)(Ie,[["render",be],["__scopeId","data-v-eaeab1bc"]]);var Ae=Te;const $e={class:"row"},Oe={class:"center"},ze={class:"cardsul",style:{"padding-left":"0","max-width":"43.125rem","justify-content":"space-between","margin-top":"11.25rem"}},Ge={class:"m-0 card",style:{"background-color":"#719192"}},Fe={class1:"row",style:{"margin-top":"0.625rem"}},Ne={class:"cardsul",style:{"padding-left":"0","max-width":"46.25rem"}};function Be(e,t,s,o,n,a){const l=(0,r.g2)("CardImage"),c=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(c,(0,r.v6)(e.gameLayoutProps,{"lose-title":"","lose-subtitle":"YOUR LUCKY CLASSES:","lose-buttons":[{label:"GO ON",action:"goon",callback:e.goon,disabled:!1}],"lose-modal-style":{backgroundColor:"rgba(0,0,0,0.8)"},onStep:e.stepFn,onAuto:e.pass,onGoon:e.goon}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",$e,[(0,r.Lk)("div",Oe,[(0,r.Lk)("ul",ze,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.arr,(t,s)=>((0,r.uX)(),(0,r.CE)("li",{key:s,class:(0,u.C4)(["cards m-0","cards"+s])},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t,(t,i)=>((0,r.uX)(),(0,r.Wv)(l,{key:t,class:"m-0 card abso",style:(0,u.Tr)({top:30*(e.month==s?i:1+i)/16+"rem",left:0}),"card-id":e.cards2[s]>i||e.month==s&&(12==e.month&&3==i||4==i)?t:"bg"},null,8,["style","card-id"]))),128)),(0,r.bo)((0,r.Lk)("div",Ge,null,512),[[i.aG,12==s&&e.month!=s]])],2))),128))])])])]),"lose-cards":(0,r.k6)(()=>[(0,r.Lk)("div",Fe,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",Ne,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.visibleCards,(e,t)=>((0,r.uX)(),(0,r.Wv)(l,{key:t,"card-id":e.cardId,class:"card"},null,8,["card-id"]))),128))])])])]),_:1},16,["lose-buttons","onStep","onAuto","onGoon"])}const Re={name:"Month",data(){return{title:"Month",month:12,cards1:[],cards2:[],arr:[],number:52}},methods:{init(){this.month=12,this.cards1.splice(0),this.cards2.splice(0),this.arr.splice(0);let e=this.cards1;for(let t=0;t<this.number;t++)e.push(t);M(e,this.number);for(let t=0;t<this.number>>2;t++)this.cards2.push(0),this.arr.push(e.splice(0,4))},async push(e,t){e.push(t)},async hit(){this.gameManager.recordOperation();let e=this.arr[this.month].pop();var t=e>>2;this.arr[t].unshift(e),this.month=t,this.cards2[t]++},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              月份游戏 (Month)                 ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step}\n`);const e=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"];for(let s=0;s<12;s++){const t=this.cards2[s];console.log(`  [${e[s]}] `+this.arr[s].map((e,s)=>`${s<t||s>=4?(0,I.zT)(e):"[?]"}`).join(" ")+(t>=4?" [✓] 已完成":""))}const t=this.cards2[12];return console.log("  [牌堆] "+this.arr[12].map((e,s)=>`${s<t||s>=3?(0,I.zT)(e):"[?]"}`).join(" ")+(t>=4?" [✓] 已完成":`剩余 ${4-t} 次机会`)),"渲染完成"}}};var Xe=T.simpleGame(Re,1e3);const De={...Xe,computed:{...Xe.computed,visibleCards(){return this.cards2.map((e,t)=>({originalItem:e,index:t,cardId:4*t+1})).filter(e=>e.originalItem>=4&&e.index<12)}}};var We=De;const Ue=(0,a.A)(We,[["render",Be],["__scopeId","data-v-cf405a78"]]);var je=Ue;const Ve={class:"row"},qe={class:"cardsul cards",style:{"padding-left":"0",width:"100%",height:"46.875rem","max-width":"31.25rem",margin:"auto"}};function He(e,t,s,o,n,a){const l=(0,r.g2)("CardImage"),c=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(c,(0,r.v6)(e.gameLayoutProps,{"lose-subtitle":"NO PAIR",onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",Ve,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",qe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards1,(t,s)=>(0,r.bo)(((0,r.uX)(),(0,r.Wv)(l,{key:s,class:(0,u.C4)(["card abso",{shanshuo:e.sign==t}]),style:(0,u.Tr)([e.map[s],{width:"20%",height:"9.375rem",margin:"0"}]),"card-id":e.check(s)?t:"bg",onClick:i=>e.canOperate&&e.clickCard(t,s)},null,8,["style","card-id","onClick","class"])),[[i.aG,!e.done(t)]])),128))])])])]),_:1},16,["onUndo","onGoon","onStep","onAuto"])}const Ke={name:"Tortoise",data(){return{title:"Tortoise",sign:-1,cards1:[],next:[],number:54,map:[{"z-index":0,left:"10%",top:"4.6875rem",up:[16,30]},{"z-index":0,left:"30%",top:"4.6875rem",up:[16,17,31]},{"z-index":0,left:"50%",top:"4.6875rem",up:[17,18,31]},{"z-index":0,left:"70%",top:"4.6875rem",up:[18,32]},{"z-index":0,left:"10%",top:"14.0625rem",up:[16,19,37]},{"z-index":0,left:"30%",top:"14.0625rem",up:[16,17,19,20]},{"z-index":0,left:"50%",top:"14.0625rem",up:[17,18,20,21]},{"z-index":0,left:"70%",top:"14.0625rem",up:[18,21,33]},{"z-index":0,left:"10%",top:"23.4375rem",up:[19,22,37]},{"z-index":0,left:"30%",top:"23.4375rem",up:[19,20,22,23]},{"z-index":0,left:"50%",top:"23.4375rem",up:[20,21,23,24]},{"z-index":0,left:"70%",top:"23.4375rem",up:[21,24,33]},{"z-index":0,left:"10%",top:"32.8125rem",up:[22,36]},{"z-index":0,left:"30%",top:"32.8125rem",up:[22,23,35]},{"z-index":0,left:"50%",top:"32.8125rem",up:[23,24,35]},{"z-index":0,left:"70%",top:"32.8125rem",up:[24,34]},{"z-index":1,left:"20%",top:"9.375rem",up:[25]},{"z-index":1,left:"40%",top:"9.375rem",up:[25,26]},{"z-index":1,left:"60%",top:"9.375rem",up:[26]},{"z-index":1,left:"20%",top:"18.75rem",up:[25,27]},{"z-index":1,left:"40%",top:"18.75rem",up:[25,26,27,28]},{"z-index":1,left:"60%",top:"18.75rem",up:[26,28]},{"z-index":1,left:"20%",top:"28.125rem",up:[27]},{"z-index":1,left:"40%",top:"28.125rem",up:[27,28]},{"z-index":1,left:"60%",top:"28.125rem",up:[28]},{"z-index":2,left:"30%",top:"14.0625rem",up:[29]},{"z-index":2,left:"50%",top:"14.0625rem",up:[29]},{"z-index":2,left:"30%",top:"23.4375rem",up:[29]},{"z-index":2,left:"50%",top:"23.4375rem",up:[29]},{"z-index":3,left:"40%",top:"18.75rem",up:[]},{"z-index":1,left:"0",top:"0",up:[38]},{"z-index":1,left:"40%",top:"0",up:[39]},{"z-index":1,left:"80%",top:"0",up:[40]},{"z-index":1,left:"80%",top:"18.75rem",up:[41]},{"z-index":1,left:"80%",top:"37.5rem",up:[42]},{"z-index":1,left:"40%",top:"37.5rem",up:[43]},{"z-index":1,left:"0",top:"37.5rem",up:[44]},{"z-index":1,left:"0",top:"18.75rem",up:[45]},{"z-index":2,left:"0",top:"2.3438rem",up:[46]},{"z-index":2,left:"35%",top:"0",up:[47]},{"z-index":2,left:"75%",top:"0",up:[48]},{"z-index":2,left:"80%",top:"16.4063rem",up:[49]},{"z-index":2,left:"80%",top:"35.1563rem",up:[50]},{"z-index":2,left:"45%",top:"37.5rem",up:[51]},{"z-index":2,left:"5%",top:"37.5rem",up:[52]},{"z-index":2,left:"0",top:"21.0938rem",up:[53]},{"z-index":3,left:"0",top:"4.6875rem",up:[]},{"z-index":3,left:"30%",top:"0",up:[]},{"z-index":3,left:"70%",top:"0",up:[]},{"z-index":3,left:"80%",top:"14.0625rem",up:[]},{"z-index":3,left:"80%",top:"32.8125rem",up:[]},{"z-index":3,left:"50%",top:"37.5rem",up:[]},{"z-index":3,left:"10%",top:"37.5rem",up:[]},{"z-index":3,left:"0",top:"23.4375rem",up:[]}]}},methods:{init(){this.sign=-1,this.cards1.splice(0);let e=this.cards1;for(let t=0;t<this.number;t++)e.push(t);M(e,this.number),this.autoCalc()},async stepFn(){this.step>=this.number||await this.gameManager.step(async()=>{let e,t,s=-1,i=i=>{if(i==this.sign)return;if(this.done(i))return;let r=this.cards1.indexOf(i);this.check(r)&&this.map[r]["z-index"]>s&&(e=i,t=r,s=this.map[r]["z-index"])};if(-1!=this.sign&&this.sign<<2!=this.next[0]<<2){let e=this.sign>>2;for(let t=0;t<4;t++){let s=4*e+t;i(s)}}if(s<0)for(let r of this.next)i(r);this.clickCard(e,t)})},check(e){return this.map[e]&&this.map[e].up.findIndex(e=>!this.done(this.cards1[e]))<0},done(e){return this.gameManager.history.indexOf(e)>=0},clickCard(e,t){this.check(t)&&(this.sign==e?this.sign=-1:this.sign>>2!=e>>2?this.sign=e:(this.gameManager.recordOperation(this.sign),this.gameManager.recordOperation(e),this.sign=-1))},undo(){this.sign=-1,this.gameManager.undo(),this.gameManager.undo()},autoCalc(){let e=this.step;if(e%2==1)return;if(e>=this.number)return void this.gameManager.setWin();let t,s=[],i=-1,r=-1,o=!1;for(t=this.number-1;t>=0;t--){if(this.done(t))o=!0;else{let e=this.cards1.indexOf(t);this.check(e)&&(s.push(t),this.map[e]["z-index"]>i&&(i=this.map[e]["z-index"]))}if(t%4==0){if(s.length>1){if(o)return void(this.next=s);i>r&&(this.next=s,r=i)}i=-1,s=[],o=!1}}r<0&&this.gameManager.setLose()},renderTextView(){if(console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              龟兔赛跑 (Tortoise)              ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step} / ${this.number}`),console.log(`已配对: ${this.step} 张 | 剩余: ${this.number-this.step} 张\n`),console.log("\n图例:"),console.log("  ┌──┐ = 卡牌边框  ▄ = 选中卡牌边框 ♥5 = 可点击卡牌内容  ·· = 不可点击卡牌"),this.next&&this.next.length>0){const e=this.next.map(e=>(0,I.zT)(e)).join(", ");console.log(`\n💡 提示: 可配对的卡片: ${e}`)}if(-1!==this.sign){const e=this.cards1.indexOf(this.sign),t=(0,I.zT)(this.sign);console.log(`🎯 当前选中: ${t} (位置 ${e})\n`)}const e=20,t=20,s=Array(e).fill(null).map(()=>Array(t).fill("·")),i=4,r=4,o=100,n=46.875,a=[];this.cards1.forEach((e,t)=>{if(!this.done(e)){const s=this.map[t],i=this.check(t),r=e===this.sign;a.push({cardId:e,posIdx:t,left:parseFloat(s.left),top:parseFloat(s.top),zIndex:s["z-index"],canClick:i,isSelected:r,cardText:(0,I.zT)(e)})}}),a.sort((e,t)=>e.zIndex-t.zIndex),a.forEach(a=>{const l=Math.round(a.left/o*(t-r)),c=Math.round(a.top/n*(e-i)),h=Math.max(0,Math.min(c,e-i)),d=Math.max(0,Math.min(l,t-r));for(let o=0;o<i;o++)for(let n=0;n<r;n++){const l=h+o,c=d+n;if(l<e&&c<t){let e=" ";0===o?e=this.sign==a.cardId?"▄":0===n?"┌":n===r-1?"┐":"──":o===i-1?e=this.sign==a.cardId?"▀":0===n?"└":n===r-1?"┘":"──":0===n||n===r-1?e=this.sign==a.cardId?"█":"│":a.canClick?1===o&&1===n?e=a.cardText[0]||" ":1===o&&2===n||2===o&&1===n?e=a.cardText[1]||" ":2===o&&2===n&&(e=a.cardText[0]||" "):(1!==o||1!==n&&2!==n)&&(2!==o||1!==n&&2!==n)||(e="·"),"──"===e?(s[l][c]="─",c+1<t&&(s[l][c+1]="─")):s[l][c]=e}}}),console.log("\n━━━ 游戏布局 (字符画) ━━━"),console.log("画布: 20行 × 20列，每张卡牌: 4行 × 4列\n");const l=[];return l.push("┌"+"─".repeat(t)+"┐"),s.forEach(e=>{l.push("│"+e.join("")+"│")}),l.push("└"+"─".repeat(t)+"┘"),console.log(l.join("\n")),"字符画渲染完成"}}};var Qe=T.cardGame(Ke,500);const Je=Qe;var Ye=Je;const Ze=(0,a.A)(Ye,[["render",He],["__scopeId","data-v-0ad3d044"]]);var et=Ze;const tt={class:"row"},st={key:0,class:"m-0"};function it(e,t,s,i,o,n){const a=(0,r.g2)("CardImage"),l=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(l,(0,r.v6)(e.gameLayoutProps,{"lose-subtitle":e.n+"/"+4*(e.number+1),"lose-buttons":[{label:"RESTART",action:"goon",callback:e.goon,disabled:!1},{label:"UNDO",action:"undo",callback:e.undo,disabled:e.undoDisabled}],onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",tt,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",{class:"cardsul flex-col",style:(0,u.Tr)([{height:150*(e.number+1)/16+"rem"},{"padding-left":"0",width:"100%","max-width":"31.25rem",margin:"0 auto",position:"static"}])},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards1,(t,s)=>((0,r.uX)(),(0,r.Wv)(a,{key:s,class:(0,u.C4)(["card m-0",{shanshuo:t>=0&&e.canMoveCard(t)}]),style:{width:"25%",height:"9.375rem"},"card-id":t,hide:t<0,onClick:i=>e.canOperate&&(t>=0?e.clickCard(t):e.cards1[s-1]>=4&&e.clickSign(s))},{default:(0,r.k6)(()=>[e.cards1[s-1]>=4?((0,r.uX)(),(0,r.CE)("span",st,(0,u.v_)(e.getCurrentCandidateCard(s)),1)):(0,r.Q3)("",!0)]),_:2},1032,["card-id","hide","onClick","class"]))),128))],4)])])]),_:1},16,["lose-subtitle","lose-buttons","onUndo","onGoon","onStep","onAuto"])}s(116);function rt(e,t,s,i,r,o,n=null){const a={targetCard:e,slotIndex:t,ruleBasedScore:n,_getters:[()=>n?n.slotPriority:i,()=>n&&n.excludeReason?-1e6:0,()=>(void 0===a._feature2&&(a._feature2=o%(s.number+1)),-a._feature2),()=>n?n.matchNextCard:0,()=>n?n.adjacentEmptyCount:0,()=>n?n.columnEmptyCount:0,()=>i,()=>(a._deep||(a._deep=r.deep),a._deep),()=>{if(void 0===a._winProbability){const t=[...s.cards1],i=t[r.index];t[o]=i,t[r.index]=e,a._winProbability=s.estimateWinProbability(t)}return a._winProbability},()=>(a._diff||(a._diff=Math.abs((e>>2)-(s.number-1)+r.index%(s.number+1))),-a._diff),()=>(void 0===a._feature0&&(a._feature0=e>>2),a._feature0),()=>(void 0===a._feature1&&(a._feature1=e%4),a._feature1),()=>(void 0===a._feature3&&(a._feature3=r.index%(s.number+1)),-a._feature3),()=>(void 0===a._feature4&&(a._feature4=r.card>>2),a._feature4),()=>(void 0===a._feature5&&(a._feature5=s.countEmptyInColumn(s.cards1,Math.floor(o/(s.number+1)))),a._feature5),()=>(void 0===a._feature6&&(a._feature6=s.countEmptyAbove(s.cards1,o)),a._feature6),()=>(void 0===a._feature7&&(a._feature7=s.countEmptyBelow(s.cards1,o)),-a._feature7),()=>(void 0===a._feature8&&(a._feature8=s.countEmptyInColumn(s.cards1,Math.floor(r.index/(s.number+1)))),-a._feature8),()=>(void 0===a._feature9&&(a._feature9=s.countEmptyAbove(s.cards1,r.index)),a._feature9),()=>(void 0===a._feature10&&(a._feature10=s.cards1.filter(e=>e<0).length),-a._feature10),()=>(void 0===a._feature11&&(a._feature11=s.countCardsAbove(s.cards1,o)),a._feature11),()=>(void 0===a._feature12&&(a._feature12=s.countCorrectBelow(s.cards1,r.index)),a._feature12),()=>(void 0===a._feature13&&(a._feature13=s.countSameRankCandidates(s.cards1,r)),a._feature13),()=>{if(void 0===a._feature14){const t=[...s.cards1],i=t[r.index];t[o]=i,t[r.index]=e,a._feature14=s.countPossibleMoves(t)}return a._feature14},()=>{if(void 0===a._feature15){const t=[...s.cards1],i=t[r.index];t[o]=i,t[r.index]=e,a._feature15=s.calculateEmptyEntropy(t)}return-a._feature15},()=>{if(void 0===a._feature16){const t=[...s.cards1],i=t[r.index];t[o]=i,t[r.index]=e,a._feature16=s.countRestoredCards(t)}return a._feature16},()=>(void 0===a._feature17&&(a._feature17=Math.abs(o%(s.number+1)-(s.number-1-(e>>2)))+Math.abs(Math.floor(o/(s.number+1))-e%4%s.matchMode)),a._feature17),()=>(void 0===a._feature18&&(a._feature18=Math.floor(o/(s.number+1))!==Math.floor(r.index/(s.number+1))?1:0),a._feature18),()=>(void 0===a._feature19&&(a._feature19=10*(r.card>>2)-r.index%(s.number+1)),a._feature19),()=>(void 0===a._feature20&&(a._feature20=(r.card>>2)*s.countEmptyBelow(s.cards1,r.index)),-a._feature20)]};return a}function ot(e,t){for(let s=0;s<e._getters.length;s++){const i=e._getters[s](),r=t._getters[s]();if(i>r)return!0;if(i<r)return!1}return!1}const nt={calculateRuleBasedPriority(e,t,s,i,r){const{cards1:o,number:n,matchMode:a}=e,l=s.index,c=s.card,h=n+1,d=l%h,u=Math.floor(r/h),g=r%h,f=c>>2,m=i>>2,p=i%4,y=p%a,v=-f;let w={slotPriority:v,excludeReason:null,matchNextCard:0,adjacentEmptyCount:0,columnEmptyCount:0};if(g>0){const e=r-1,t=o[e];if(t>=0){const e=t>>2,s=t%4,i=s%a;y===i&&m===e-1&&(w.excludeReason="rule1_same_group_rank_minus_1")}}d<g&&(w.excludeReason="rule2_slot_row_greater");let b=0;if(g<n){const e=r+1,t=o[e];if(t>=0){const e=t>>2,s=t%4,i=s%a;if(y===i&&m===e+1&&(b=1e4,b-=100*g,g>0)){const e=r-1,t=o[e],s=t>>2;b-=s}}}w.matchNextCard=b;let k=0;g>0&&o[r-1]<0&&k++,g<n&&o[r+1]<0&&k++,w.adjacentEmptyCount=k;let C=0;const x=u*h;for(let M=x;M<x+h;M++)o[M]<0&&C++;return w.columnEmptyCount=C,w},compareRuleBasedPriority(e,t){return e.slotPriority!==t.slotPriority?e.slotPriority-t.slotPriority:e.excludeReason&&!t.excludeReason?1:!e.excludeReason&&t.excludeReason?-1:e.excludeReason&&t.excludeReason?0:e.matchNextCard!==t.matchNextCard?t.matchNextCard-e.matchNextCard:e.adjacentEmptyCount!==t.adjacentEmptyCount?t.adjacentEmptyCount-e.adjacentEmptyCount:e.columnEmptyCount!==t.columnEmptyCount?t.columnEmptyCount-e.columnEmptyCount:0},countEmptyInColumn(e,t){const s=t*(this.number+1),i=s+this.number+1;let r=0;for(let o=s;o<i;o++)e[o]<0&&r++;return r},countEmptyAbove(e,t){const s=Math.floor(t/(this.number+1)),i=(s+1)*(this.number+1);let r=0;for(let o=t+1;o<i;o++)e[o]<0&&r++;return r},countEmptyBelow(e,t){const s=Math.floor(t/(this.number+1)),i=s*(this.number+1);let r=0;for(let o=i;o<t;o++)e[o]<0&&r++;return r},countCardsAbove(e,t){const s=Math.floor(t/(this.number+1)),i=(s+1)*(this.number+1);let r=0;for(let o=t+1;o<i;o++)e[o]>=0&&r++;return r},countCorrectBelow(e,t){const s=Math.floor(t/(this.number+1)),i=s*(this.number+1);let r=0;for(let o=i;o<t;o++){const t=e[o];if(t<0)break;const i=t>>2,n=t%4,a=this.number-1-o%(this.number+1);if(n%this.matchMode!==s%this.matchMode||i!==a)break;r++}return r},countSameRankCandidates(e,t){let s=0;const i=t.card,r=i>>2,o=r-1;if(o<0)return 0;const n=i%this.matchMode;for(let a=n;a<4;a+=this.matchMode){const t=4*o+a,i=e.indexOf(t);i>=0&&i+1<e.length&&e[i+1]<0&&s++}return s},calculateEmptyEntropy(e){const t=[0,0,0,0];let s=0;for(let r=0;r<e.length;r++)if(e[r]<0){s++;const e=Math.floor(r/(this.number+1));t[e]++}if(0===s)return 0;let i=0;for(let r of t)if(r>0){const e=r/s;i-=e*Math.log2(e)}return i},countPossibleMoves(e){let t=0;for(let s=0;s<e.length;s++){if(e[s]>=0)continue;const i=s>0?e[s-1]:null;if(null===i||i<0)continue;const r=i>>2,o=r-1;if(o<0)continue;const n=i%this.matchMode;for(let s=n;s<4;s+=this.matchMode){const i=4*o+s,r=e.indexOf(i);r>=0&&t++}}return t},countRestoredCards(e){let t=0;const s=this.number+1;for(let i=this.number-1;i>=0;i--)for(let r=0;r<4;r++){const o=4*i+r,n=e.indexOf(o);if(n<0)continue;const a=r%this.matchMode,l=a*s,c=l+(this.number-1-i);if(n===c){let s=!0;for(let t=i+1;t<this.number;t++){const i=l+(this.number-1-t),r=e[i];if(r<0){s=!1;break}const o=r>>2,n=r%4,c=n%this.matchMode;if(c!==a||o!==t){s=!1;break}}s&&t++}}return t},estimateWinProbability(e){const t=this.number+1,s=4;let i=0,r=0;for(let l=0;l<t;l++){const o=this.evaluateRowScore(e,l,t,s);i+=o.score,r+=o.maxScore}const o=this.calculateBlockPenalty(e),n=r>0?i/r*80:0,a=Math.max(0,n-o);return a},evaluateRowScore(e,t,s,i){let r=0,o=0;for(let n=0;n<i;n++){const i=n*s+t,a=e[i];if(o+=10,a<0){const t=this.countEmptySlotsAbove(e,i);r+=Math.max(0,10-2*t);continue}const l=a>>2,c=a%4,h=c%this.matchMode,d=this.number-1-t,u=n%this.matchMode;h===u?l===d?(r+=10,this.checkRowBelowCorrect(e,t,n,s)&&(r+=5,o+=5)):r+=l>d?5:2:(r+=3,l===d&&(r+=2))}return{score:r,maxScore:o}},countEmptySlotsAbove(e,t){let s=0;const i=Math.floor(t/(this.number+1)),r=i*(this.number+1),o=r+this.number+1;for(let n=t+1;n<o;n++)e[n]<0&&s++;return s},checkRowBelowCorrect(e,t,s,i){for(let r=t+1;r<this.number;r++){const t=s*i+r,o=e[t];if(o<0)return!1;const n=o>>2,a=this.number-1-r;if(n!==a)return!1}return!0},calculateBlockPenalty(e){let t=0;const s=this.number+1;for(let r=0;r<4;r++){const i=r*s;for(let r=i;r<i+s-1;r++){const o=e[r];if(o<0)continue;const n=o>>2;for(let a=r+1;a<i+s;a++){const s=e[a];if(s<0)continue;const i=s>>2;i<n&&(t+=5)}}}const i=this.countPossibleMoves(e);return 0===i?t+=20:1===i&&(t+=10),t}},at={name:"Sort",data(){return{title:"Sort",cards1:[],number:4,n:0,sign_index:-1,matchMode:1,candidateIntervals:{},currentCandidates:{}}},methods:{init(){this.sign_index=-1,this.cards1.splice(0);let e=this.cards1;for(let t=0;t<4*this.number;t++)e.push(t);M(e,4*this.number);for(let t=0;t<4;t++)e.splice(e.indexOf(4*this.number-1-t),1,-1-t);for(let t=0;t<4;t++)e.splice(t*(this.number+1),0,4*this.number-4+t);this.autoCalc(),this.$nextTick(()=>{this.updateAllCandidateCycling()})},beforeDestroy(){Object.keys(this.candidateIntervals).forEach(e=>{this.stopCandidateCycling(parseInt(e))})},updateAllCandidateCycling(){Object.keys(this.candidateIntervals).forEach(e=>{this.stopCandidateCycling(parseInt(e))});for(let e=0;e<this.cards1.length;e++)this.cards1[e]<0&&e>0&&this.cards1[e-1]>=4&&this.startCandidateCycling(e)},getCandidateCardsForSlot(e){const t=this.cards1[e-1];if(t<4)return[];const s=this.findAllCardsByRankOffset(t,-1);return s.map(e=>e.card)},startCandidateCycling(e){this.stopCandidateCycling(e);const t=this.getCandidateCardsForSlot(e);0!==t.length&&(this.currentCandidates[e]=0,this.candidateIntervals[e]=setInterval(()=>{t.length>0&&(this.currentCandidates[e]=(this.currentCandidates[e]+1)%t.length)},this.gameManager.autoStepDelay))},stopCandidateCycling(e){this.candidateIntervals[e]&&(clearInterval(this.candidateIntervals[e]),delete this.candidateIntervals[e],delete this.currentCandidates[e])},getCurrentCandidateCard(e){const t=this.getCandidateCardsForSlot(e);if(0===t.length)return"";const s=this.currentCandidates[e]||0;return this.getCardPlaceholderText(t[s])},calculateStateHash(){return this.cards1.join(",")},isStateHashRepeated(e){return this.gameManager.history.find(t=>t.stateHash==e)},recordMove(e,t,s,i){const r=this.calculateStateHash();this.gameManager.recordOperation({type:"move",from:e,to:t,card:s,sign:i,timestamp:Date.now(),stateHash:r})},handleUndo(e){switch(e.type){case"move":this.cards1.splice(e.to,1,e.sign),this.cards1.splice(e.from,1,e.card);break}},executeMove(e,t){const s=this.cards1.indexOf(e),i=this.cards1[t];if(this.findNextCard(e,e=>e==t-1)<0)return console.warn("❌ 无效的移动");this.cards1.splice(s,1,i),this.cards1.splice(t,1,e),this.recordMove(s,t,e,i)},clickCard(e){let t=this.findNextCard(e,e=>this.sign_index>=0?e==this.sign_index-1:this.cards1[e+1]<0);if(t>=0){let s=t+1;this.executeMove(e,s)}else console.error(`❌ clickCard: 移动失败 card=${e}, 找不到有效目标位置。Seed:${this.seed}`);this.sign_index=-1},updateN(){this.n=0;for(let e=0;e<4*this.number+4;e++)this.cards1[e]>>2==this.number-1-e%(this.number+1)&&this.n++},async stepFn(){if(!this.next||this.next[0]<0){console.error("❌ stepFn: this.next 无效",this.next);const e={cards1:[...this.cards1],next:this.next,sign_index:this.sign_index,n:this.n};return console.error("💾 故障状态已保存:",JSON.stringify(e)),this.updateN(),this.n>=4*(this.number+1)&&this.gameManager.setWin(),void this.gameManager.stopAuto()}await this.gameManager.step(async()=>{this.clickSign(this.next[1]),await this.wait(),this.executeMove(this.next[0],this.next[1])})},clickSign(e){let t=this.cards1[e-1];if(t<4)return;let s=this.findPrevCard(t);if(s>=0&&"undefined"!==typeof window&&window.document){const e=s%(this.number+1)*150,t=document.querySelector(".game-content-wrapper");t?t.scrollTop=e:(document.documentElement.scrollTop=e,document.body.scrollTop=e)}this.sign_index=e},evaluateCandidateScore(e){if(!e||e.idx<0)return-999999;let t=0,s=e.idx;this.cards1[s+1]<0&&(t+=1e5);let i=s%(this.number+1);t+=10*(this.number-i);let r=e.card%4;return t+=4-r,t},selectBestCandidate(e){if(!e||0===e.length)return-1;if(1===e.length)return e[0].idx;let t=-999999,s=-1;for(let i of e){let e=this.evaluateCandidateScore(i);e>t&&(t=e,s=i.idx)}return s},findCardByRankOffset(e,t,s=null,i=!1){let r=(e>>2)+t,o=e%this.matchMode,n=[];for(let a=o;a<4;a+=this.matchMode){let e=4*r+a,t=this.cards1.indexOf(e);t>=0&&(s&&!s(t)||n.push({idx:t,card:e}))}return i?n:0===n.length?-1:1===n.length?n[0].idx:this.selectBestCandidate(n)},findAllCardsByRankOffset(e,t,s=null){return this.findCardByRankOffset(e,t,s,!0)},findNextCard(e,t=null){return this.findCardByRankOffset(e,1,t)},findPrevCard(e){return this.findCardByRankOffset(e,-1)},canMoveCard(e){if(e<0)return!1;let t=this.findNextCard(e,e=>this.cards1[e+1]<0);return t>=0},...nt,autoCalc(){let e=!0,t={},s=[],i=[];for(let n=-4;n<0;n++){let e=this.cards1.indexOf(n),s=this.cards1[e-1];t[n]={index:e,card:s,priority:0,_in:0,able:!0,bestCard:null}}for(let n=-4;n<0;n++){let r=t[n].index,o=t[n].card,a=[],l=new Map,c=this.findAllCardsByRankOffset(o,-1);for(let e of c)l.set(e.card,0);let h=(e,i,r=0)=>{if(e<0)return s.push([n,e,i]),t[e].priority=Math.max(t[e].priority,++r),t[e]._in++,r;{if(e>=48)return 0;if(!L(a,[e,0]))return 0;a.unshift([e,0]);let t=this.findAllCardsByRankOffset(e,1);if(0===t.length)return 0;let s=0;for(let e of t){let t=e.idx,o=this.cards1[t+1],n=h(o,i,r);s=Math.max(s,n),l.has(e.card)&&l.set(e.card,Math.max(l.get(e.card),n))}return s}},d=(e,i,r,o=0)=>{if(!L(a,[i,1]))return 0;if(a.unshift([i,1]),r>0&&i>=8){let t=this.cards1[e+1];h(t,r,o)}if(i=this.cards1[e-1],i<4){let a=e-2,c=1;while(i<0)i=this.cards1[a],a--,c++;if(i>=4*c){s.push([n,this.cards1[e-1],r]);let i=this.cards1[e-1];return t[i].priority=Math.max(t[i].priority,++o),t[i]._in++,o}i+=4;while(a%(this.number+1)>0){let e=this.cards1[a];if(!(e>=0&&e>>2==i>>2&&e%this.matchMode==i%this.matchMode))break;a--,i+=4,r++}if(a%(this.number+1)==0)return 0;let d=this.cards1[this.cards1.indexOf(i)+1],u=h(d,r,o);return l.has(i)&&l.set(i,Math.max(l.get(i),u)),u}let c=this.findAllCardsByRankOffset(i,-1),u=0;for(let t of c){let e=d(t.idx,i,r,o);u=Math.max(u,e),l.has(t.card)&&l.set(t.card,Math.max(l.get(t.card),e))}return u};if(o>=4&&(e=!1),d(r,n,0),o>=4){let e=this.findAllCardsByRankOffset(o,-1);if(e.length>0){let s=[];for(let t of e){let e=this.cards1.indexOf(o);if(e<0)continue;let i=[...this.cards1];i[t.idx]=n,i[r]=t.card;let a=i.join(","),c=l.get(t.card)||0;const h=this.calculateRuleBasedPriority(this,n,{index:r,card:o},t.card,t.idx);s.push({card:t.card,idx:t.idx,priority:c,ruleBasedScore:h,stateHash:a})}s.length>0?t[n].allCandidates=s:e.length>0&&i.push(n)}}}for(let n of i)t[n]&&(t[n].priority=0);if(e)return this.updateN(),void(this.n>=4*(this.number+1)?this.gameManager.setWin():this.gameManager.setLose());let r=[-1,-2,-3,-4];while(r.length>0){let e;for(e=0;e<r.length;e++)if(t[r[e]]._in<=0)break;if(e<r.length){let i=r.splice(e,1)[0],o=0;while(o<s.length)s[o][0]==i?(t[s[o][1]]._in--,t[s[o][1]].deep=s[o][2],s.splice(o,1),t[i].able=!1):o++}else{let e=[r[0]];while(s.length>0){let i=s.findIndex(t=>t[1]==e[0]),r=e.indexOf(s[i][0]);if(r>=0){t[s[i][1]]._in--,s.splice(i,1);for(let i=0;i<r;i++)for(let r=0;r<s.length;r++)if(s[r][0]==e[i]&&s[r][1]==e[i+1]){t[s[r][1]]._in--,s.splice(r,1);break}break}e.unshift(s[i][0])}}}this.next=[-1,-1];let o=null;for(let n=-4;n<0;n++){let e=t[n];if(e.card<4)continue;let s=e.allCandidates;if(s&&0!==s.length&&!(this.cards1[e.index]>=0))for(let t of s){let i=t.card,r=t.priority,n=t.ruleBasedScore,a=this.cards1.indexOf(i);if(a<0)continue;if(this.isStateHashRepeated(t.stateHash)){s.splice(s.indexOf(t),1);continue}const l=a-1,c=this.cards1[l];if(c>=0){const e=c>>2,t=c%4,s=t%this.matchMode;if(i%this.matchMode===s&&i>>2===e-1)continue}const h=rt(i,e.index,this,r,e,a,n);o&&!ot(h,o)||(o=h,this.next=[h.targetCard,h.slotIndex])}}if(this.next[0]<0){let e=!0,s=0;for(let i=-4;i<0;i++)if(t[i]&&t[i].card>=4){s++;const r=t[i].allCandidates;t[i].priority>0&&r&&r.length>0&&(e=!1)}this.updateN(),this.n>=4*this.number?this.gameManager.setWin():e&&s>0&&this.gameManager.setLose()}else this.updateN()},setMatchMode(e){[1,2,4].includes(e)?(this.matchMode=e,this.init(),console.log("✅ 难度已设置为: "+(1===e?"简单(数值)":2===e?"中等(颜色)":"困难(花色)"))):console.error("❌ 无效的难度模式，请使用 1, 2 或 4")},getMatchModeDescription(){const e={1:"简单(数值匹配) - 任意点数相同即可连接",2:"中等(颜色匹配) - 同颜色的牌可以连接",4:"困难(花色匹配) - 必须同花色才能连接"};return e[this.matchMode]||"未知难度"},renderTextView(){if(console.log("\n╔════════════════════════════════════════════════╗"),console.log("║                排序游戏 (Sort)                ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n难度: ${this.getMatchModeDescription()}`),console.log(`完成度: ${this.n} / ${4*(this.number+1)} 张\n`),console.log("\n图例: [-n] = 无卡牌可放入  [?X] = 有卡牌可放入  * = 可移动  → = 推荐移动"),this.next&&this.next[0]>=0){const e=(0,I.zT)(this.next[0]),t=this.cards1[this.next[1]],s=t<0?["[-1]","[-2]","[-3]","[-4]"][Math.abs(t)-1]:`[${this.next[1]}]`;console.log(`\n💡 建议移动: ${e} → ${s}`)}const e=this.number+1;let t="┌────┬",s="│    │",i="├────┼",r="└────┴";for(let o=0;o<4;o++)t+="───────┬",s+=`  列${o+1}  │`,i+="───────┼",r+="───────┴";t=t.slice(0,-1)+"┐",s=s.slice(0,-1)+"│",i=i.slice(0,-1)+"┤",r=r.slice(0,-1)+"┘",console.log(t),console.log(s),console.log(i);for(let o=0;o<e;o++){let t=`│行${(o+1).toString().padStart(2)}│`;for(let s=0;s<4;s++){const i=s*e+o,r=this.cards1[i];let n="",a="";if(r<0){const e=Math.abs(r)-1,t=i-1,s=this.cards1[t],o=["[-1]","[-2]","[-3]","[-4]"][e];if(n=o,s>=4){const e=this.findAllCardsByRankOffset(s,-1);if(e&&e.length>0){const t=e[0],s=(0,I.zT)(t.card);n=`[?${s.slice(1)}]`}}}else{const e=(0,I.zT)(r),t=this.canMoveCard(r),s=this.next&&this.next[0]===r;s?(a="→",n=`${a}${e}`):t?(a="*",n=`${a}${e}`):n=e}const l=Math.max(0,7-n.length),c=Math.floor(l/2),h=l-c;t+=" ".repeat(c)+n+" ".repeat(h)+"│"}console.log(t)}return console.log(r),"渲染完成"},sendCustomButtons(){const e=1===this.matchMode?2:2===this.matchMode?4:1;this.customButtons.push({action:"difficulty",label:"MODE",method:"setMatchMode",args:[e],description:"SWITCH DIFFICULTY MODE (EASY → NORMAL → HARD)"})}},created(){this.sendCustomButtons()},watch:{matchMode(){this.sendCustomButtons()},cards1:{handler(){this.$nextTick(()=>{this.updateAllCandidateCycling()})},deep:!0}}};var lt=T.puzzleGame(at,500);const ct=lt;var ht=ct;const dt=(0,a.A)(ht,[["render",it],["__scopeId","data-v-f9e286c6"]]);var ut=dt;const gt={class:"row"},ft={class:"row"},mt={class:"cardsul flex-row center",style:{"padding-left":"0",margin:"0"}},pt={class:"small"},yt={class:"small"};function vt(e,t,s,i,o,n){const a=(0,r.g2)("CardImage"),l=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(l,(0,r.v6)(e.gameLayoutProps,{onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",gt,[(0,r.Lk)("span",null,"TIME: "+(0,u.v_)(e.time),1),t[0]||(t[0]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("span",null,"STEP: "+(0,u.v_)(e.step),1)]),(0,r.Lk)("div",ft,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",mt,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cardPositions,(t,s)=>((0,r.uX)(),(0,r.Wv)(a,{key:s,class:"card m-0 radius",style:{"max-width":"25%"},"card-id":e.selectedCard==t||e.secondSelectedCard==t||e.matchedCards[t]?t:"bg",onClick:i=>e.selectedCard!=t&&e.secondSelectedCard!=t&&!e.matchedCards[t]&&e.canOperate&&e.clickCard(s)},null,8,["card-id","onClick"]))),128))])])])]),"win-content":(0,r.k6)(()=>[(0,r.Lk)("h1",pt,"TIME: "+(0,u.v_)(e.time),1),(0,r.Lk)("h1",yt,"STEP: "+(0,u.v_)(e.step),1)]),_:1},16,["onGoon","onStep","onAuto"])}const wt={name:"Pairs",data(){return{title:"Pairs",cardPositions:[],matchedCards:[],seenCards:[],selectedCard:-1,secondSelectedCard:-2,time:0,_timer:0,totalCards:48,n:0}},created(){this.sendCustomButtons()},methods:{init(){this.time=0,clearInterval(this._timer),this._timer=0,this.selectedCard=-1,this.secondSelectedCard=-1,this.cardPositions.splice(0),this.seenCards.splice(0),this.matchedCards.splice(0);const e=this.cardPositions;for(let t=0;t<this.totalCards;t++)e.push(t),this.matchedCards.push(!1);M(e,this.totalCards)},async clickCard(e,t){let s,i;if(void 0===e){let e=!1;for(s=0;s<this.totalCards;s++)if(i=this.cardPositions[s],!this.seenCards[i]&&!this.matchedCards[i]){e=!0;break}if(!e)for(this.seenCards.splice(0),s=0;s<this.totalCards;s++)if(i=this.cardPositions[s],!this.matchedCards[i])break}else if(void 0!==t){const r=8;s=e*r+t,i=this.cardPositions[s]}else s=e,i=this.cardPositions[s];if(this._timer||(this._timer=setInterval(()=>{this.time++},1e3)),this.selectedCard===i||this.matchedCards[i])return;if(this.seenCards[i]=!0,this.gameManager.recordOperation(),this.selectedCard<0)return void(this.selectedCard=i);const r=this.selectedCard>>2===i>>2;r&&(this.matchedCards.splice(i,1,!0),this.matchedCards.splice(this.selectedCard,1,!0),this.selectedCard=-1),this.gameManager.hitflag=!1,this.secondSelectedCard=i,await this.wait(),this.selectedCard=-1,this.secondSelectedCard=-1,this.gameManager.hitflag=!0;const o=this.checkGameCompletion();o&&(this.gameManager.setWin(),clearInterval(this._timer),this._timer=0)},checkGameCompletion(){for(let e=0;e<this.totalCards;e++)if(!this.matchedCards[e])return!1;return!0},async stepFn(){if(this.selectedCard>=0){const e=this.selectedCard-this.selectedCard%4;for(let t=0;t<4;t++){const s=e+t;if(s!==this.selectedCard&&this.seenCards[s]&&!this.matchedCards[s]){const e=this.cardPositions.indexOf(s);if(-1!==e)return await this.clickCard(e)}}}else{let e;for(let t=0;t<this.totalCards;t++)if(t%4===0&&(e=0),this.seenCards[t]&&!this.matchedCards[t]&&e++,e>1){const e=this.cardPositions.indexOf(t);if(-1!==e)return await this.clickCard(e)}}return await this.clickCard()},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              配对游戏 (Pairs)                 ║"),console.log("╚════════════════════════════════════════════════╝");const e=this.matchedCards.filter(e=>e).length;console.log(`\n时间: ${this.time}秒 | 已配对: ${e}/${this.totalCards} 张\n`),console.log("\n图例:"),console.log("  [?] = 未翻开  [✓] = 已看过  > = 第一张  * = 第二张"),this.selectedCard>=0?console.log(`\n当前选中: ${(0,I.zT)(this.selectedCard)} (需要配对)`):console.log("\n");const t=8,s=6;for(let i=0;i<s;i++){let e="  ";for(let s=0;s<t;s++){const r=i*t+s,o=this.cardPositions[r],n=this.matchedCards[o]||o===this.selectedCard||o===this.secondSelectedCard,a=this.seenCards[o];if(n){const t=(0,I.zT)(o),s=o===this.selectedCard?">":o===this.secondSelectedCard?"*":"";e+=`${(s+t).padEnd(3)} `}else e+=a?"[✓] ":"[?] "}console.log(e)}return"渲染完成"},sendCustomButtons(){this.customButtons.push({action:"clickCard",label:"CLICK",method:"clickCard",args:[],description:"CLICK ONE CARD"})}}};var bt=T.pairGame(wt,500);const kt=bt;var Ct=kt;const xt=(0,a.A)(Ct,[["render",vt],["__scopeId","data-v-0f05094e"]]);var Mt=xt;const St={class:"row"},Lt={calss:"center"},_t={class:"m-0 center",style:{width:"25%","max-width":"6.25rem",height:"9.375rem"}},Pt=["onMouseenter","onTouchenter","onMouseleave","onTouchleave"],Et=["onClick"],It={class:"m-0"},Tt=["onMouseenter","onTouchenter","onMouseleave","onTouchleave"];function At(e,t,s,o,n,a){const l=(0,r.g2)("CardImage"),c=(0,r.g2)("GameLayout"),h=(0,r.gN)("move");return(0,r.uX)(),(0,r.Wv)(c,(0,r.v6)(e.gameLayoutProps,{onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",St,[(0,r.Lk)("div",Lt,[(0,r.Lk)("ul",{ref:"container",class:"cardsul rela center",style:(0,u.Tr)([{"padding-left":"0","max-width":"31.25rem",margin:"auto"},{height:e.height/16+"rem"}])},[(0,r.bF)(l,{"card-id":"bg",hide:0===e.cards[0].length,class:"m-0 static card m-0 abso",style:{"max-width":"6.25rem",width:"25%",height:"9.375rem","z-index":"0",left:"0",top:"0"},onClick:t[0]||(t[0]=t=>e.canOperate&&e.clickCard(0))},null,8,["hide"]),(0,r.Lk)("li",{class:(0,u.C4)(["cards m-0 static",{drag:1==e.dragItem}]),style:(0,u.Tr)([{width:"50%",height:"9.375rem"},{zIndex:1==e.dragItem?10:0}])},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards[1].length>=(e.turn>3?1:4-e.turn)?e.turn>3?1:4-e.turn:e.cards[1].length,t=>(0,r.bo)(((0,r.uX)(),(0,r.Wv)(l,{key:e.cards[1][t-1]+(3*e.fresh[1]+1)*e.number,class:(0,u.C4)(["m-0 card abso",{drag:1==e.dragItem,opa0:e.dragCard==e.cards[1][t-1]&&e.enterItem>=0,shanshuo:e.sign==e.cards[1][t-1]}]),style:(0,u.Tr)([{width:"25%",top:"0"},{left:12.5*(3-t)+25+"%",zIndex:3-t}]),"card-id":e.cards[1][t-1]},null,8,["style","class","card-id"])),[[h,{start:e.start,end:e.end,move:e.move}]])),128))],6),(0,r.Lk)("li",_t,[(0,r.Lk)("span",{class:"m-0",style:(0,u.Tr)({color:e.turn>3?"red":"inherit"})},(0,u.v_)(e.turn),5),t[1]||(t[1]=(0,r.Lk)("span",{class:"m-0"},"/3",-1))]),t[2]||(t[2]=(0,r.Lk)("li",{style:{height:"1.875rem",width:"100%"}},null,-1)),((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(4,t=>(0,r.Lk)("li",{key:t,class:(0,u.C4)(["cards m-0 static center",{drag:e.dragItem==t+1}]),style:(0,u.Tr)([{width:"25%",height:"9.375rem"},{zIndex:e.dragItem==t+1?10:1}]),ref_for:!0,ref:"middleBox",onMouseenter:s=>e.enter(t+1),onTouchenter:s=>e.enter(t+1),onMouseleave:s=>e.leave(t+1),onTouchleave:s=>e.leave(t+1)},[(0,r.Lk)("div",{class:"card m-0 abso",style:(0,u.Tr)([{top:"11.25rem",width:"25%"},{zIndex:e.dragItem==t+1?10:1,left:25*(t-1)+"%"}]),onClick:s=>e.canOperate&&e.clickCard(t+1)},[(0,r.Lk)("span",It,(0,u.v_)(e.types[t-1]+"A"),1)],12,Et),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards[t+1],s=>(0,r.bo)(((0,r.uX)(),(0,r.Wv)(l,{key:s+(3*e.fresh[t+1]+2)*e.number,class:(0,u.C4)(["card m-0 abso",{drag:e.dragItem==t+1,shanshuo:e.sign==s,opa0:e.dragCard==s&&e.enterItem>=0}]),style:(0,u.Tr)([{top:"11.25rem",width:"25%"},{left:25*(t-1)+"%"}]),"card-id":s},null,8,["style","class","card-id"])),[[h,{start:e.start,end:e.end,move:e.move}]])),128)),(0,r.bo)((0,r.bF)(l,{"card-id":e.dragCard,style:(0,u.Tr)([{left:25*(t-1)+"%"},{width:"25%",height:"9.375rem",top:"11.25rem"}]),class:"card m-0 abso"},null,8,["card-id","style"]),[[i.aG,e.dragCard>=0&&e.enterItem==t+1]])],46,Pt)),64)),t[3]||(t[3]=(0,r.Lk)("li",{style:{height:"1.875rem",width:"100%"}},null,-1)),((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(4,t=>(0,r.Lk)("li",{key:t+4,class:(0,u.C4)(["cards m-0 static",{drag:e.dragItem==t+5}]),style:(0,u.Tr)([{width:"25%"},{height:(30*e.cards[t+5].length+120)/16+"rem",zIndex:e.dragItem==t+5?10:1}]),ref_for:!0,ref:"downBox",onMouseenter:s=>e.enter(t+5),onTouchenter:s=>e.enter(t+5),onMouseleave:s=>e.leave(t+5),onTouchleave:s=>e.leave(t+5)},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards[t+5],(s,i)=>(0,r.bo)(((0,r.uX)(),(0,r.Wv)(l,{key:s+(3*e.fresh[t+5]+3)*e.number,class:(0,u.C4)(["m-0 card abso",{drag:e.dragItem==t+5,opa0:e.dragItem==t+5&&e.dragCard>=s&&e.enterItem>=0,shanshuo:e.sign==s}]),style:(0,u.Tr)([{width:"25%",height:"9.375rem"},{top:(30*i+360)/16+"rem",left:25*(t-1)+"%"}]),ref_for:!0,ref:"down","card-id":s},null,8,["style","class","card-id"])),[[h,{start:e.start,end:e.end,move:e.move}]])),128)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards[e.dragItem],(s,o)=>(0,r.bo)(((0,r.uX)(),(0,r.Wv)(l,{key:o+8,"card-id":s,style:(0,u.Tr)([{top:(30*e.cards[t+5].length+30*(o-e.cards[e.dragItem].indexOf(e.dragCard))+360)/16+"rem",left:25*(t-1)+"%"},{width:"25%",height:"9.375rem"}]),class:"card m-0 abso"},null,8,["card-id","style"])),[[i.aG,e.enterItem==t+5&&(e.dragItem>=6&&e.dragCard>=s||e.dragCard==s)]])),128))],46,Tt)),64))],4)])])]),_:1},16,["onUndo","onGoon","onStep","onAuto"])}s(8237);var $t={},Ot=function(e,t){return t&&(e=e.touches[0]),[e.clientX,e.clientY]},zt=function(e,t,s){const i=e._moveData;i.position=Ot(t,s),i.offsetX=i.position[0]-i.startPosition[0],i.offsetY=i.position[1]-i.startPosition[1]},Gt=function(e,t){return e.cancelable&&e.preventDefault(),!t&&e.stopPropagation(),!1},Ft=(e,t,s,i,r)=>{e.dispatchEvent(new CustomEvent(t,{detail:s,bubbles:i,cancelable:r}))};$t.emit=Ft;var Nt=(e,t,s={})=>{for(const i of t)"function"===typeof s[i]&&e.addEventListener(i,s[i])};$t.listenEvents=Nt,$t.mounted=function(e,t,s){if(!e._isInitMove){e._isInitMove=!0;var{page:i=window}=t.value||{},{bubbles:r}=t.modifiers;Nt(e,["start","move","end"],t.value);var o,n=!1;e.addEventListener("touchstart",l),e.addEventListener("mousedown",l)}function a(){n=!1,e.removeEventListener("cancel",a),o?(i.removeEventListener("touchend",h),i.removeEventListener("touchmove",c),i.removeEventListener("touchcancel",h)):(i.removeEventListener("mouseup",h),i.removeEventListener("mousemove",c))}function l(n){return o="touchstart"===n.type,e.addEventListener("cancel",a),o?(i.addEventListener("touchend",h,{passive:!1}),i.addEventListener("touchmove",c,{passive:!1}),i.addEventListener("touchcancel",h,{passive:!1})):(i.addEventListener("mouseup",h,{passive:!1}),i.addEventListener("mousemove",c,{passive:!1})),e._moveData||(e._moveData={isTouch:o}),e._moveData.startPosition=Ot(n,o),Ft(e,"start",{el:e,binding:t,vnode:s}),Gt(n,r)}function c(i){return zt(e,i,o),Ft(e,"move",{el:e,binding:t,vnode:s}),n=!0,Gt(i,r)}function h(i){if(!n){const t=e._moveData;t.offsetX=0,t.offsetY=0,Ft(e,"notmove")}return Ft(e,"end",{el:e,binding:t,vnode:s}),Ft(e,"cancel"),Gt(i,r)}},$t.bind=$t.mounted,$t.install=function(e){e.directive("move",$t)};var Bt=$t;const Rt={name:"Spider",data(){return{title:"Spider",cards:[[],[],[],[],[],[],[],[],[],[]],fresh:[0,0,0,0,0,0,0,0,0,0],sign:-99,index:-99,dragCard:-99,dragItem:-99,enterItem:-99,turn:1,number:52}},directives:{move:Bt},created:function(){this.sendCustomButtons(),this.setupGameStateListeners()},mounted(){let e=e=>()=>this.moveEnter(e);if(this.$refs.middleBox&&this.$refs.downBox){this.middleEnters=[],this.downEnters=[];for(let t=0;t<4;t++){let s=this.$refs.middleBox[t],i=this.$refs.downBox[t];this.middleEnters[t]=e(t+2),this.downEnters[t]=e(t+6),s.addEventListener("mousemove",this.middleEnters[t]),s.addEventListener("touchmove",this.middleEnters[t]),i.addEventListener("mousemove",this.downEnters[t]),i.addEventListener("touchmove",this.downEnters[t])}}},beforeUnmount(){if(this.gameManager.off("stateChange"),this.$refs.middleBox&&this.$refs.downBox&&this.middleEnters&&this.downEnters)for(let e=0;e<4;e++){let t=this.$refs.middleBox[e],s=this.$refs.downBox[e];t.removeEventListener("mousemove",this.middleEnters[e]),t.addEventListener("touchmove",this.middleEnters[e]),s.addEventListener("mousemove",this.downEnters[e]),s.addEventListener("touchmove",this.downEnters[e])}},methods:{setupGameStateListeners(){this.gameManager.on("stateChange",()=>{this.$forceUpdate()})},init(){this.gameManager.init();for(let t=0;t<10;t++)this.cards[t].splice(0);this.fresh=[0,0,0,0,0,0,0,0,0,0],this.turn=1,this.sign=-99,this.dragItem=-99,this.dragCard=-99,this.enterItem=-99;let e=this.cards[0];for(let t=0;t<this.number;t++)e.push(t);M(e,this.number);for(let t=6;t<10;t++)this.cards[t].push(this.cards[0].splice(-1)[0])},findPos(e){for(let t=2;t<10;t++)if(this.cards[t].indexOf(e)>=0)return t;return-99},addAndCheck(e,t){let s=L(this.record,[e,t]);return!!s&&(this.record.unshift([e,t]),!0)},checkDown(e){if(!this.addAndCheck(e,1))return;let t=e%2,s=e>>2;if(12==s)return!1;let i,r=(s+1)%13*4+!t,o=r+2,n=this.findPos(r),a=this.findPos(o);if(n<0&&a<0)return!1;if(n>=6&&a>=6){let t=this.findPos(e),s=this.cards[n][this.cards[n].length-1],i=this.cards[a][this.cards[a].length-1];return(s==r||i==o)&&(t!=(s==r?n:a)&&[t,s==r?n:a])}if(n>=6||a>=6){let t=n>=6?this.cards[n]:this.cards[a],s=n>=6?r:o,i=t.indexOf(s);if(i==t.length-1){let t=this.findPos(e);if(t!=(n>=6?n:a))return[t,n>=6?n:a]}else{let e=this.checkUp(t[i+1]);if(e)return e}if(n<0||a<0)return!1}if(n-2==r%4){let e=0,t=this.cards[n][this.cards[n].length-1];while(t-4*e>=r){let s=this.checkDown(t-4*e);if(!s)break;i||(i=s),e++}if(t-4*e<r)return i}if(a-2==o%4){let e=0,t=this.cards[a][this.cards[a].length-1];while(t-4*e>=o){let s=this.checkDown(t-4*e);if(!s)break;i||(i=s),e++}if(t-4*e<o)return i}return!1},checkUp(e){if(!this.addAndCheck(e,2))return;let t=e%4,s=e>>2,i=[];for(let r=0;r<=s;r++){let e=4*r+t,o=this.findPos(e);if(o<0){if(r==s){i.push([o,t+2]);break}return!1}if(o==t+2)continue;let n=this.cards[o].indexOf(e);if(n==this.cards[o].length-1){i.push([o,t+2]);continue}let a=this.checkMove(this.cards[o][n+1]);if(!a)return!1;i.push(a)}return i[0]},checkMove(e){if(this.addAndCheck(e,0))return this.checkDown(e)||this.checkUp(e)},async stepFn(){await this.gameManager.step(async()=>{let e=!1;for(let t=6;t<10;t++)if(this.record=[],e=this.checkMove(this.cards[t][0]),e){if(!this.skipCheck&&!L(this.gameManager.history,[e[1],e[0]]))continue;break}if(this.record=[],!e&&this.cards[1].length>0&&(e=this.checkMove(this.cards[1][0])),!e||!this.skipCheck&&!L(this.gameManager.history,[e[1],e[0]]))return this.clickCard(0);this.skipCheck=!1,this.sign=-99,await this.clickCard(e[0]<0?1:e[0]),await this.wait(),await this.clickCard(e[1])})},async addCard(){for(let e=6;e<10;e++)this.cards[e].length<=0&&(this.cards[1].length>0?(this.gameManager.recordOperation([e,1,0,1],!0),this.cards[e].push(this.cards[1].splice(0,1)[0])):this.cards[0].length>0&&(this.gameManager.recordOperation([e,0,this.cards[0].length-1,1],!0),this.cards[e].push(this.cards[0].splice(-1)[0])));if(this.cards[0].length<=0&&this.cards[1].length<=0){if(this.lock)return!1;this.dragCard=-99,this.dragItem=-99,this.enterItem=-99,this.lock=!0;for(let e=0;e<this.number;e++){let t=e%4;while(this.cards[t+2].length<=e>>2){this.record=[];let t=this.checkUp(e);if(!t||!this.skipCheck&&!L(this.gameManager.history,[t[1],t[0]]))for(let e=6;e<10;e++)if(!(this.cards[e].length<=0||this.cards[e][0]>>2>=12)&&(this.record=[],t=this.checkMove(this.cards[e][0]),t)){if(!this.skipCheck&&!L(this.gameManager.history,[t[1],t[0]])){t=!1;continue}break}if(t){this.skipCheck=!1,this.sign=-99,await this.clickCard(t[0]),await this.wait(),await this.clickCard(t[1]);for(let t=6;t<10;t++)if(this.cards[t].length<=0){let s,i=this.findPos(e);if(this.cards[i][this.cards[i].length-1]!=e){let s=this.cards[i].indexOf(e),r=[t,i,s+1,this.cards[i].length-s-1,e];this.cards[t].push(...this.cards[i].splice(s+1)),this.gameManager.recordOperation(r,!0);continue}for(s=48;s<52;s++){let e=this.findPos(s);if(e<6)continue;let i=this.cards[e].indexOf(s);if(s<=0)continue;let r=[t,e,i,this.cards[e].length-i,s];if(L(this.gameManager.history,r)){this.cards[t].push(...this.cards[e].splice(i)),this.gameManager.recordOperation(r,!0);break}}if(s<52)continue;for(s=6;s<10;s++)if(this.cards[s].length>1){let e=[t,s,this.cards[s].length-1,1];if(!L(this.gameManager.history,e))continue;this.cards[t].push(this.cards[s].splice(-1)[0]),this.gameManager.recordOperation(e,!0);break}}}else this.skipCheck=!0}}this.sign=-99,this.gameManager.setWin(),this.lock=!1}},async clickCard(e){let t=this.cards[e].length;if(0==e){if(this.cards[0].length>0)this.gameManager.recordOperation([1,0,this.turn>3?1:4-this.turn],!0),this.cards[1].unshift(...this.cards[0].splice(this.turn>3?-1:this.turn-4));else{for(let e=0;e<this.gameManager.history.length;e++){let t=this.gameManager.history[e];if(0==t[0]&&1==t[1])this.skipCheck=!0;else if(1!=t[0]||0!=t[1])break}this.gameManager.recordOperation([0,1,this.cards[1].length],!0),this.cards[0].unshift(...this.cards[1].splice(0)),this.turn++}this.sign=-99}else if(1==e)t>0&&(this.sign=this.cards[e][0],this.index=e);else if(e<6)this.sign==e-2+4*t?(this.gameManager.recordOperation([e,this.index,this.cards[this.index].indexOf(this.sign),1],!0),this.cards[e].push(this.cards[this.index].splice(this.cards[this.index].indexOf(this.sign),1)[0]),this.sign=-99):t>0&&(this.sign=this.cards[e][t-1],this.index=e);else{let s,i=this.cards[e][t-1];this.sign>=0&&this.index>=6&&(s=this.cards[this.index].findIndex(e=>e>>2<13&&e%2!=i%2&&(1+(e>>2))%13==i>>2))>=0?(this.gameManager.recordOperation([e,this.index,s,this.cards[this.index].length-s,i],!0),this.cards[e].push(...this.cards[this.index].splice(s)),this.sign=-99):this.sign>=0&&this.index<6&&this.sign>>2<13&&this.sign%2!=i%2&&(1+(this.sign>>2))%13==i>>2?(this.gameManager.recordOperation([e,this.index,this.cards[this.index].indexOf(this.sign),1,i],!0),this.cards[e].push(this.cards[this.index].splice(this.cards[this.index].indexOf(this.sign),1)[0]),this.sign=-99):t>0&&(this.sign=i,this.index=e)}this.sign<0&&await this.addCard()},undo(){if(this.sign=-99,this.step<=0)return;let e=this.gameManager.history.shift(),t=!1;if(0==e[1]){if(1==e[0])return this.cards[0].push(...this.cards[1].splice(0,e[2]));t=!0,this.cards[0].push(this.cards[e[0]].splice(0,1)[0])}else if(1==e[1]){if(0==e[0])return this.cards[1].unshift(...this.cards[0].splice(0)),void this.turn--;if(this.cards[1].unshift(this.cards[e[0]].splice(-1)[0]),t=!0,e[0]<6||this.cards[e[0]].length>0)return}t&&(e=this.gameManager.history.shift()),this.cards[e[1]].splice(e[2],0,...this.cards[e[0]].splice(-e[3]))},start(e){let t=-1;if(e.detail.binding&&e.detail.binding.value&&void 0!==e.detail.binding.value.cardId&&(t=parseInt(e.detail.binding.value.cardId)),t<0&&e.detail.vnode&&e.detail.vnode.componentInstance){const s=e.detail.vnode.componentInstance;void 0!==s.cardId&&(t=parseInt(s.cardId))}if(t<0&&e.detail.el.dataset.cardId&&(t=parseInt(e.detail.el.dataset.cardId)),!this.canOperate||t<0)return!1;let s=this.findPos(t);if(s<0&&t!=this.cards[1][0])return;let i=e.detail.el._moveData;i.offsetLeft=e.detail.el.offsetLeft,i.offsetTop=e.detail.el.offsetTop,this.dragItem=s,this.dragItem<0&&(this.dragItem=1),this.dragCard=t,this.enterItem=-99},async end(e){let t=this.dragItem;if(!this.canOperate)return;if(1==t&&this.dragCard!=this.cards[1][0])return;let s=e.detail.el._moveData,i=s.offsetX+s.offsetLeft,r=s.offsetY+s.offsetTop,o=Math.floor((i+50)/this.cardWidth);o>=0&&o<4&&r>=115&&r<=this.height-75&&(o+=r<=330?2:6,await this.clickCard(t).catch(console.log),this.sign>=0&&o!=t&&o>=0&&await this.clickCard(o).catch(console.log)),this.fresh[t]++,this.enterItem=-99,this.dragItem=-99,this.dragCard=-99},enter(e){console.log("enter",e)},leave(e){console.log("leave",e)},moveEnter(e){console.log("moveEnter",e,this.dragItem)},move(e){if(!this.canOperate)return!1;if(1==this.dragItem&&this.dragCard!=this.cards[1][0])return;let t=e.detail.el._moveData,s=t.offsetX+t.offsetLeft,i=t.offsetY+t.offsetTop,r=Math.floor((s+50)/this.cardWidth);if(r>=0&&r<4&&i>=115&&i<=this.height-75?(r+=i<=330?2:6,this.dragItem!=r&&(this.enterItem=r)):this.enterItem=-99,e.detail.el.style.left=s/16+"rem",e.detail.el.style.top=i/16+"rem",this.dragItem>=6){let e=this.cards[this.dragItem].indexOf(this.dragCard),s=0;for(let i of this.$refs.down){let r=i.$el._cardImageRoot.className.match("drag");!r||++s<=e||(i.$el._cardImageRoot.style.left=(t.offsetX+t.offsetLeft)/16+"rem",i.$el._cardImageRoot.style.top=(t.offsetY+t.offsetTop+30*(s-e-1))/16+"rem")}}},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║            蜘蛛纸牌 (Spider)                  ║"),console.log("╚════════════════════════════════════════════════╝");const e=this.cards.slice(1).reduce((e,t)=>e+t.length,0),t=this.cards[0].length;console.log(`\n步数: ${this.step} | 牌堆剩余: ${t} 张 | 场上: ${e} 张\n`),console.log("提示: ← 表示选中的牌"),console.log("┌──────────────┬──────────────┬──────────────┬──────────────┐");const s=this.cards[1],i=t>0?`🂠 ${t}张`:"(空)",r=s.slice(0,3).map(e=>{const t=(0,I.zT)(e),s=this.sign===e;return`${t}${s?" ←":""}`});console.log(`│ 牌堆: ${i.padEnd(5)} │ ${(r[0]||"").padEnd(12)} │ ${(r[1]||"").padEnd(12)} │ ${(r[2]||"").padEnd(12)} │`),console.log("├──────────────┼──────────────┼──────────────┼──────────────┤");const o=[];for(let c=2;c<=5;c++){const e=this.cards[c];if(0===e.length)o.push("-:"+this.types[c-2]+"?");else{const t=e[e.length-1],s=(0,I.zT)(t),i=this.sign===t;o.push(`${e.length-1}:${s}${i?" ←":""}`)}}console.log(`│ ${o[0].padEnd(12)} │ ${o[1].padEnd(12)} │ ${o[2].padEnd(12)} │ ${o[3].padEnd(12)} │`),console.log("├──────────────┼──────────────┼──────────────┼──────────────┤");const n=[];for(let c=6;c<=9;c++){const e=this.cards[c];if(0===e.length)n.push("");else{const t=[];for(let s=0;s<e.length;s++){const i=e[s],r=(0,I.zT)(i),o=this.sign===i;t.push(`${s}:${r}${o?" ←":""}`)}n.push(`${t.join("\n")}`)}}const a=Math.max(...n.map(e=>e.split("\n").length)),l=n.map(e=>{const t=e.split("\n");while(t.length<a)t.push("");return t});for(let c=0;c<a;c++){const e=l.map(e=>e[c].padEnd(12));console.log(`│ ${e.join(" │ ")} │`)}return console.log("└──────────────┴──────────────┴──────────────┴──────────────┘"),"渲染完成"},sendCustomButtons(){this.customButtons.push({action:"deal",label:"DEAL",method:"clickCard",args:[0],description:"DEAL FROM THE DECK"})}},watch:{cards:{handler(){this.sendCustomButtons()},deep:!0}},computed:{height(){return 30*Math.max(...this.cards.slice(-4).map(e=>e.length))+480},cardWidth(){return this.$refs.container?this.$refs.container.offsetWidth>>2:500}}};var Xt=T.cardGame(Rt,500);const Dt=Xt;var Wt=Dt;const Ut=(0,a.A)(Wt,[["render",At],["__scopeId","data-v-f91447be"]]);var jt=Ut;const Vt={class:"row center"},qt={class:"cardsul center",style:{"padding-left":"0",margin:"0",width:"100%","max-width":"37.5rem","background-color":"#719192",padding:"0.3125rem 0"}},Ht=["onClick"],Kt={class:"shanshuo abso",style:{width:"100%",height:"100%","background-color":"#ff5722",top:"0",left:"0"}},Qt=["src"],Jt={class:"row"},Yt={class:"m-0 scrore"};function Zt(e,t,s,o,n,a){const l=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(l,(0,r.v6)(e.gameLayoutProps,{"container-style":{width:"100%"},onUndo:e.undo,onGoon:e.goon,onStep:e.stepTwiceFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",Vt,[(0,r.Lk)("div",null,[(0,r.Lk)("div",qt,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.cards1,(t,s)=>((0,r.uX)(),(0,r.CE)("div",{key:s,class:"m-0 center",style:{width:"16%","border-radius":"50%",overflow:"hidden"},onClick:t=>e.canOperate&&e.clickCard(s)},[(0,r.Lk)("div",{class:"center",style:(0,u.Tr)([{width:"100%",position:"relative"},{backgroundColor:t<0?"transparent":e.cards2[t]?t==e.sign?"#FFB800":e.grades[t]==e.grade?"#01AAED":"#5FB878":"#fff"}])},[(0,r.bo)((0,r.Lk)("div",Kt,null,512),[[i.aG,e.validBoxes.indexOf(s)>=0]]),(0,r.Lk)("img",{style:(0,u.Tr)([{transform:e.cards2[t]&&e.grades[t]!=e.grade?"rotate(180deg)":"rotate(0)",opacity:t<0?0:100},{width:"100%"}]),src:e.cards2[t]?"./static/avatar/"+t+".webp":"./static/avatar/logo.webp"},null,12,Qt)],4)],8,Ht))),128))])])]),(0,r.Lk)("div",Jt,[(0,r.Lk)("span",Yt,(0,u.v_)(e.lowCount+" : "+e.highCount),1)])]),_:1},16,["onUndo","onGoon","onStep","onAuto"])}let es=[[1,0],[1,1],[2,1],[2,2],[3,1],[3,2],[3,3]];const ts={name:"GridBattle",data(){return{title:"GridBattle",cards1:[],cards2:[],sign:-1,number:36,grade:-1,modes:[0,1,3,6,10,15,2,5,7,13,18,21,4,8,14,17,24,27,9,12,20,25,26,31,11,19,23,29,30,35,16,22,28,32,34,33],grades:[1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,0,1,1,0,1,0,0,1,1,0,0,1,1,1]}},computed:{validBoxes(){return this.getValidBoxes(this.sign)},lowCount(){return this.cards1.filter(e=>0===this.grades[e]).length},highCount(){return this.cards1.filter(e=>1===this.grades[e]).length}},methods:{init(){this.sign=-1,this.grade=-1,this.cards1.splice(0),this.cards2.splice(0);let e=this.cards1;for(let t=0;t<this.number;t++)e.push(t),this.cards2.push(!1);M(e,this.number)},recordMove(e,t,s,i,r){this.gameManager.recordOperation({type:"move",from:e,to:t,card:s,sign:i,signIndex:r,timestamp:Date.now()})},recordFlip(e){this.gameManager.recordOperation({type:"flip",card:e,timestamp:Date.now()})},handleUndo(e){switch(e.type){case"move":this.cards1.splice(e.signIndex,1,e.sign),this.cards1.splice(e.to,1,e.card>=0?e.card:-1);break;case"flip":this.cards2[e.card]=!1;break}},undo(){this.gameManager.undo(),this.gameManager.undo()},async clickCard(e,t){let s=this.cards1[e];if(this.grade<0&&(this.grade=this.grades[s]),s>=0&&!this.cards2[s])return this.cards2[s]=!0,this.recordFlip(s),this.sign=-1,void(t||this.gameManager.step(async()=>{await this.wait(),await this.stepFn()}));let i=this.step%2==0?this.grade:!this.grade;if(this.sign>=0&&this.grades[this.sign]!=i)this.sign=s!=this.sign&&s>=0&&this.grades[s]!=i?s:-1;else{if(this.sign>=0&&this.grades[this.sign]==i){if(s>=0&&this.grades[s]==i)return void(this.sign=this.sign==s?-1:s);if(this.validBoxes.indexOf(e)>=0){let i=this.cards1.indexOf(this.sign);return this.cards1.splice(i,1,-1),this.cards1.splice(e,1,this.sign),this.recordMove(i,e,s,this.sign,i),this.sign=-1,s>=0&&(this.lowCount<=0&&(1==this.grade?this.gameManager.setWin():this.gameManager.setLose()),this.highCount<=0&&(0==this.grade?this.gameManager.setWin():this.gameManager.setLose()),1==this.lowCount&&1==this.highCount&&this.gameManager.setDraw()),void(t||this.gameManager.step(async()=>{await this.wait(),await this.stepFn()}))}}this.sign=s}},async stepTwiceFn(){await this.gameManager.step(async()=>{await this.stepFn(),await this.wait(),await this.stepFn()})},getValidBoxes(e){let t=[],s=this.cards1.indexOf(e);if(e<0||s<0)return t;let i=this.modes.indexOf(e),r=es[Math.floor(i/6)],o=es[i%6];return s+6*o[0]<36&&s%6+o[1]<6&&t.push(s+6*o[0]+o[1]),s-6*o[0]>=0&&s%6+o[1]<6&&t.push(s-6*o[0]+o[1]),s+6*o[0]<36&&s%6-o[1]>=0&&t.push(s+6*o[0]-o[1]),s-6*o[0]>=0&&s%6-o[1]>=0&&t.push(s-6*o[0]-o[1]),s+6*r[1]<36&&s%6+r[0]<6&&t.push(s+6*r[1]+r[0]),s-6*r[1]>=0&&s%6+r[0]<6&&t.push(s-6*r[1]+r[0]),s+6*r[1]<36&&s%6-r[0]>=0&&t.push(s+6*r[1]-r[0]),s-6*r[1]>=0&&s%6-r[0]>=0&&t.push(s-6*r[1]-r[0]),t},async stepFn(){let e=[],t=[],s=[],i=this.step%2==0?this.grade:!this.grade,r=this,o=async function(e,t){r.sign=-1,await r.clickCard(e,!0),await r.wait(),await r.clickCard(t,!0)};for(let u=0;u<this.cards1.length;u++){let r=this.cards1[u];if(r<0){e[u]=e[u]||1;continue}if(!this.cards2[r]){e[u]=e[u]||3,t.push(u);continue}if(this.grades[r]==i){e[u]=7,s.push(u);let t=this.getValidBoxes(r);for(let s of t){let t=this.cards1[s];if(!(t<0))if(this.cards2[t]){if(this.grades[t]!=i)return await o(u,s)}else e[s]=5==e[s]||6==e[s]?6:4}continue}e[u]=9;let n=this.getValidBoxes(r);for(let t of n){let s=this.cards1[t];s<0?e[t]=2:this.cards2[s]?this.grades[s]==i&&(e[t]=8):e[t]=4==e[t]||6==e[t]?6:5}}for(let u of s){let t=e[u];if(8==t){let t=this.cards1[u],s=this.getValidBoxes(t);for(let i of s)if(1==e[i])return await o(u,i)}}let n=-1,a=-1;for(let u=0;u<t.length;u++){let s=t[u],i=e[s];if(4==i)return await this.clickCard(s,!0);5==i&&(a=s,t.splice(u,1),u--),6==i&&(n=s)}if(n>=0)return await this.clickCard(n,!0);if(t.length>0){let e=Math.floor(E()*t.length);return await this.clickCard(t[e],!0)}let l=!1,c=[],h=[],d={};for(let u of s){let t=this.cards1[u],s=this.getValidBoxes(t);for(let i of s)1==e[i]&&(d[i]=(d[i]||0)+1)}for(let u of s){let t=this.cards1[u],s=this.getValidBoxes(t);for(let i of s)1==e[i]&&(d[i]>=2?h.push([u,i]):c.push([u,i])),2==e[i]&&(l=[u,i])}if(h.length>0){let e=Math.floor(E()*h.length);return await o(h[e][0],h[e][1])}if(c.length>0){let e=Math.floor(E()*c.length);return await o(c[e][0],c[e][1])}if(a>=0)return await this.clickCard(a,!0);if(l)return await o(l[0],l[1]);throw new Error("unkown error")},renderTextView(){if(console.log("\n╔════════════════════════════════════════════════╗"),console.log("║           国际象棋 (GridBattle)               ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step}`),console.log(`高子: ${this.highCount} | 低子: ${this.lowCount}\n`),console.log("\n图例:"),console.log("  ? = 未翻开  - = 空位置  H = 高子  L = 低子  [H/L] = 已选中"),this.sign>=0){const e=Math.floor(this.sign/6),t=this.sign%6;console.log(`\n当前选中: (${e},${t})`);const s=this.validBoxes;if(s&&s.length>0){const e=s.map(e=>{const t=Math.floor(e/6),s=e%6;return`(${t},${s})`}).join(", ");console.log(`可移动到: ${e}`)}}console.log("    0   1   2   3   4   5"),console.log("  ┌───┬───┬───┬───┬───┬───┐");for(let e=0;e<6;e++){let t=`${e} │`;for(let s=0;s<6;s++){const i=6*e+s,r=this.cards1[i];if(this.cards2[r]){const e=this.grades[r],s=1===e?" H ":" L ",o=i===this.sign;t+=o?`[${s.trim()}]`:s}else this.cards1[i]>=0?t+=" ? ":t+=" - ";t+="│"}console.log(t),e<5&&console.log("  ├───┼───┼───┼───┼───┼───┤")}return console.log("  └───┴───┴───┴───┴───┴───┘"),"渲染完成"}}};var ss=T.strategyGame(ts,1200),is=ss;const rs=(0,a.A)(is,[["render",Zt],["__scopeId","data-v-f1b2a642"]]);var os=rs;const ns={class:"row"},as={class:"row"},ls={class:"towers-container center",style:{padding:"1rem",margin:"0",width:"100%","max-width":"37.5rem","background-color":"#719192","border-radius":"0.5rem"}},cs=["onClick"],hs={class:"tower-label"},ds={class:"disks-container"},us={class:"row",style:{"margin-top":"1rem"}},gs={style:{"text-align":"center",color:"#dfcdc3","font-size":"1rem"}},fs={key:0},ms={key:1},ps={class:"row"},ys={class:"difficulty-selector"},vs={class:"small"},ws={class:"small"},bs={class:"small"};function ks(e,t,s,o,n,a){const l=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(l,(0,r.v6)(e.gameLayoutProps,{onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",ns,[(0,r.Lk)("span",null,"步数: "+(0,u.v_)(e.step),1),t[2]||(t[2]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("span",null,"移动次数: "+(0,u.v_)(e.moveCount),1),t[3]||(t[3]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("span",null,"最优解: "+(0,u.v_)(e.minMoves)+" 步",1)]),(0,r.Lk)("div",as,[(0,r.Lk)("div",null,[(0,r.Lk)("div",ls,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.towers,(s,i)=>((0,r.uX)(),(0,r.CE)("div",{key:i,class:(0,u.C4)(["tower",{selected:e.selectedTower===i}]),onClick:t=>e.canOperate&&e.clickTower(i)},[(0,r.Lk)("div",hs,(0,u.v_)(e.getTowerName(i)),1),t[4]||(t[4]=(0,r.Lk)("div",{class:"tower-base"},null,-1)),t[5]||(t[5]=(0,r.Lk)("div",{class:"tower-pole"},null,-1)),(0,r.Lk)("div",ds,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s,t=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:(0,u.C4)(["disk",e.getDiskClass(t)]),style:(0,u.Tr)(e.getDiskStyle(t))},(0,u.v_)(t),7))),128))])],10,cs))),128))])])]),(0,r.Lk)("div",us,[(0,r.Lk)("div",gs,[e.selectedTower>=0?((0,r.uX)(),(0,r.CE)("span",fs," 已选中: "+(0,u.v_)(e.getTowerName(e.selectedTower))+" - 点击目标柱子移动圆盘 ",1)):((0,r.uX)(),(0,r.CE)("span",ms,"点击柱子选择圆盘"))])]),(0,r.Lk)("div",ps,[(0,r.Lk)("div",ys,[t[7]||(t[7]=(0,r.Lk)("label",null,"圆盘数量: ",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.diskCount=t),onChange:t[1]||(t[1]=(...t)=>e.resetGame&&e.resetGame(...t)),style:{padding:"0.5rem 1rem",border:"0.125rem solid #6c757d","border-radius":"0.375rem",background:"white","font-size":"1rem","font-weight":"bold",color:"#495057",cursor:"pointer"}},[...t[6]||(t[6]=[(0,r.Lk)("option",{value:"3"},"3个圆盘",-1),(0,r.Lk)("option",{value:"4"},"4个圆盘",-1),(0,r.Lk)("option",{value:"5"},"5个圆盘",-1),(0,r.Lk)("option",{value:"6"},"6个圆盘",-1),(0,r.Lk)("option",{value:"7"},"7个圆盘",-1),(0,r.Lk)("option",{value:"8"},"8个圆盘",-1)])],544),[[i.u1,e.diskCount]])])])]),"win-content":(0,r.k6)(()=>[(0,r.Lk)("h1",vs,"步数: "+(0,u.v_)(e.step),1),(0,r.Lk)("h1",ws,"移动次数: "+(0,u.v_)(e.moveCount),1),(0,r.Lk)("h1",bs,"最优解: "+(0,u.v_)(e.minMoves)+" 步",1)]),_:1},16,["onUndo","onGoon","onStep","onAuto"])}const Cs={name:"TowerHanoi",data(){return{title:"Tower of Hanoi",towers:[[],[],[]],selectedTower:-1,diskCount:4,moveCount:0,minMoves:0}},methods:{init(){this.resetGame()},resetGame(){this.towers=[[],[],[]],this.selectedTower=-1,this.moveCount=0,this.minMoves=Math.pow(2,this.diskCount)-1;for(let e=this.diskCount;e>=1;e--)this.towers[0].push(e);this.gameManager.recordOperation()},clickTower(e){-1!==this.selectedTower?this.selectedTower!==e?this.moveDisk(this.selectedTower,e):this.selectedTower=-1:this.towers[e].length>0&&(this.selectedTower=e,this.gameManager.recordOperation())},moveDisk(e,t){const s=this.towers[e],i=this.towers[t];if(0===s.length)return void(this.selectedTower=-1);const r=s[s.length-1];0===i.length||i[i.length-1]>r?(s.pop(),i.push(r),this.moveCount++,this.selectedTower=-1,this.gameManager.recordOperation({type:"move",from:e,to:t,disk:r,moveCount:this.moveCount}),this.checkGameCompletion()):this.selectedTower=-1},checkGameCompletion(){this.towers[2].length!==this.diskCount?this.hasValidMoves()||this.gameManager.setLose():this.gameManager.setWin()},hasValidMoves(){return!0},async stepFn(){await this.gameManager.step(async()=>{await this.solveHanoi(this.diskCount,0,2,1)})},async solveHanoi(e,t,s,i){1===e?(this.moveDisk(t,s),await this.wait()):(await this.solveHanoi(e-1,t,i,s),this.moveDisk(t,s),await this.wait(),await this.solveHanoi(e-1,i,s,t))},handleUndo(e){if("move"===e.type){const t=this.towers[e.to].pop();this.towers[e.from].push(t),this.moveCount--,this.selectedTower=-1}},getTowerName(e){const t=["A塔","B塔","C塔"];return t[e]||"未知塔"},getDiskClass(e){return`disk-size-${e}`},getDiskStyle(e){const t=40,s=20,i=t+(e-1)*s;return{width:`${i}px`,backgroundColor:this.getDiskColor(e)}},getDiskColor(e){const t=["linear-gradient(45deg, #ff6b6b, #ee5a52)","linear-gradient(45deg, #4ecdc4, #44a08d)","linear-gradient(45deg, #45b7d1, #3498db)","linear-gradient(45deg, #f9ca24, #f0932b)","linear-gradient(45deg, #6c5ce7, #5f3dc4)","linear-gradient(45deg, #fd79a8, #e84393)","linear-gradient(45deg, #00b894, #00a085)","linear-gradient(45deg, #a29bfe, #6c5ce7)"];return t[e-1]||t[0]},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║            汉诺塔 (Tower of Hanoi)             ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step} | 移动次数: ${this.moveCount} | 最优解: ${this.minMoves} 步\n`);const e=["A塔","B塔","C塔"],t=this.diskCount;for(let s=t-1;s>=0;s--){let e="";for(let i=0;i<3;i++){const r=this.towers[i],o=s-(t-r.length);if(o>=0&&o<r.length){const t=r[o],s="█".repeat(2*t+1);e+=`  ${s.padStart(this.diskCount+1," ").padEnd(2*this.diskCount+1," ")}  `}else e+=`  ${"|".padStart(this.diskCount+1," ").padEnd(2*this.diskCount+1," ")}  `}console.log(e)}return console.log("  "+"═".repeat(2*this.diskCount+1)+"    "+"═".repeat(2*this.diskCount+1)+"    "+"═".repeat(2*this.diskCount+1)+"  "),console.log(`  ${e[0].padStart(this.diskCount+1," ").padEnd(2*this.diskCount+1," ")}  ${e[1].padStart(this.diskCount+1," ").padEnd(2*this.diskCount+1," ")}  ${e[2].padStart(this.diskCount+1," ").padEnd(2*this.diskCount+1," ")}  `),this.selectedTower>=0&&console.log(`\n已选中: ${e[this.selectedTower]}`),"渲染完成"},getAvailableActions(){const e=[],t=["A塔","B塔","C塔"];e.push({id:1,label:"重新开始 (RESTART)",method:"goon",args:[]});for(let s=0;s<3;s++){const i=this.towers[s].length>0;if(-1===this.selectedTower)i&&e.push({id:e.length+1,label:`选择${t[s]}`,method:"clickTower",args:[s]});else{if(s!==this.selectedTower){const i=0===this.towers[s].length||this.towers[this.selectedTower][this.towers[this.selectedTower].length-1]<this.towers[s][this.towers[s].length-1];i&&e.push({id:e.length+1,label:`移动到${t[s]}`,method:"clickTower",args:[s]})}e.push({id:e.length+1,label:"取消选择",method:"clickTower",args:[this.selectedTower]})}}return e}},computed:{completionPercentage(){const e=this.towers[2].length;return Math.round(e/this.diskCount*100)},efficiencyScore(){if(0===this.moveCount)return 100;const e=this.minMoves,t=this.moveCount;return Math.round(e/t*100)}},watch:{moveCount(e,t){e>t&&console.log(`移动次数: ${e}`)}}};var xs=T.puzzleGame(Cs,800),Ms=T.puzzleGame(xs,800);const Ss=(0,a.A)(Ms,[["render",ks],["__scopeId","data-v-b6aabbc0"]]);var Ls=Ss;const _s={class:"row"},Ps={class:"row"},Es={class:"cardsul center",style:{"padding-left":"0",margin:"0",width:"100%","max-width":"37.5rem","background-color":"#719192",padding:"0.3125rem 0"}},Is=["onClick"],Ts={class:"center",style:{width:"100%",height:"100%",position:"relative","font-size":"1.125rem","font-weight":"bold",color:"white"}},As={key:0},$s={key:1},Os={key:2},zs={key:3},Gs={class:"row",style:{"margin-top":"1rem"}},Fs={style:{"text-align":"center",color:"#dfcdc3","font-size":"1rem"}},Ns={key:0},Bs={key:1},Rs={key:2},Xs={class:"small"},Ds={class:"small"};function Ws(e,t,s,i,o,n){const a=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(a,(0,r.v6)(e.gameLayoutProps,{onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",_s,[(0,r.Lk)("span",null,"步数: "+(0,u.v_)(e.step),1),t[0]||(t[0]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("span",null,"当前数字数量: "+(0,u.v_)(e.currentNumberCount),1)]),(0,r.Lk)("div",Ps,[(0,r.Lk)("div",null,[(0,r.Lk)("div",Es,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.grid,(t,s)=>((0,r.uX)(),(0,r.CE)("div",{key:s,class:"m-0 center",style:(0,u.Tr)([{width:"16%",height:"3.125rem","border-radius":"0.3125rem",overflow:"hidden",margin:"0.125rem",cursor:"pointer"},{backgroundColor:0===t?"#4CAF50":99===t?"#FF5722":-1===t?"#E0E0E0":"#5FB878",border:e.targetPath.includes(s)?"2px solid #FFD700":"1px solid #333"}]),onClick:t=>e.canOperate&&e.clickNumber(s)},[(0,r.Lk)("div",Ts,[0===t?((0,r.uX)(),(0,r.CE)("span",As,"起")):99===t?((0,r.uX)(),(0,r.CE)("span",$s,"终")):-1===t?((0,r.uX)(),(0,r.CE)("span",Os)):((0,r.uX)(),(0,r.CE)("span",zs,(0,u.v_)(t),1))])],12,Is))),128))])])]),(0,r.Lk)("div",Gs,[(0,r.Lk)("div",Fs,[e.pathFound?((0,r.uX)(),(0,r.CE)("span",Ns,"✓ 找到有效路径")):((0,r.uX)(),(0,r.CE)("span",Bs,"✗ 未找到路径")),t[1]||(t[1]=(0,r.Lk)("br",null,null,-1)),e.emptyPos>=0?((0,r.uX)(),(0,r.CE)("span",Rs,"空位位置: "+(0,u.v_)(e.emptyPos+1),1)):(0,r.Q3)("",!0)])])]),"win-content":(0,r.k6)(()=>[(0,r.Lk)("h1",Xs,"步数: "+(0,u.v_)(e.step),1),(0,r.Lk)("h1",Ds,"找到路径: "+(0,u.v_)(e.targetPath.length)+" 步",1)]),_:1},16,["onUndo","onGoon","onStep","onAuto"])}s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);const Us={name:"NumberMaze",data(){return{title:"Number Maze",grid:[],gridSize:6,numbers:[],emptyPos:-1,targetPath:[],pathFound:!1,number:20}},methods:{init(){this.grid=Array(this.gridSize*this.gridSize).fill(-1),this.numbers=[],this.emptyPos=-1,this.pathFound=!1,this.targetPath=[];for(let t=0;t<this.number;t++)this.numbers.push(t+1);M(this.numbers,this.number);const e=[];for(let t=0;t<this.gridSize*this.gridSize;t++)0!==t&&t!==this.gridSize*this.gridSize-1&&e.push(t);M(e,e.length);for(let t=0;t<Math.min(this.number,e.length);t++)this.grid[e[t]]=this.numbers[t];e.length>this.number&&(this.emptyPos=e[this.number],this.grid[this.emptyPos]=-1),this.grid[0]=0,this.grid[this.gridSize*this.gridSize-1]=99,this.autoCalc()},getNeighbors(e){const t=[],s=Math.floor(e/this.gridSize),i=e%this.gridSize;return s>0&&t.push(e-this.gridSize),s<this.gridSize-1&&t.push(e+this.gridSize),i>0&&t.push(e-1),i<this.gridSize-1&&t.push(e+1),t},async moveNumber(e,t){if(console.log("moveNumber called with fromPos:",e,"toPos:",t),-1!==this.grid[t])return console.log("moveNumber returning false - target not empty"),!1;const s=this.getNeighbors(e);if(console.log("neighbors:",s),console.log("toPos in neighbors:",s.includes(t)),!s.includes(t))return console.log("moveNumber returning false - not adjacent"),!1;const i=this.grid[e];return console.log("numberValue:",i),this.grid[t]=i,this.grid[e]=-1,this.emptyPos=e,console.log("moveNumber calling recordOperation"),this.recordOperation("move",{from:e,to:t,number:i}),console.log("moveNumber returning true"),!0},clickNumber(e){if(console.log("clickNumber called with pos:",e),console.log("grid[pos]:",this.grid[e]),this.grid[e]<=0||99===this.grid[e])return void console.log("clickNumber returning early - invalid position");console.log("clickNumber proceeding with move");const t=this.getNeighbors(e);let s=!1;for(const i of t)if(-1===this.grid[i]&&this.moveNumber(e,i)){console.log("moveNumber succeeded to neighbor:",i),s=!0;break}s?this.autoCalc():console.log("moveNumber failed - no valid adjacent empty position")},findValidPath(){const e=0,t=this.gridSize*this.gridSize-1,s=[{pos:e,path:[e],value:0}],i=new Set([e]);while(s.length>0){const e=s.shift();if(e.pos===t)return e.path;const r=this.getNeighbors(e.pos);for(const t of r){if(i.has(t))continue;const r=this.grid[t];-1!==r&&(r>e.value&&99!==r?(i.add(t),s.push({pos:t,path:[...e.path,t],value:r})):99===r&&e.value>0&&(i.add(t),s.push({pos:t,path:[...e.path,t],value:e.value})))}}return null},autoCalc(){const e=this.findValidPath();this.pathFound=null!==e,this.targetPath=e||[],this.pathFound&&this.gameManager.setWin()},getNextAutoMove(){const e=[];for(let t=0;t<this.grid.length;t++)this.grid[t]>0&&this.grid[t]<99&&e.push({pos:t,value:this.grid[t]});e.sort((e,t)=>e.value-t.value);for(const t of e){const e=this.getNeighbors(t.pos);for(const s of e)if(-1===this.grid[s]){const e=[...this.grid];if(e[s]=t.value,e[t.pos]=-1,this.hasPotentialPath(e,s))return{from:t.pos,to:s}}}return null},hasPotentialPath(e,t){const s=new Set,i=[t],r=this.gridSize*this.gridSize-1;while(i.length>0){const t=i.shift();if(t===r)return!0;const o=this.getNeighbors(t);for(const r of o){if(s.has(r))continue;const t=e[r];-1!==t&&99!==t||(s.add(r),i.push(r))}}return!1},async stepFn(){await this.gameManager.step(async()=>{const e=this.getNextAutoMove();e?(await this.moveNumber(e.from,e.to),await this.wait()):this.gameManager.stopAuto()})},recordOperation(e,t){console.log("recordOperation called:",e,t),console.log("gameManager exists:",!!this.gameManager),console.log("gameManager.recordOperation exists:",!!this.gameManager?.recordOperation),this.gameManager&&this.gameManager.recordOperation?(this.gameManager.recordOperation({type:e,...t,timestamp:Date.now()}),console.log("Operation recorded successfully")):console.error("Cannot record operation - gameManager not available")},handleUndo(e){switch(console.log("=== HANDLEUNDO CALLED ==="),console.log("handleUndo called with operation:",e),console.log("Before undo - grid[5]:",this.grid[5],"grid[11]:",this.grid[11]),e.type){case"move":this.grid[e.from]=e.number,this.grid[e.to]=-1,this.emptyPos=e.to,console.log("Undo completed - moved",e.number,"from",e.to,"to",e.from),console.log("this.grid after undo:",this.grid[e.from],this.grid[e.to]);break}},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              数字迷宫 (Number Maze)           ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step}\n`);for(let e=0;e<this.gridSize;e++){let t="  ";for(let s=0;s<this.gridSize;s++){const i=e*this.gridSize+s,r=this.grid[i];let o;o=0===r?"[起]":99===r?"[终]":-1===r?"[  ]":`[${r.toString().padStart(2,"0")}]`,this.targetPath.includes(i)&&(o=o.replace("[","*[").replace("]","]*")),t+=o+" "}console.log(t)}if(console.log(`\n空位位置: ${this.emptyPos+1}`),console.log("路径状态: "+(this.pathFound?"✓ 找到有效路径":"✗ 未找到路径")),this.pathFound&&this.targetPath.length>0){const e=this.targetPath.map(e=>{const t=this.grid[e];return 0===t?"起":99===t?"终":t});console.log(`路径: ${e.join(" → ")}`)}return"渲染完成"}},computed:{currentNumberCount(){let e=0;for(let t=0;t<this.grid.length;t++)this.grid[t]>0&&this.grid[t]<99&&e++;return e},gridState(){return this.grid.join(",")}}};var js=T.puzzleGame(Us,800);const Vs=js;var qs=Vs;const Hs=(0,a.A)(qs,[["render",Ws],["__scopeId","data-v-120f0fb9"]]);var Ks=Hs;const Qs={class:"row"},Js={class:"row"},Ys={class:"cardsul flex-col center",style:{"padding-left":"0",margin:"0",width:"100%","max-width":"31.25rem"}},Zs=["onClick"],ei={key:0,class:"number-tile"},ti={class:"small"},si={class:"small"};function ii(e,t,s,i,o,n){const a=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(a,(0,r.v6)(e.gameLayoutProps,{onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",Qs,[(0,r.Lk)("span",null,"MOVES: "+(0,u.v_)(e.moves),1),t[0]||(t[0]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("span",null,"STEP: "+(0,u.v_)(e.step),1)]),(0,r.Lk)("div",Js,[(0,r.Lk)("div",null,[(0,r.Lk)("ul",Ys,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.grid,(t,s)=>((0,r.uX)(),(0,r.CE)("li",{key:s,class:"flex-row center",style:{padding:"0",margin:"0","list-style":"none"}},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t,(t,i)=>((0,r.uX)(),(0,r.CE)("div",{key:i,class:(0,u.C4)(["grid-cell",{"empty-cell":0===t}]),onClick:t=>e.canOperate&&e.clickCard(s,i)},[0!==t?((0,r.uX)(),(0,r.CE)("span",ei,(0,u.v_)(t),1)):(0,r.Q3)("",!0)],10,Zs))),128))]))),128))])])])]),"win-content":(0,r.k6)(()=>[(0,r.Lk)("h1",ti,"MOVES: "+(0,u.v_)(e.moves),1),(0,r.Lk)("h1",si,"STEP: "+(0,u.v_)(e.step),1)]),_:1},16,["onGoon","onStep","onAuto"])}const ri=[[1,0,0],[2,0,1],[4,3,3],[3,0,3],[4,2,3],[4,1,3],[3,0,2],[4,0,3],[5,1,0],[6,1,1],[7,1,3],[8,2,3],[7,1,2],[8,1,3],[9,3,0],[13,3,1],[9,2,0],[13,3,0],[10,3,1],[14,3,2],[10,2,1],[14,3,1]],oi={name:"NumberPuzzle",data(){return{title:"数字拼图",grid:[],emptyPos:{row:3,col:3},moves:0}},methods:{init(){this.grid=[];let e=1;for(let t=0;t<4;t++){this.grid[t]=[];for(let s=0;s<4;s++)this.grid[t][s]=3===t&&3===s?0:e++}this.emptyPos={row:3,col:3},this.moves=0,this.shuffleGrid()},shuffleGrid(){const e=100;for(let t=0;t<e;t++){const e=this.getValidMoves();if(e.length>0){const t=e[Math.floor(Math.random()*e.length)];this.executeMove(t.row,t.col,!1)}}},getValidMoves(e){const t=[],{row:s,col:i}=this.emptyPos;let r=[{row:s-1,col:i},{row:s+1,col:i},{row:s,col:i-1},{row:s,col:i+1}];void 0!==e&&(r=r.filter((t,s)=>s===e));for(const o of r)o.row>=0&&o.row<4&&o.col>=0&&o.col<4&&t.push(o);return t},executeMove(e,t,s=!0){if(!this.isAdjacent(e,t,this.emptyPos.row,this.emptyPos.col))return!1;const i=this.grid[e][t];this.grid[e][t]=0,this.grid[this.emptyPos.row][this.emptyPos.col]=i;const r={...this.emptyPos};return this.emptyPos={row:e,col:t},s&&(this.moves++,this.gameManager.recordOperation({type:"move",from:{row:e,col:t},to:r,number:i,hash:JSON.stringify(this.grid)})),!0},isAdjacent(e,t,s,i){const r=Math.abs(e-s),o=Math.abs(t-i);return 1===r&&0===o||0===r&&1===o},clickCard(e,t){if(!this.gameManager.hitflag)return;if(void 0===e)return;let s;if(void 0===t){const i=this.getValidMoves(e);if(0===i.length)return;s=i[0].row,t=i[0].col}else s=e;0!==this.grid[s][t]&&this.executeMove(s,t)&&this.done()&&this.gameManager.setWin()},isFinalSixCells(){const e=[{row:2,col:1},{row:2,col:2},{row:2,col:3},{row:3,col:1},{row:3,col:2},{row:3,col:3}],t=[10,11,12,0,14,15],s=[];for(const i of e){const e=this.grid[i.row][i.col];s.push(e)}return s.every(e=>t.includes(e))&&6===s.length},canReachTargetInSteps(e,t,s,i=2){const r=this.findNumberPosition(e);if(!r)return!1;if(r.row===t&&r.col===s)return!0;if(i<=0)return!1;const o=this.grid.map(e=>[...e]),n={...this.emptyPos},a=this.getValidMoves();for(const l of a){const r=o[l.row][l.col];o[l.row][l.col]=0,o[n.row][n.col]=r;const a=this.findNumberPositionInGrid(e,o);if(a&&a.row===t&&a.col===s)return!0;if(i>1){const r={...l},n=this.canReachTargetInStepsWithGrid(e,t,s,i-1,o,r);if(n)return!0}o[l.row][l.col]=r,o[n.row][n.col]=0}return!1},findNumberPositionInGrid(e,t){for(let s=0;s<4;s++)for(let i=0;i<4;i++)if(t[s][i]===e)return{row:s,col:i};return null},canReachTargetInStepsWithGrid(e,t,s,i,r,o){if(i<=0)return!1;const n=this.findNumberPositionInGrid(e,r);if(!n)return!1;if(n.row===t&&n.col===s)return!0;const a=[],l=[{row:o.row-1,col:o.col},{row:o.row+1,col:o.col},{row:o.row,col:o.col-1},{row:o.row,col:o.col+1}];for(const c of l)c.row>=0&&c.row<4&&c.col>=0&&c.col<4&&a.push(c);for(const c of a){const n=r[c.row][c.col],a=r.map(e=>[...e]),l={...o};a[c.row][c.col]=0,a[l.row][l.col]=n;const h=this.findNumberPositionInGrid(e,a);if(h&&h.row===t&&h.col===s)return!0;if(i>1){const r={...c},o=this.canReachTargetInStepsWithGrid(e,t,s,i-1,a,r);if(o)return!0}}return!1},checkTwoStepLookahead(e){const t=this.grid.map(e=>[...e]),s={...this.emptyPos},i=t[e.row][e.col];t[e.row][e.col]=0,t[s.row][s.col]=i;const r={...e},o={row:2,col:1},n={row:3,col:1},a=this.findNumberPositionInGrid(10,t),l=this.findNumberPositionInGrid(14,t),c=a&&a.row===o.row&&a.col===o.col,h=l&&l.row===n.row&&l.col===n.col;if(c&&h)return!0;let d=null,u=!1;if(c&&(d=10,u=!0),h&&null===d&&(d=14,u=!0),!u)return!1;const g=10===d?14:10,f=14===g?n:o,m=this.canReachTargetInStepsWithGrid(g,f.row,f.col,1,t,r);return m},checkSpecialTargetMoves(){const e={row:2,col:1},t={row:3,col:1},s=this.findNumberPosition(10),i=this.findNumberPosition(14);if(!s||!i)return null;const r=this.getValidMoves(),o=r.find(r=>{if(i.row===r.row&&i.col===r.col){const i=this.grid.map(e=>[...e]),o={...this.emptyPos};i[r.row][r.col]=0,i[o.row][o.col]=14;const n=this.findNumberPositionInGrid(14,i);return s.row===t.row&&s.col===t.col?n&&n.row===t.row&&n.col===t.col+1:s.col===e.col+2&&n&&n.row===e.row&&n.col===e.col}return!1});if(o)return o;const n=r.find(r=>{if(s.row===r.row&&s.col===r.col){const s=this.grid.map(e=>[...e]),o={...this.emptyPos};s[r.row][r.col]=0,s[o.row][o.col]=10;const n=this.findNumberPositionInGrid(10,s);return i.row===e.row&&i.col===e.col?n&&n.row===e.row&&n.col===e.col+1:i.col===t.col+2&&n&&n.row===t.row&&n.col===t.col}return!1});return n},randomMoveInFinalSixCells(){const e=[{row:2,col:1},{row:2,col:2},{row:2,col:3},{row:3,col:1},{row:3,col:2},{row:3,col:3}],t=this.getValidMoves(),s=t.filter(t=>e.some(e=>e.row===t.row&&e.col===t.col));let i=[];try{i=s.filter(e=>this.checkTwoStepLookahead(e))}catch(o){console.warn("两步前瞻分析出错，使用随机移动:",o),i=[]}if(1===i.length)return void this.clickCard(i[0].row,i[0].col);if(i.length>1){const e=this.findDirectCorrectMove(s);if(e)return void this.clickCard(e.row,e.col)}if(s.length>0){const e=this.checkSpecialTargetMoves();if(e)return void this.clickCard(e.row,e.col);const t=s[Math.floor(Math.random()*s.length)];return void this.clickCard(t.row,t.col)}const r=t[Math.floor(Math.random()*t.length)];this.clickCard(r.row,r.col)},stepFn(){const e=this.findCurrentTarget(ri);if(!e){if(this.isFinalSixCells())this.randomMoveInFinalSixCells();else{const e=this.getValidMoves();if(e.length>0){const t=e[Math.floor(Math.random()*e.length)];this.clickCard(t.row,t.col)}}return}const[t,s,i]=e,r=this.calculateNextMove(t,s,i);if(r){const e=this.grid.map(e=>[...e]),t={...this.emptyPos},s=e[r.row][r.col];if(e[r.row][r.col]=0,e[t.row][t.col]=s,!this.gameManager.history.find(t=>t.hash===JSON.stringify(e)))return void this.clickCard(r.row,r.col)}this.makeSafeRandomMove()},findCurrentTarget(e){for(let t=0;t<e.length;t++){const[s,i,r]=e[t];if(this.grid[i][r]!==s){const o=this.findNumberPosition(s);if(o){let i=!1;const r=e.slice(t+1).filter(e=>e[0]===s);for(const n of r){const[r,a,l]=n;if(o.row===a&&o.col===l){let o=!0;for(let i=e.findIndex(e=>e[0]===r&&e[1]===a&&e[2]===l);i>t;i--){const[t,r,n]=e[i];if(t===s)continue;const a=t-1,l=s-1,c=this.grid[Math.floor(l/4)][l%4],h=this.grid[Math.floor(a/4)][a%4],d=this.grid[r][n];if(c===s&&h===t||d===t)break;o=!1;break}if(o){i=!0;break}}}if(i)continue}return[s,i,r]}}return null},findNumberPosition(e){for(let t=0;t<4;t++)for(let s=0;s<4;s++)if(this.grid[t][s]===e)return{row:t,col:s};return null},calculateNextMove(e,t,s){const i=this.findNumberPosition(e);if(!i)return null;if(i.row===t&&i.col===s)return null;const r=this.findShortestPath(i,{row:t,col:s},e);if(!r||0===r.length)return null;const o=r[0],n=o;if(this.emptyPos.row===n.row&&this.emptyPos.col===n.col)return i;const a=this.findShortestPath(this.emptyPos,n,e);return a&&0!==a.length?a[0]:null},findShortestPath(e,t,s=null){if(e.row===t.row&&e.col===t.col)return[];const i=[{pos:e,path:[]}],r=new Set;r.add(`${e.row},${e.col}`);while(i.length>0){const{pos:e,path:o}=i.shift(),n=[{row:e.row-1,col:e.col},{row:e.row+1,col:e.col},{row:e.row,col:e.col-1},{row:e.row,col:e.col+1}];for(const a of n){if(a.row<0||a.row>=4||a.col<0||a.col>=4)continue;const e=`${a.row},${a.col}`;if(r.has(e))continue;if(a.row===t.row&&a.col===t.col)return[...o,a];const n=this.grid[a.row][a.col];0!==n&&this.isNumberCompleted(n,a.row,a.col)||(null!==s&&n===s||(r.add(e),i.push({pos:a,path:[...o,a]})))}}return null},makeSafeRandomMove(){const e=this.getContinuousCompletedNumbers(),t=this.getValidMoves(),s=t.filter(t=>{const s=this.grid[t.row][t.col];return s>=e});if(s.length>0){const e=s[Math.floor(Math.random()*s.length)];return void this.clickCard(e.row,e.col)}if(t.length>0){const e=t[Math.floor(Math.random()*t.length)];this.clickCard(e.row,e.col)}},getContinuousCompletedNumbers(){let e=1;while(e<=15){const t=e-1;if(this.grid[Math.floor(t/4)][t%4]!==e)break;e++}return e},isNumberCompleted(e,t,s){const i=ri.findIndex(i=>i[0]===e&&i[1]===t&&i[2]===s);if(-1===i)return!1;const r=ri.filter((e,t)=>{if(t>i)return!1;let s=!1;for(let r=i;r>=t+1;r--){const t=ri[r];if(t[0]===e[0]){s=!0;break}}return!s});for(let o=0;o<r.length;o++){const[e,t,s]=r[o];if(this.grid[t][s]!==e)return!1}return!0},findWinningMove(e){for(const t of e)if(this.willCompleteGame(t))return t;return null},findDirectCorrectMove(e){for(const t of e){const e=this.grid[t.row][t.col],s=Math.floor((e-1)/4),i=(e-1)%4;if(this.emptyPos.row===s&&this.emptyPos.col===i)return t}return null},willCompleteGame(e){const t=this.grid.map(e=>[...e]),s={...this.emptyPos},i=t[e.row][e.col];return t[e.row][e.col]=0,t[s.row][s.col]=i,this.isGridComplete(t)},isGridComplete(e){let t=1;for(let s=0;s<4;s++)for(let i=0;i<4;i++){if(3===s&&3===i)return 0===e[s][i];if(e[s][i]!==t)return!1;t++}return!0},done(){let e=1;for(let t=0;t<4;t++)for(let s=0;s<4;s++){if(3===t&&3===s)return 0===this.grid[t][s];if(this.grid[t][s]!==e)return!1;e++}return!0},handleUndo(e){if(e&&"move"===e.type){const{from:t,to:s,number:i}=e;this.grid[s.row][s.col]=0,this.grid[t.row][t.col]=i,this.emptyPos={...s},this.moves--}},undo(){this.gameManager.undo()},recordMove(e){this.gameManager.recordOperation(e)},renderTextView(){console.log("\n╔════════════════════════════════════════════════╗"),console.log("║              数字拼图游戏                    ║"),console.log("╚════════════════════════════════════════════════╝"),console.log(`\n步数: ${this.step} | 移动次数: ${this.moves}\n`),console.log("┌────┬────┬────┬────┐");for(let e=0;e<4;e++){let t="│";for(let s=0;s<4;s++){const i=this.grid[e][s];t+=0===i?"    │":i.toString().padStart(4," ")+"│"}console.log(t),e<3&&console.log("├────┼────┼────┼────┤")}return console.log("└────┴────┴────┴────┘"),this.done()&&console.log("\n🎉 恭喜！拼图完成！"),"渲染完成"},sendCustomButtons(){this.customButtons.push({action:"clickCard",label:"MOVE",method:"clickCard",args:[],description:"MOVE TO ONE DIRECTION"})}},created(){this.sendCustomButtons()}};var ni=T.puzzleGame(oi,300);const ai=ni;var li=ai;const ci=(0,a.A)(li,[["render",ii],["__scopeId","data-v-4cf5149e"]]);var hi=ci;const di={class:"row center"},ui={class:"game-container"},gi={class:"score-display"},fi={class:"scrore"},mi={class:"grid-container"},pi=["onClick"],yi={key:0,class:"cell-number"},vi={class:"game-status"},wi={key:0,class:"status-text"},bi={key:1,class:"status-text win-text"},ki={key:2,class:"status-text lose-text"},Ci={key:0,class:"selected-sequence"},xi={class:"sequence-display"},Mi={class:"sequence-controls"},Si=["disabled"];function Li(e,t,s,i,o,n){const a=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(a,(0,r.v6)(e.gameLayoutProps,{"win-title":"🎉 恭喜！","win-subtitle":`你成功清空了所有数字！最终得分：${e.score}`,"lose-title":"😔 游戏结束","lose-subtitle":`没有可用的序列了！最终得分：${e.score}`,onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",di,[(0,r.Lk)("div",ui,[(0,r.Lk)("div",gi,[(0,r.Lk)("span",fi,"得分: "+(0,u.v_)(e.score),1)]),(0,r.Lk)("div",mi,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.grid,(t,s)=>((0,r.uX)(),(0,r.CE)("div",{key:s,class:"grid-row"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t,(t,i)=>((0,r.uX)(),(0,r.CE)("div",{key:i,class:(0,u.C4)(["grid-cell",{"cell-empty":null===t,"cell-selectable":null!==t&&e.canOperate,"cell-selected":e.isCellSelected(s,i),"cell-selectable-next":e.isCellSelectableNext(s,i)}]),onClick:r=>null!==t&&e.canOperate&&e.handleCellClick(s,i)},[null!==t?((0,r.uX)(),(0,r.CE)("span",yi,(0,u.v_)(t),1)):(0,r.Q3)("",!0)],10,pi))),128))]))),128))]),(0,r.Lk)("div",vi,[e.gameManager.winflag||e.gameManager.loseflag?e.gameManager.winflag?((0,r.uX)(),(0,r.CE)("p",bi," 🎉 恭喜！你清空了所有数字！ ")):e.gameManager.loseflag?((0,r.uX)(),(0,r.CE)("p",ki," 😔 没有可用的序列了！ ")):(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("p",wi," 选择相邻的递增数字序列（长度≥"+(0,u.v_)(e.minSequenceLength)+"） ",1))]),e.selectedCells.length>0?((0,r.uX)(),(0,r.CE)("div",Ci,[t[2]||(t[2]=(0,r.Lk)("h3",null,"当前选中序列:",-1)),(0,r.Lk)("div",xi,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.selectedCells,(e,t)=>((0,r.uX)(),(0,r.CE)("span",{key:t,class:"sequence-cell"},(0,u.v_)(e.value),1))),128))]),(0,r.Lk)("div",Mi,[(0,r.Lk)("button",{class:"btn-confirm",onClick:t[0]||(t[0]=(...t)=>e.confirmSequence&&e.confirmSequence(...t)),disabled:!e.isValidSequence(e.selectedCells)}," 确认选择 ",8,Si),(0,r.Lk)("button",{class:"btn-clear",onClick:t[1]||(t[1]=(...t)=>e.clearSelection&&e.clearSelection(...t))}," 清除选择 ")])])):(0,r.Q3)("",!0)])])]),_:1},16,["win-subtitle","lose-subtitle","onUndo","onGoon","onStep","onAuto"])}s(1148),s(3579);var _i=T.puzzleGame({name:"NumberSequence",data(){return{grid:[],selectedCells:[],score:0,gridSize:5,minSequenceLength:3}},computed:{isGameComplete(){return this.grid&&this.grid.length>0&&this.grid.every(e=>e.every(e=>null===e))},hasValidMoves(){return this.findAllValidSequences().length>0}},methods:{init(){this.grid=this.generateGrid(),this.selectedCells=[],this.score=0},handleCellClick(e,t){if(null===this.grid[e][t])return;const s={row:e,col:t,value:this.grid[e][t]};if(this.selectedCells.length>0&&this.selectedCells[0].row===e&&this.selectedCells[0].col===t)return void this.clearSelection();if(0===this.selectedCells.length)return void(this.selectedCells=[s]);const i=this.selectedCells[this.selectedCells.length-1],r=Math.abs(e-i.row)+Math.abs(t-i.col);if(1===r&&this.grid[e][t]>i.value){const i=this.selectedCells.some(s=>s.row===e&&s.col===t);i||this.selectedCells.push(s)}else this.selectedCells=[s]},confirmSequence(){this.isValidSequence(this.selectedCells)&&(this.selectSequence(this.selectedCells),this.clearSelection())},clearSelection(){this.selectedCells=[]},isCellSelected(e,t){return this.selectedCells.some(s=>s.row===e&&s.col===t)},isCellSelectableNext(e,t){if(0===this.selectedCells.length)return!1;if(null===this.grid[e][t])return!1;const s=this.selectedCells[this.selectedCells.length-1],i=Math.abs(e-s.row)+Math.abs(t-s.col);return 1===i&&this.grid[e][t]>s.value&&!this.isCellSelected(e,t)},generateGrid(){const e=[];for(let t=0;t<this.gridSize;t++){const t=[];for(let e=0;e<this.gridSize;e++)t.push(Math.floor(9*Math.random())+1);e.push(t)}return e},copyGrid(e){return e.map(e=>[...e])},stepFn(){if(this.isGameComplete)return void this.gameManager.setWin();const e=this.findAllValidSequences();if(0===e.length)return void this.gameManager.setLose();const t=e.reduce((e,t)=>t.length>e.length?t:e);this.selectSequence(t)},findAllValidSequences(){const e=[],t=Array(this.gridSize).fill().map(()=>Array(this.gridSize).fill(!1));for(let s=0;s<this.gridSize;s++)for(let i=0;i<this.gridSize;i++)if(null!==this.grid[s][i]){const r=this.findSequenceFrom(s,i,t);r.length>=this.minSequenceLength&&e.push(r)}return e},findSequenceFrom(e,t,s){const i=[],r=[{row:e,col:t,value:this.grid[e][t]}];return this.dfsFindSequence(e,t,r,s,i),i.length>0?i[0]:[]},dfsFindSequence(e,t,s,i,r){if(s.length>=this.minSequenceLength)return void r.push([...s]);const o=[[-1,0],[1,0],[0,-1],[0,1]],n=s[s.length-1].value;for(const[a,l]of o){const o=e+a,c=t+l;this.isValidCell(o,c)&&!i[o][c]&&null!==this.grid[o][c]&&this.grid[o][c]>n&&(i[o][c]=!0,s.push({row:o,col:c,value:this.grid[o][c]}),this.dfsFindSequence(o,c,s,i,r),s.pop(),i[o][c]=!1)}},isValidCell(e,t){return e>=0&&e<this.gridSize&&t>=0&&t<this.gridSize},selectSequence(e){if(!this.isValidSequence(e))return!1;const t=this.copyGrid(this.grid),s=this.score;for(const i of e)this.grid[i.row][i.col]=null;return this.applyGravity(),this.score+=10*e.length,this.gameManager.recordOperation({type:"selectSequence",data:{sequence:e.map(e=>({row:e.row,col:e.col,value:e.value})),beforeScore:s,afterScore:this.score,beforeGrid:t,afterGrid:this.copyGrid(this.grid)}}),this.checkGameState(),!0},isValidSequence(e){if(e.length<this.minSequenceLength)return!1;for(let t=1;t<e.length;t++)if(e[t].value<=e[t-1].value)return!1;for(let t=1;t<e.length;t++){const s=e[t-1],i=e[t],r=Math.abs(i.row-s.row)+Math.abs(i.col-s.col);if(1!==r)return!1}return!0},applyGravity(){for(let e=0;e<this.gridSize;e++){let t=this.gridSize-1;for(let s=this.gridSize-1;s>=0;s--)null!==this.grid[s][e]&&(s!==t&&(this.grid[t][e]=this.grid[s][e],this.grid[s][e]=null),t--)}},checkGameState(){this.isGameComplete?this.gameManager.setWin():this.hasValidMoves||this.gameManager.setLose()},handleUndo(e){"selectSequence"===e.type&&(this.grid=this.copyGrid(e.data.beforeGrid),this.score=e.data.beforeScore,this.selectedCells=[])},renderTextView(){let e=`数字接龙 - 分数: ${this.score}\n`;e+="═".repeat(4*this.gridSize+1)+"\n";for(let t=0;t<this.gridSize;t++){e+="║";for(let s=0;s<this.gridSize;s++){const i=this.grid[t][s];e+=null===i?"   ║":` ${i} ║`}e+="\n",t<this.gridSize-1&&(e+="╠"+"═══╬".repeat(this.gridSize-1)+"═══╣\n")}return e+="═".repeat(4*this.gridSize+1)+"\n",this.gameManager.winflag?e+="🎉 恭喜！你清空了所有数字！\n":this.gameManager.loseflag?e+="😔 没有可用的序列了！\n":e+=`提示: 选择相邻的递增数字序列（长度≥${this.minSequenceLength}）\n`,console.log(e),e}}});const Pi=_i;var Ei=Pi;const Ii=(0,a.A)(Ei,[["render",Li],["__scopeId","data-v-7084b4dc"]]);var Ti=Ii;const Ai={class:"junqi-container"},$i={class:"game-status"},Oi={class:"current-player"},zi={class:"game-phase"},Gi={key:0,class:"piece-selection"},Fi={class:"available-pieces"},Ni={class:"piece-name"},Bi={class:"piece-count"},Ri={class:"board-container"},Xi=["width","height"],Di=["x","y","fill","stroke","filter","onClick"],Wi={key:0},Ui=["x1","y1","x2","y2"],ji=["x1","y1","x2","y2"],Vi={key:1},qi=["cx","cy"],Hi=["x","y"],Ki={key:2},Qi=["x","y"],Ji=["x","y"],Yi={key:3,class:"piece"},Zi=["cx","cy","fill","stroke"],er=["x","y","fill"],tr={key:0},sr=["cx","cy"],ir=["x","y"],rr={key:1,class:"game-controls"},or=["disabled"],nr={class:"game-info"},ar={class:"step-info"},lr={class:"history-info"};function cr(e,t,s,i,o,n){const a=(0,r.g2)("GameLayout");return(0,r.uX)(),(0,r.Wv)(a,(0,r.v6)({title:e.title},e.gameLayoutProps,{onUndo:e.undo,onGoon:e.goon,onStep:e.stepFn,onAuto:e.pass}),{"game-content":(0,r.k6)(()=>[(0,r.Lk)("div",Ai,[(0,r.Lk)("div",$i,[(0,r.Lk)("div",Oi,[t[1]||(t[1]=(0,r.eW)(" 当前玩家: ",-1)),(0,r.Lk)("span",{class:(0,u.C4)(1===e.currentPlayer?"player1":"player2")},(0,u.v_)(e.currentPlayerName),3)]),(0,r.Lk)("div",zi," 游戏阶段: "+(0,u.v_)("setup"===e.gamePhase?"布阵":"对战"),1)]),"setup"===e.gamePhase?((0,r.uX)(),(0,r.CE)("div",Gi,[t[2]||(t[2]=(0,r.Lk)("h3",null,"选择棋子放置",-1)),(0,r.Lk)("div",Fi,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.availablePieces,t=>((0,r.uX)(),(0,r.CE)("div",{key:t.type,class:"piece-option"},[(0,r.Lk)("span",Ni,(0,u.v_)(e.pieceNames[t.type]),1),(0,r.Lk)("span",Bi,"剩余: "+(0,u.v_)(t.count),1)]))),128))])])):(0,r.Q3)("",!0),(0,r.Lk)("div",Ri,[((0,r.uX)(),(0,r.CE)("svg",{class:"junqi-board",width:60*e.cols+40,height:60*e.rows+40,viewBox:"0 0 400 760"},[t[3]||(t[3]=(0,r.Lk)("defs",null,[(0,r.Lk)("linearGradient",{id:"normalCell",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[(0,r.Lk)("stop",{offset:"0%",style:{"stop-color":"#f0f0f0","stop-opacity":"1"}}),(0,r.Lk)("stop",{offset:"100%",style:{"stop-color":"#e0e0e0","stop-opacity":"1"}})]),(0,r.Lk)("linearGradient",{id:"campCell",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[(0,r.Lk)("stop",{offset:"0%",style:{"stop-color":"#fff3cd","stop-opacity":"1"}}),(0,r.Lk)("stop",{offset:"100%",style:{"stop-color":"#ffeaa7","stop-opacity":"1"}})]),(0,r.Lk)("linearGradient",{id:"baseCell",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[(0,r.Lk)("stop",{offset:"0%",style:{"stop-color":"#f8d7da","stop-opacity":"1"}}),(0,r.Lk)("stop",{offset:"100%",style:{"stop-color":"#dc3545","stop-opacity":"1"}})]),(0,r.Lk)("linearGradient",{id:"railwayCell",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[(0,r.Lk)("stop",{offset:"0%",style:{"stop-color":"#d1ecf1","stop-opacity":"1"}}),(0,r.Lk)("stop",{offset:"100%",style:{"stop-color":"#bee5eb","stop-opacity":"1"}})]),(0,r.Lk)("filter",{id:"selectedGlow"},[(0,r.Lk)("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),(0,r.Lk)("feMerge",null,[(0,r.Lk)("feMergeNode",{in:"coloredBlur"}),(0,r.Lk)("feMergeNode",{in:"SourceGraphic"})])])],-1)),t[4]||(t[4]=(0,r.Lk)("rect",{x:"0",y:"0",width:"400",height:"760",fill:"#8b4513",stroke:"#654321","stroke-width":"2",rx:"10"},null,-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Array.from({length:e.rows},(e,t)=>t),t=>((0,r.uX)(),(0,r.CE)("g",{key:t,class:"board-row"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Array.from({length:e.cols},(e,t)=>t),s=>((0,r.uX)(),(0,r.CE)("g",{key:s,class:"board-cell"},[(0,r.Lk)("rect",{x:60*s+20,y:60*t+20,width:"50",height:"50",fill:n.getCellFill(t,s),stroke:n.getCellStroke(t,s),"stroke-width":"2",rx:"5",filter:n.isSelected(t,s)?"url(#selectedGlow)":"",class:"cell-rect",onClick:i=>e.clickCell(t,s)},null,8,Di),n.isRailwayCell(t,s)?((0,r.uX)(),(0,r.CE)("g",Wi,[(0,r.Lk)("line",{x1:60*s+25,y1:60*t+25,x2:60*s+65,y2:60*t+65,stroke:"#0066cc","stroke-width":"2","stroke-dasharray":"5,5"},null,8,Ui),(0,r.Lk)("line",{x1:60*s+65,y1:60*t+25,x2:60*s+25,y2:60*t+65,stroke:"#0066cc","stroke-width":"2","stroke-dasharray":"5,5"},null,8,ji)])):(0,r.Q3)("",!0),n.isCampCell(t,s)?((0,r.uX)(),(0,r.CE)("g",Vi,[(0,r.Lk)("circle",{cx:60*s+45,cy:60*t+45,r:"15",fill:"none",stroke:"#ffc107","stroke-width":"2"},null,8,qi),(0,r.Lk)("text",{x:60*s+45,y:60*t+50,"text-anchor":"middle","font-size":"12",fill:"#856404","font-weight":"bold"}," 营 ",8,Hi)])):(0,r.Q3)("",!0),n.isBaseCell(t,s)?((0,r.uX)(),(0,r.CE)("g",Ki,[(0,r.Lk)("rect",{x:60*s+30,y:60*t+30,width:"30",height:"30",fill:"none",stroke:"#dc3545","stroke-width":"2",rx:"3"},null,8,Qi),(0,r.Lk)("text",{x:60*s+45,y:60*t+50,"text-anchor":"middle","font-size":"12",fill:"#721c24","font-weight":"bold"}," 旗 ",8,Ji)])):(0,r.Q3)("",!0),0!==e.board[t][s]?((0,r.uX)(),(0,r.CE)("g",Yi,[(0,r.Lk)("circle",{cx:60*s+45,cy:60*t+45,r:"20",fill:n.getPieceFill(t,s),stroke:n.getPieceStroke(t,s),"stroke-width":"2",class:"piece-circle"},null,8,Zi),(0,r.Lk)("text",{x:60*s+45,y:60*t+50,"text-anchor":"middle","font-size":"12",fill:n.getPieceTextColor(t,s),"font-weight":"bold",class:"piece-text"},(0,u.v_)(n.getPieceText(t,s)),9,er),e.board[t][s]&&0!==e.board[t][s]&&!e.board[t][s].revealed?((0,r.uX)(),(0,r.CE)("g",tr,[(0,r.Lk)("circle",{cx:60*s+45,cy:60*t+45,r:"20",fill:"#666","fill-opacity":"0.8",class:"piece-back"},null,8,sr),(0,r.Lk)("text",{x:60*s+45,y:60*t+50,"text-anchor":"middle","font-size":"10",fill:"white","font-weight":"bold"}," ? ",8,ir)])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)]))),128))]))),128)),t[5]||(t[5]=(0,r.Lk)("rect",{x:"10",y:"10",width:"380",height:"740",fill:"none",stroke:"#654321","stroke-width":"3",rx:"10"},null,-1))],8,Xi))]),"setup"===e.gamePhase?((0,r.uX)(),(0,r.CE)("div",rr,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.startGame&&e.startGame(...t)),class:"start-game-btn",disabled:!e.canStartGame()}," 开始对战 ",8,or)])):(0,r.Q3)("",!0),(0,r.Lk)("div",nr,[(0,r.Lk)("div",ar," 步数: "+(0,u.v_)(e.step),1),(0,r.Lk)("div",lr," 历史记录: "+(0,u.v_)(e.gameManager?e.gameManager.history.length:0),1)])])]),_:1},16,["title","onUndo","onGoon","onStep","onAuto"])}const hr={name:"Junqi",data(){return{title:"军棋",board:[],pieces:{"甲方":[{type:11,count:1},{type:8,count:1},{type:7,count:1},{type:6,count:2},{type:5,count:2},{type:4,count:2},{type:3,count:2},{type:2,count:3},{type:1,count:3},{type:0,count:3},{type:9,count:2},{type:10,count:3}],"乙方":[{type:11,count:1},{type:8,count:1},{type:7,count:1},{type:6,count:2},{type:5,count:2},{type:4,count:2},{type:3,count:2},{type:2,count:3},{type:1,count:3},{type:0,count:3},{type:9,count:2},{type:10,count:3}]},currentPlayer:1,selectedPiece:null,gamePhase:"setup",rows:12,cols:5,specialPositions:{camps:[[2,1],[2,3],[3,2],[4,1],[4,3],[7,1],[7,3],[8,2],[9,1],[9,3]],bases:[[11,1],[11,3],[0,1],[0,3]],railways:[[[1,0],[1,1],[1,2],[1,3],[1,4]],[[5,0],[5,1],[5,2],[5,3],[5,4]],[[6,0],[6,1],[6,2],[6,3],[6,4]],[[10,0],[10,1],[10,2],[10,3],[10,4]],[[2,0],[3,0],[4,0]],[[2,2],[3,2],[4,2]],[[2,4],[3,4],[4,4]],[[7,0],[8,0],[9,0]],[[7,2],[8,2],[9,2]],[[7,4],[8,4],[9,4]]]}}},computed:{pieceNames(){return["工兵","排长","连长","营长","团长","旅长","师长","军长","司令","炸弹","地雷","军旗"]},currentPlayerName(){return 1===this.currentPlayer?"甲方":"乙方"},canSetup(){return"setup"===this.gamePhase},canMove(){return"playing"===this.gamePhase&&!this.selectedPiece},availablePieces(){const e=this.currentPlayerName;return this.pieces[e].filter(e=>e.count>0)}},methods:{init(){this.board=Array(this.rows).fill(null).map(()=>Array(this.cols).fill(0)),this.currentPlayer=1,this.selectedPiece=null,this.gamePhase="setup",Object.keys(this.pieces).forEach(e=>{this.pieces[e].forEach(e=>{switch(e.type){case 11:e.count=1;break;case 8:case 7:e.count=1;break;case 6:case 5:case 4:case 3:e.count=2;break;case 2:case 1:case 0:e.count=3;break;case 9:e.count=2;break;case 10:e.count=3;break}})})},canStartGame(){let e=0;for(let t=0;t<this.rows;t++)for(let s=0;s<this.cols;s++){const i=this.board[t][s];0!==i&&1===i.player&&e++}return e>=25},randomPlacePlayerPieces(e){const t=1===e?"甲方":"乙方",s=this.pieces[t],i=[];for(let n=0;n<this.rows;n++)for(let t=0;t<this.cols;t++){const s=1===e?n>=6:n<=5;s&&0===this.board[n][t]&&i.push({row:n,col:t})}this.shuffleArray(i);let r=0;const o=[11,8,7,6,5,4,3,2,1,0,9,10];for(const n of o){const o=s.find(e=>e.type===n);if(o&&!(o.count<=0)){for(let s=0;s<o.count&&r<i.length;s++){const s=i[r++];this.board[s.row][s.col]={player:e,type:n,revealed:!1},console.log(`随机放置了 ${t} 的 ${this.pieceNames[n]} 在 (${s.row}, ${s.col})`)}o.count=Math.max(0,o.count-(r>0?i.slice(0,r).filter(e=>this.board[e.row][e.col].type===n).length:0))}}console.log(`已为 ${t} 随机摆放棋子，使用了 ${r} 个位置`)},shuffleArray(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e},clickCell(e,t){console.log(`点击了格子: ${e}, ${t}`),"setup"===this.gamePhase?this.handleSetupClick(e,t):"playing"===this.gamePhase&&this.handlePlayClick(e,t)},handleSetupClick(e,t){const s=this.getCellPlayer(e,t);if(s!==this.currentPlayer){if(0===s&&this.availablePieces.length>0){const s=this.availablePieces[0].type;this.canPlacePiece(e,t)&&this.placePiece(e,t,s)}this.selectedPiece&&(this.canPlacePiece(e,t)&&this.placePiece(e,t),this.selectedPiece=null)}else this.selectedPiece={row:e,col:t}},handlePlayClick(e,t){const s=this.getCellPlayer(e,t);s!==this.currentPlayer?this.selectedPiece&&(this.canMovePiece(this.selectedPiece.row,this.selectedPiece.col,e,t)&&this.movePiece(this.selectedPiece.row,this.selectedPiece.col,e,t),this.selectedPiece=null):this.selectedPiece={row:e,col:t}},getCellPlayer(e,t){const s=this.board[e][t];return s?s.player:0},canPlacePiece(e,t){const s=1===this.currentPlayer?e>=6:e<=5;return!!s&&0===this.board[e][t]},placePiece(e,t,s=null){null===s&&(s=0);const i=this.pieces[this.currentPlayerName],r=i.find(e=>e.type===s);!r||r.count<=0?console.log(`玩家 ${this.currentPlayerName} 没有可用的 ${this.pieceNames[s]} 棋子`):(this.board[e][t]={player:this.currentPlayer,type:s,revealed:!1},r.count--,this.recordOperation({type:"place",row:e,col:t,player:this.currentPlayer,pieceType:s}),console.log(`在 (${e}, ${t}) 放置了 ${this.currentPlayerName} 的 ${this.pieceNames[s]}`))},canMovePiece(e,t,s,i){const r=this.board[e][t];if(!r||r.player!==this.currentPlayer)return!1;const o=this.board[s][i];return(!o||o.player!==this.currentPlayer)&&this.isValidMove(e,t,s,i,r)},isValidMove(e,t,s,i,r){const o=Math.abs(s-e),n=Math.abs(i-t);return!(0!==r.type||!this.isRailwayMove(e,t,s,i))||(1===o&&0===n||0===o&&1===n)},isRailwayMove(e,t,s,i){for(const r of this.specialPositions.railways){const o=r.some(s=>s[0]===e&&s[1]===t),n=r.some(e=>e[0]===s&&e[1]===i);if(o&&n)return!0}return!1},movePiece(e,t,s,i){const r=this.board[e][t],o=this.board[s][i];o?this.attackPiece(r,o,e,t,s,i):(this.board[s][i]=r,this.board[e][t]=0,this.recordOperation({type:"move",fromRow:e,fromCol:t,toRow:s,toCol:i,piece:r})),this.currentPlayer=1===this.currentPlayer?2:1},attackPiece(e,t,s,i,r,o){let n=this.calculateBattleResult(e.type,t.type);"attacker_wins"===n?(this.board[r][o]=e,this.board[s][i]=0):"defender_wins"===n?this.board[s][i]=0:(this.board[s][i]=0,this.board[r][o]=0),this.recordOperation({type:"attack",fromRow:s,fromCol:i,toRow:r,toCol:o,attacker:e,defender:t,result:n}),this.checkGameEnd()},calculateBattleResult(e,t){return 11===t?"attacker_wins":10===t?0===e?"attacker_wins":"defender_wins":9===e||9===t?"both_die":e>t?"attacker_wins":e<t?"defender_wins":"both_die"},checkGameEnd(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++){const s=this.board[e][t];if(s&&11===s.type)return}this.gameManager.setWin()},startGame(){this.gamePhase="playing",this.selectedPiece=null,this.randomPlacePlayerPieces(2)},goon(){this.init()},async stepFn(){if("setup"==this.gamePhase)return this.randomPlacePlayerPieces(1),void this.startGame();const e=this.getAvailableMoves();if(e.length>0){const t=e[Math.floor(Math.random()*e.length)];this.selectedPiece={row:t.fromRow,col:t.fromCol},this.clickCell(t.toRow,t.toCol)}else console.log("没有可用的移动，游戏可能陷入死锁")},getAvailableMoves(){const e=[];for(let t=0;t<this.rows;t++)for(let s=0;s<this.cols;s++){const i=this.board[t][s];if(i&&i.player===this.currentPlayer){const i=[[-1,0],[1,0],[0,-1],[0,1]];for(const[r,o]of i){const i=t+r,n=s+o;i>=0&&i<this.rows&&n>=0&&n<this.cols&&this.canMovePiece(t,s,i,n)&&e.push({fromRow:t,fromCol:s,toRow:i,toCol:n})}}}return e},renderTextView(){let e=`军棋棋盘 (${this.rows}x${this.cols})\n`;e+=`当前玩家: ${this.currentPlayerName} (${this.currentPlayer})\n`,e+=`游戏阶段: ${"setup"===this.gamePhase?"布阵":"对战"}\n`,e+=`步数: ${this.step}\n\n`,e+="棋盘状态:\n";for(let t=0;t<this.rows;t++){let s="";for(let e=0;e<this.cols;e++){const i=this.board[t][e];if(0===i)s+=". ";else{const e=1===i.player?"A":"B",t=this.pieceNames[i.type].charAt(0);s+=`${e}${t} `}}e+=`${t.toString().padStart(2)}: ${s}\n`}return e+="\n特殊位置:\n",e+="行营: "+this.specialPositions.camps.map(e=>`(${e[0]},${e[1]})`).join(", ")+"\n",e+="大本营: "+this.specialPositions.bases.map(e=>`(${e[0]},${e[1]})`).join(", ")+"\n",console.log(e),e},recordOperation(e){this.gameManager.recordOperation(e)},handleUndo(e){switch(e.type){case"place":this.board[e.row][e.col]=0;break;case"move":this.board[e.fromRow][e.fromCol]=e.piece,this.board[e.toRow][e.toCol]=0;break;case"attack":"attacker_wins"===e.result?(this.board[e.fromRow][e.fromCol]=e.attacker,this.board[e.toRow][e.toCol]=e.defender):(e.result,this.board[e.fromRow][e.fromCol]=e.attacker,this.board[e.toRow][e.toCol]=e.defender);break}}}};var dr=T.strategyGame(hr),ur={name:"Junqi",mixins:[dr],methods:{getCellFill(e,t){return this.isCampCell(e,t)?"url(#campCell)":this.isBaseCell(e,t)?"url(#baseCell)":this.isRailwayCell(e,t)?"url(#railwayCell)":"url(#normalCell)"},getCellStroke(e,t){return this.isCampCell(e,t)?"#ffc107":this.isBaseCell(e,t)?"#dc3545":this.isRailwayCell(e,t)?"#17a2b8":"#ccc"},isCampCell(e,t){return this.specialPositions.camps.some(s=>s[0]===e&&s[1]===t)},isBaseCell(e,t){return this.specialPositions.bases.some(s=>s[0]===e&&s[1]===t)},isRailwayCell(e,t){return this.specialPositions.railways.some(s=>s.some(s=>s[0]===e&&s[1]===t))},isSelected(e,t){return this.selectedPiece&&this.selectedPiece.row===e&&this.selectedPiece.col===t},getPieceFill(e,t){const s=this.board[e][t];return s&&0!==s?1===s.player?"#007bff":"#28a745":"transparent"},getPieceStroke(e,t){const s=this.board[e][t];return s&&0!==s?1===s.player?"#0056b3":"#1e7e34":"transparent"},getPieceTextColor(){return"white"},getPieceText(e,t){const s=this.board[e][t];return s&&0!==s?this.pieceNames[s.type].charAt(0):""}}};const gr=(0,a.A)(ur,[["render",cr],["__scopeId","data-v-34c0c8a0"]]);var fr=gr;const mr=[{path:"/",redirect:"/month"},{path:"/month",component:je},{path:"/fish",component:ce},{path:"/point24",component:Ae},{path:"/blackjack",component:W},{path:"/Tortoise",component:et},{path:"/Sort",component:ut},{path:"/Pairs",component:Mt},{path:"/Spider",component:jt},{path:"/GridBattle",component:os},{path:"/TowerHanoi",component:Ls},{path:"/numbermaze",component:Ks},{path:"/numberpuzzle",component:hi},{path:"/numbersequence",component:Ti},{path:"/junqi",component:fr}],pr=(0,d.aE)({history:(0,d.Bt)(),routes:mr});var yr=pr,vr=s(782),wr=(0,vr.y$)({state:{},mutations:{},actions:{},modules:{}});Math.random=E;const br=(0,i.Ef)(h);br.use(yr),br.use(wr),br.mount("#app")},5249:function(e,t,s){s.d(t,{P_:function(){return r},bt:function(){return i},mS:function(){return n},zT:function(){return o}});const i=["♥","♠","♦","♣"],r=["A",2,3,4,5,6,7,8,9,10,"J","Q","K","JOKER"];function o(e,t=i,s=r){if("number"===typeof e){const i=e<52?t[e%4]:"",r=s[e>>2];return`${i}${r}`}return""}function n(e){return`./static/${e}.webp`}}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,i,r,o){if(!i){var n=1/0;for(h=0;h<e.length;h++){i=e[h][0],r=e[h][1],o=e[h][2];for(var a=!0,l=0;l<i.length;l++)(!1&o||n>=o)&&Object.keys(s.O).every(function(e){return s.O[e](i[l])})?i.splice(l--,1):(a=!1,o<n&&(n=o));if(a){e.splice(h--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var h=e.length;h>0&&e[h-1][2]>o;h--)e[h]=e[h-1];e[h]=[i,r,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce(function(t,i){return s.f[i](e,t),t},[]))}}(),function(){s.u=function(e){return"js/"+e+"."+{82:"0edd97ec",109:"392cd34a",115:"ebef74e0",279:"807a068c",304:"d853afda",526:"f4a73ab4"}[e]+".js"}}(),function(){s.miniCssF=function(e){return"css/"+e+"."+{82:"0ec60025",109:"f27d4702",115:"168b6652",279:"94d13aed",304:"88948ce9",526:"b5aab8a0"}[e]+".css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="tsubaki-game-library:";s.l=function(i,r,o,n){if(e[i])e[i].push(r);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var d=c[h];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(l=!0,a=document.createElement("script"),a.charset="utf-8",s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",t+o),a.src=i),e[i]=[r];var u=function(t,s){a.onerror=a.onload=null,clearTimeout(g);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach(function(e){return e(s)}),t)return t(s)},g=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),l&&document.head.appendChild(a)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p=""}(),function(){if("undefined"!==typeof document){var e=function(e,t,i,r,o){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",s.nc&&(n.nonce=s.nc);var a=function(s){if(n.onerror=n.onload=null,"load"===s.type)r();else{var i=s&&s.type,a=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+i+": "+a+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=i,l.request=a,n.parentNode&&n.parentNode.removeChild(n),o(l)}};return n.onerror=n.onload=a,n.href=t,i?i.parentNode.insertBefore(n,i.nextSibling):document.head.appendChild(n),n},t=function(e,t){for(var s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var r=s[i],o=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(o===e||o===t))return r}var n=document.getElementsByTagName("style");for(i=0;i<n.length;i++){r=n[i],o=r.getAttribute("data-href");if(o===e||o===t)return r}},i=function(i){return new Promise(function(r,o){var n=s.miniCssF(i),a=s.p+n;if(t(n,a))return r();e(i,a,null,r,o)})},r={524:0};s.f.miniCss=function(e,t){var s={82:1,109:1,115:1,279:1,304:1,526:1};r[e]?t.push(r[e]):0!==r[e]&&s[e]&&t.push(r[e]=i(e).then(function(){r[e]=0},function(t){throw delete r[e],t}))}}}(),function(){var e={524:0};s.f.j=function(t,i){var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise(function(s,i){r=e[t]=[s,i]});i.push(r[2]=o);var n=s.p+s.u(t),a=new Error,l=function(i){if(s.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),n=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+n+")",a.name="ChunkLoadError",a.type=o,a.request=n,r[1](a)}};s.l(n,l,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,i){var r,o,n=i[0],a=i[1],l=i[2],c=0;if(n.some(function(t){return 0!==e[t]})){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var h=l(s)}for(t&&t(i);c<n.length;c++)o=n[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(h)},i=self["webpackChunktsubaki_game_library"]=self["webpackChunktsubaki_game_library"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[504],function(){return s(2771)});i=s.O(i)})();
//# sourceMappingURL=app.dc7535d2.js.map