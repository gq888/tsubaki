"use strict";(self["webpackChunktsubaki_game_library"]=self["webpackChunktsubaki_game_library"]||[]).push([[345,565,788],{5788:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var l=s(6768),a=s(5130),o=s(4232);const i={key:0},n={key:1,class:"small"},r={class:"modal-buttons"},d=["value","onClick","disabled"];function u(e,t,s,u,c,h){return(0,l.uX)(),(0,l.Wv)(a.eB,null,{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,o.C4)(["lose",s.customClass]),style:(0,o.Tr)(s.modalStyle)},[s.title?((0,l.uX)(),(0,l.CE)("h1",i,(0,o.v_)(s.title),1)):(0,l.Q3)("",!0),s.subtitle?((0,l.uX)(),(0,l.CE)("h1",n,(0,o.v_)(s.subtitle),1)):(0,l.Q3)("",!0),(0,l.RG)(e.$slots,"content",{},void 0,!0),(0,l.RG)(e.$slots,"cards",{},void 0,!0),(0,l.Lk)("div",r,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.buttons,(e,t)=>((0,l.uX)(),(0,l.CE)("input",{key:t,type:"button",value:e.text,onClick:e.callback,disabled:e.disabled,class:"modal-button"},null,8,d))),128))])],6))]),_:3})}var c={name:"GameResultModal",props:{title:{type:String,default:""},subtitle:{type:String,default:""},buttons:{type:Array,default:()=>[]},modalStyle:{type:Object,default:()=>({})},customClass:{type:String,default:""}}},h=s(1241);const p=(0,h.A)(c,[["render",u],["__scopeId","data-v-644f8500"]]);var m=p},6565:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var l=s(6768);const a={class:"btns"},o=["value","disabled","onClick"];function i(e,t,s,i,n,r){return(0,l.uX)(),(0,l.CE)("div",a,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.displayButtons,(e,t)=>((0,l.uX)(),(0,l.CE)("input",{key:e.id||t,type:"button",value:e.label,disabled:e.disabled,onClick:t=>r.handleButtonClick(e.action)},null,8,o))),128))])}s(4114);var n={name:"GameControls",props:{buttons:{type:Array,default:()=>[]},showUndo:{type:Boolean,default:!0},showRestart:{type:Boolean,default:!0},showStep:{type:Boolean,default:!0},showAuto:{type:Boolean,default:!0},undoDisabled:{type:Boolean,default:!1},restartDisabled:{type:Boolean,default:!1},stepDisabled:{type:Boolean,default:!1},autoDisabled:{type:Boolean,default:!1},isAutoRunning:{type:Boolean,default:!1}},computed:{displayButtons(){if(this.buttons&&this.buttons.length>0)return this.buttons;const e=[];return this.showUndo&&e.push({label:"UNDO",action:"undo",disabled:this.undoDisabled}),this.showRestart&&e.push({label:"RESTART",action:"goon",disabled:this.restartDisabled}),this.showStep&&e.push({label:"STEP",action:"step",disabled:this.stepDisabled}),this.showAuto&&e.push({label:this.isAutoRunning?"STOP":"AUTO",action:"auto",disabled:this.autoDisabled}),e}},methods:{handleButtonClick(e){this.$emit(e)},undo(){this.$emit("undo")},goon(){this.$emit("goon")},stepFn(){this.$emit("step")},pass(){this.$emit("auto")}}},r=s(1241);const d=(0,r.A)(n,[["render",i],["__scopeId","data-v-0f1bfcf8"]]);var u=d},8345:function(e,t,s){s.r(t),s.d(t,{default:function(){return G}});var l=s(6768),a=s(4232),o=s(5130);const i={class:"game-layout-container"},n=["title"],r={ref:"gameNav",class:"game-nav"},d={key:0,ref:"gameFooter",class:"game-footer"};function u(e,t,s,u,c,h){const p=(0,l.g2)("GameSettings"),m=(0,l.g2)("router-link"),g=(0,l.g2)("GameControls"),b=(0,l.g2)("GameResultModal");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("button",{class:"toggle-header-btn",onClick:t[0]||(t[0]=(...e)=>h.toggleHeader&&h.toggleHeader(...e)),title:c.isHeaderExpanded?"收起导航和标题":"展开导航和标题"},(0,a.v_)(c.isHeaderExpanded?"▲":"▼"),9,n),(0,l.Lk)("button",{class:"settings-btn",onClick:t[1]||(t[1]=(...e)=>h.openSettings&&h.openSettings(...e)),title:"游戏设置"}," ⚙️ "),(0,l.bF)(p,{visible:c.showSettings,currentGame:h.currentGameName,onClose:h.closeSettings,onSettingsSaved:h.handleSettingsSaved},null,8,["visible","currentGame","onClose","onSettingsSaved"]),(0,l.bF)(o.eB,{name:"slide-down"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.Lk)("div",r,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(c.navItems,t=>((0,l.uX)(),(0,l.Wv)(m,{key:t.path,to:t.path},{default:(0,l.k6)(()=>[(0,l.eW)((0,a.v_)(t.icon+(e.$route.path===t.path?s.title:"")),1)]),_:2},1032,["to"]))),128))],512),[[o.aG,c.isHeaderExpanded]])]),_:1}),(0,l.bF)(o.eB,{name:"slide-down"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.Lk)("div",{ref:"gameHeader",class:"game-header",style:(0,a.Tr)({top:c.navHeight/16+"rem"})},[(0,l.RG)(e.$slots,"top-controls",{},()=>[s.showTopControls?((0,l.uX)(),(0,l.Wv)(g,(0,l.v6)({key:0},s.gameControlsConfig,{onUndo:t[2]||(t[2]=t=>e.$emit("undo")),onGoon:t[3]||(t[3]=t=>e.$emit("goon")),onStep:t[4]||(t[4]=t=>e.$emit("step")),onAuto:t[5]||(t[5]=t=>e.$emit("auto"))}),null,16)):(0,l.Q3)("",!0)],!0)],4),[[o.aG,c.isHeaderExpanded]])]),_:3}),(0,l.Lk)("div",{class:"game-content-wrapper",style:(0,a.Tr)(h.contentWrapperStyle)},[(0,l.RG)(e.$slots,"game-content",{},void 0,!0)],4),s.showBottomControls||e.$slots["bottom-controls"]?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.RG)(e.$slots,"bottom-controls",{},()=>[s.showBottomControls?((0,l.uX)(),(0,l.Wv)(g,(0,l.v6)({key:0},s.gameControlsConfig,{onUndo:t[6]||(t[6]=t=>e.$emit("undo")),onGoon:t[7]||(t[7]=t=>e.$emit("goon")),onStep:t[8]||(t[8]=t=>e.$emit("step")),onAuto:t[9]||(t[9]=t=>e.$emit("auto"))}),null,16)):(0,l.Q3)("",!0)],!0)],512)):(0,l.Q3)("",!0),(0,l.RG)(e.$slots,"result-modals",{},()=>[s.winflag?((0,l.uX)(),(0,l.Wv)(b,{key:0,title:void 0!==s.winTitle?s.winTitle:"U WIN!",subtitle:s.winSubtitle,buttons:s.winButtons||h.defaultWinButtons,modalStyle:s.winModalStyle,customClass:s.winCustomClass},(0,l.eX)({_:2},[e.$slots["win-content"]?{name:"content",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"win-content",{},void 0,!0)]),key:"0"}:void 0,e.$slots["win-cards"]?{name:"cards",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"win-cards",{},void 0,!0)]),key:"1"}:void 0]),1032,["title","subtitle","buttons","modalStyle","customClass"])):(0,l.Q3)("",!0),s.loseflag?((0,l.uX)(),(0,l.Wv)(b,{key:1,title:void 0!==s.loseTitle?s.loseTitle:"U LOSE",subtitle:s.loseSubtitle,buttons:s.loseButtons||h.defaultLoseButtons,modalStyle:s.loseModalStyle||{backgroundColor:"rgba(0,0,0,0.5)"},customClass:s.loseCustomClass},(0,l.eX)({_:2},[e.$slots["lose-content"]?{name:"content",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"lose-content",{},void 0,!0)]),key:"0"}:void 0,e.$slots["lose-cards"]?{name:"cards",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"lose-cards",{},void 0,!0)]),key:"1"}:void 0]),1032,["title","subtitle","buttons","modalStyle","customClass"])):(0,l.Q3)("",!0),s.drawflag?((0,l.uX)(),(0,l.Wv)(b,{key:2,title:void 0!==s.drawTitle?s.drawTitle:"DRAW GAME",subtitle:s.drawSubtitle,buttons:s.drawButtons||h.defaultDrawButtons,modalStyle:s.drawModalStyle||{backgroundColor:"rgba(0,0,0,0.5)"},customClass:s.drawCustomClass},(0,l.eX)({_:2},[e.$slots["draw-content"]?{name:"content",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"draw-content",{},void 0,!0)]),key:"0"}:void 0,e.$slots["draw-cards"]?{name:"cards",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"draw-cards",{},void 0,!0)]),key:"1"}:void 0]),1032,["title","subtitle","buttons","modalStyle","customClass"])):(0,l.Q3)("",!0)],!0)])}var c=s(6565),h=s(5788);const p={class:"settings-modal"},m={class:"settings-header"},g={class:"settings-body"},b={class:"setting-item"},y=["value"],v={class:"setting-item"},f={class:"checkbox-container"},S={class:"settings-footer"};function k(e,t,s,a,i,n){return(0,l.uX)(),(0,l.Wv)(o.eB,{name:"modal-fade"},{default:(0,l.k6)(()=>[s.visible?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"settings-overlay",onClick:t[5]||(t[5]=(0,o.D$)((...e)=>n.close&&n.close(...e),["self"]))},[(0,l.Lk)("div",p,[(0,l.Lk)("div",m,[t[6]||(t[6]=(0,l.Lk)("h2",null,"SETTING",-1)),(0,l.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>n.close&&n.close(...e))},"✕")]),(0,l.Lk)("div",g,[(0,l.Lk)("div",b,[t[7]||(t[7]=(0,l.Lk)("label",{class:"setting-label"},"SPEED",-1)),(0,l.Lk)("input",{type:"range",class:"delay-slider",value:i.localDelay,onInput:t[1]||(t[1]=(...e)=>n.handleDelayChange&&n.handleDelayChange(...e)),min:"0",max:"100",step:"1"},null,40,y),t[8]||(t[8]=(0,l.Lk)("div",{class:"slider-labels"},[(0,l.Lk)("span",null,"FAST"),(0,l.Lk)("span",null,"SLOW")],-1))]),(0,l.Lk)("div",v,[(0,l.Lk)("label",f,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>i.applyToAll=e)},null,512),[[o.lH,i.applyToAll]]),t[9]||(t[9]=(0,l.Lk)("span",{class:"checkbox-label"},"IS APPLY TO ALL GAMES",-1))])])]),(0,l.Lk)("div",S,[(0,l.Lk)("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...e)=>n.reset&&n.reset(...e))},"RESET"),(0,l.Lk)("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>n.save&&n.save(...e))},"SAVE")])])])):(0,l.Q3)("",!0)]),_:1})}var T=s(432),C={name:"GameSettings",props:{visible:{type:Boolean,default:!1},currentGame:{type:String,default:""}},data(){return{localDelay:50,applyToAll:!1,defaultDelay:50}},watch:{visible(e){e&&this.loadSettings()}},mounted(){this.loadSettings()},methods:{sliderToDelay(e){return Math.round(100+19*e)},delayToSlider(e){return Math.round((e-100)/19)},loadSettings(){const e=localStorage.getItem("game-global-delay"),t=localStorage.getItem(`game-delay-${this.currentGame}`);t?(this.localDelay=this.delayToSlider(parseInt(t)),this.applyToAll=!1):e?(this.localDelay=this.delayToSlider(parseInt(e)),this.applyToAll=!0):(this.localDelay=this.defaultDelay,this.applyToAll=!1)},handleDelayChange(e){this.localDelay=parseInt(e.target.value)},save(){const e=this.sliderToDelay(this.localDelay);T.A.saveDelay(this.currentGame,e,this.applyToAll),this.$emit("settings-saved",{delay:e,applyToAll:this.applyToAll,currentGame:this.currentGame}),this.close()},reset(){this.localDelay=this.defaultDelay,this.applyToAll=!1},close(){this.$emit("close")}}},w=s(1241);const $=(0,w.A)(C,[["render",k],["__scopeId","data-v-c5a013c2"]]);var H=$,A={name:"GameLayout",components:{GameControls:c["default"],GameResultModal:h["default"],GameSettings:H},data(){return{isHeaderExpanded:!0,navHeight:0,headerHeight:0,footerHeight:0,resizeObserver:null,lastScrollTop:0,lastToggleTime:0,toggleCooldown:500,autoHideTimer:null,showSettings:!1,navItems:[{path:"/month",icon:"🌛"},{path:"/fish",icon:"🐟"},{path:"/blackjack",icon:"♠️"},{path:"/point24",icon:"24"},{path:"/Tortoise",icon:"🐢"},{path:"/Sort",icon:"🐗"},{path:"/Pairs",icon:"🐰"},{path:"/Spider",icon:"🕷️"},{path:"/Chess",icon:"♟️"}]}},props:{title:{type:String,default:""},containerStyle:{type:Object,default:()=>({width:"100%"})},showTopControls:{type:Boolean,default:!1},showBottomControls:{type:Boolean,default:!0},gameControlsConfig:{type:Object,default:()=>({})},winflag:{type:Boolean,default:!1},loseflag:{type:Boolean,default:!1},drawflag:{type:Boolean,default:!1},winTitle:String,winSubtitle:String,winButtons:Array,winModalStyle:Object,winCustomClass:String,loseTitle:String,loseSubtitle:String,loseButtons:Array,loseModalStyle:Object,loseCustomClass:String,drawTitle:String,drawSubtitle:String,drawButtons:Array,drawModalStyle:Object,drawCustomClass:String,step:{type:Number,default:0},enableSmartScroll:{type:Boolean,default:!0},smartScrollThreshold:{type:Number,default:50},autoHideDelay:{type:Number,default:4e3}},computed:{contentWrapperStyle(){const e=this.navHeight+this.headerHeight,t=this.footerHeight;return{...this.containerStyle,paddingTop:e/16+"rem",paddingBottom:t/16+"rem"}},defaultWinButtons(){return[{text:"GO ON",callback:()=>this.$emit("goon"),disabled:!1}]},defaultLoseButtons(){return[{text:"RESTART",callback:()=>this.$emit("goon"),disabled:!1},{text:"UNDO",callback:()=>this.$emit("undo"),disabled:this.step<=0}]},defaultDrawButtons(){return[{text:"RESTART",callback:()=>this.$emit("goon"),disabled:!1},{text:"UNDO",callback:()=>this.$emit("undo"),disabled:this.step<=0}]},currentGameName(){return this.$route?.path?.substring(1)||""}},mounted(){this.updateHeights(),this.setupResizeObserver(),this.setupScrollListener(),this.startAutoHideTimer()},beforeUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.removeScrollListener(),this.clearAutoHideTimer()},methods:{toggleHeader(){this.isHeaderExpanded?this.collapseHeader():this.expandHeader()},updateHeights(){this.$nextTick(()=>{this.$refs.gameNav&&(this.navHeight=this.$refs.gameNav.offsetHeight),this.$refs.gameHeader&&(this.headerHeight=this.$refs.gameHeader.offsetHeight),this.$refs.gameFooter&&(this.footerHeight=this.$refs.gameFooter.offsetHeight)})},setupResizeObserver(){"undefined"!==typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{this.updateHeights()}),this.$nextTick(()=>{this.$refs.gameNav&&this.resizeObserver.observe(this.$refs.gameNav),this.$refs.gameHeader&&this.resizeObserver.observe(this.$refs.gameHeader),this.$refs.gameFooter&&this.resizeObserver.observe(this.$refs.gameFooter)}))},setupScrollListener(){this.$nextTick(()=>{const e=this.$el?.querySelector(".game-content-wrapper");e&&(this._scrollHandler=this.handleScroll.bind(this),e.addEventListener("scroll",this._scrollHandler,{passive:!0}))})},removeScrollListener(){const e=this.$el?.querySelector(".game-content-wrapper");e&&this._scrollHandler&&e.removeEventListener("scroll",this._scrollHandler)},handleScroll(e){if(!this.enableSmartScroll)return;const t=e.target,s=t.scrollTop,l=t.scrollHeight,a=t.clientHeight,o=s-this.lastScrollTop,i=o>0,n=o<0,r=s<=this.smartScrollThreshold,d=s+a>=l-this.smartScrollThreshold,u=Date.now(),c=u-this.lastToggleTime>=this.toggleCooldown;c&&(r&&n||d&&i)&&!this.isHeaderExpanded&&(this.lastToggleTime=u,this.expandHeader()),this.lastScrollTop=s},expandHeader(){this.isHeaderExpanded=!0,this.$nextTick(()=>{this.updateHeights()}),this.startAutoHideTimer()},collapseHeader(){this.isHeaderExpanded=!1,this.$nextTick(()=>{this.updateHeights()}),this.clearAutoHideTimer()},startAutoHideTimer(){this.clearAutoHideTimer(),this.autoHideTimer=setTimeout(()=>{this.collapseHeader()},this.autoHideDelay)},clearAutoHideTimer(){this.autoHideTimer&&(clearTimeout(this.autoHideTimer),this.autoHideTimer=null)},openSettings(){this.showSettings=!0},closeSettings(){this.showSettings=!1},handleSettingsSaved(e){this.$emit("settings-changed",e)}},emits:["undo","goon","step","auto","settings-changed"]};const B=(0,w.A)(A,[["render",u],["__scopeId","data-v-6272f448"]]);var G=B}}]);
//# sourceMappingURL=345.c7206151.js.map