"use strict";(self["webpackChunktsubaki_game_library"]=self["webpackChunktsubaki_game_library"]||[]).push([[163,788,974],{5163:function(e,t,s){s.r(t),s.d(t,{default:function(){return B}});var o=s(6768),l=s(4232),a=s(5130);const i={class:"game-layout-container"},n=["title"],r={ref:"gameNav",class:"game-nav"},d={key:0,ref:"gameFooter",class:"game-footer"};function u(e,t,s,u,h,c){const m=(0,o.g2)("GameSettings"),p=(0,o.g2)("router-link"),g=(0,o.g2)("GameControls"),b=(0,o.g2)("GameResultModal");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("button",{class:"toggle-header-btn",onClick:t[0]||(t[0]=(...e)=>c.toggleHeader&&c.toggleHeader(...e)),onMouseleave:t[1]||(t[1]=(...e)=>c.handleMouseLeave&&c.handleMouseLeave(...e)),onTouchstart:t[2]||(t[2]=(...e)=>c.startLongPress&&c.startLongPress(...e)),onTouchend:t[3]||(t[3]=(...e)=>c.stopLongPress&&c.stopLongPress(...e)),onTouchcancel:t[4]||(t[4]=(...e)=>c.stopLongPress&&c.stopLongPress(...e)),onMouseenter:t[5]||(t[5]=(...e)=>c.handleMouseEnter&&c.handleMouseEnter(...e)),title:h.isHeaderExpanded?"收起导航和标题":"展开导航和标题"},(0,l.v_)(h.isHeaderExpanded?"▲":"▼"),41,n),(0,o.Lk)("button",{class:"settings-btn",onClick:t[6]||(t[6]=(...e)=>c.openSettings&&c.openSettings(...e)),title:"游戏设置"}," ⚙️ "),(0,o.bF)(m,{visible:h.showSettings,currentGame:c.currentGameName,onClose:c.closeSettings,onSettingsSaved:c.handleSettingsSaved},null,8,["visible","currentGame","onClose","onSettingsSaved"]),(0,o.bF)(a.eB,{name:"slide-down"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(h.navItems,t=>((0,o.uX)(),(0,o.Wv)(p,{key:t.path,to:t.path},{default:(0,o.k6)(()=>[(0,o.eW)((0,l.v_)(t.icon+(e.$route.path===t.path?s.title:"")),1)]),_:2},1032,["to"]))),128))],512),[[a.aG,h.isHeaderExpanded]])]),_:1}),(0,o.bF)(a.eB,{name:"slide-down"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.Lk)("div",{ref:"gameHeader",class:"game-header",style:(0,l.Tr)({top:h.navHeight/16+"rem"})},[(0,o.RG)(e.$slots,"top-controls",{},()=>[s.showTopControls?((0,o.uX)(),(0,o.Wv)(g,(0,o.v6)({key:0},s.gameControlsConfig,{onUndo:t[7]||(t[7]=t=>e.$emit("undo")),onGoon:t[8]||(t[8]=t=>e.$emit("goon")),onStep:t[9]||(t[9]=t=>e.$emit("step")),onAuto:t[10]||(t[10]=t=>e.$emit("auto"))}),null,16)):(0,o.Q3)("",!0)],!0)],4),[[a.aG,h.isHeaderExpanded]])]),_:3}),(0,o.Lk)("div",{class:"game-content-wrapper",style:(0,l.Tr)(c.contentWrapperStyle)},[(0,o.RG)(e.$slots,"game-content",{},void 0,!0)],4),s.showBottomControls||e.$slots["bottom-controls"]?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.RG)(e.$slots,"bottom-controls",{},()=>[s.showBottomControls?((0,o.uX)(),(0,o.Wv)(g,(0,o.v6)({key:0},s.gameControlsConfig,{onUndo:t[11]||(t[11]=t=>e.$emit("undo")),onGoon:t[12]||(t[12]=t=>e.$emit("goon")),onStep:t[13]||(t[13]=t=>e.$emit("step")),onAuto:t[14]||(t[14]=t=>e.$emit("auto"))}),null,16)):(0,o.Q3)("",!0)],!0)],512)):(0,o.Q3)("",!0),(0,o.RG)(e.$slots,"result-modals",{},()=>[s.winflag?((0,o.uX)(),(0,o.Wv)(b,{key:0,title:void 0!==s.winTitle?s.winTitle:"U WIN!",subtitle:s.winSubtitle,buttons:s.winButtons||c.defaultWinButtons,modalStyle:s.winModalStyle,customClass:s.winCustomClass},(0,o.eX)({_:2},[e.$slots["win-content"]?{name:"content",fn:(0,o.k6)(()=>[(0,o.RG)(e.$slots,"win-content",{},void 0,!0)]),key:"0"}:void 0,e.$slots["win-cards"]?{name:"cards",fn:(0,o.k6)(()=>[(0,o.RG)(e.$slots,"win-cards",{},void 0,!0)]),key:"1"}:void 0]),1032,["title","subtitle","buttons","modalStyle","customClass"])):(0,o.Q3)("",!0),s.loseflag?((0,o.uX)(),(0,o.Wv)(b,{key:1,title:void 0!==s.loseTitle?s.loseTitle:"U LOSE",subtitle:s.loseSubtitle,buttons:s.loseButtons||c.defaultLoseButtons,modalStyle:s.loseModalStyle||{backgroundColor:"rgba(0,0,0,0.5)"},customClass:s.loseCustomClass},(0,o.eX)({_:2},[e.$slots["lose-content"]?{name:"content",fn:(0,o.k6)(()=>[(0,o.RG)(e.$slots,"lose-content",{},void 0,!0)]),key:"0"}:void 0,e.$slots["lose-cards"]?{name:"cards",fn:(0,o.k6)(()=>[(0,o.RG)(e.$slots,"lose-cards",{},void 0,!0)]),key:"1"}:void 0]),1032,["title","subtitle","buttons","modalStyle","customClass"])):(0,o.Q3)("",!0),s.drawflag?((0,o.uX)(),(0,o.Wv)(b,{key:2,title:void 0!==s.drawTitle?s.drawTitle:"DRAW GAME",subtitle:s.drawSubtitle,buttons:s.drawButtons||c.defaultDrawButtons,modalStyle:s.drawModalStyle||{backgroundColor:"rgba(0,0,0,0.5)"},customClass:s.drawCustomClass},(0,o.eX)({_:2},[e.$slots["draw-content"]?{name:"content",fn:(0,o.k6)(()=>[(0,o.RG)(e.$slots,"draw-content",{},void 0,!0)]),key:"0"}:void 0,e.$slots["draw-cards"]?{name:"cards",fn:(0,o.k6)(()=>[(0,o.RG)(e.$slots,"draw-cards",{},void 0,!0)]),key:"1"}:void 0]),1032,["title","subtitle","buttons","modalStyle","customClass"])):(0,o.Q3)("",!0)],!0)])}var h=s(9974),c=s(5788);const m={class:"settings-modal"},p={class:"settings-header"},g={class:"settings-body"},b={class:"setting-item"},v=["value"],y={class:"setting-item"},f={class:"checkbox-container"},S={class:"settings-footer"};function T(e,t,s,l,i,n){return(0,o.uX)(),(0,o.Wv)(a.eB,{name:"modal-fade"},{default:(0,o.k6)(()=>[s.visible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"settings-overlay",onClick:t[5]||(t[5]=(0,a.D$)((...e)=>n.close&&n.close(...e),["self"]))},[(0,o.Lk)("div",m,[(0,o.Lk)("div",p,[t[6]||(t[6]=(0,o.Lk)("h2",null,"SETTING",-1)),(0,o.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>n.close&&n.close(...e))},"✕")]),(0,o.Lk)("div",g,[(0,o.Lk)("div",b,[t[7]||(t[7]=(0,o.Lk)("label",{class:"setting-label"},"SPEED",-1)),(0,o.Lk)("input",{type:"range",class:"delay-slider",value:i.localDelay,onInput:t[1]||(t[1]=(...e)=>n.handleDelayChange&&n.handleDelayChange(...e)),min:"0",max:"100",step:"1"},null,40,v),t[8]||(t[8]=(0,o.Lk)("div",{class:"slider-labels"},[(0,o.Lk)("span",null,"FAST"),(0,o.Lk)("span",null,"SLOW")],-1))]),(0,o.Lk)("div",y,[(0,o.Lk)("label",f,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>i.applyToAll=e)},null,512),[[a.lH,i.applyToAll]]),t[9]||(t[9]=(0,o.Lk)("span",{class:"checkbox-label"},"IS APPLY TO ALL GAMES",-1))])])]),(0,o.Lk)("div",S,[(0,o.Lk)("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...e)=>n.reset&&n.reset(...e))},"RESET"),(0,o.Lk)("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>n.save&&n.save(...e))},"SAVE")])])])):(0,o.Q3)("",!0)]),_:1})}var k=s(295),H={name:"GameSettings",props:{visible:{type:Boolean,default:!1},currentGame:{type:String,default:""}},data(){return{localDelay:50,applyToAll:!1,defaultDelay:50}},watch:{visible(e){e&&this.loadSettings()}},mounted(){this.loadSettings()},methods:{sliderToDelay(e){return Math.round(100+19*e)},delayToSlider(e){return Math.round((e-100)/19)},loadSettings(){const e=localStorage.getItem("game-global-delay"),t=localStorage.getItem(`game-delay-${this.currentGame}`);t?(this.localDelay=this.delayToSlider(parseInt(t)),this.applyToAll=!1):e?(this.localDelay=this.delayToSlider(parseInt(e)),this.applyToAll=!0):(this.localDelay=this.defaultDelay,this.applyToAll=!1)},handleDelayChange(e){this.localDelay=parseInt(e.target.value)},save(){const e=this.sliderToDelay(this.localDelay);k.A.saveDelay(this.currentGame,e,this.applyToAll),this.$emit("settings-saved",{delay:e,applyToAll:this.applyToAll,currentGame:this.currentGame}),this.close()},reset(){this.localDelay=this.defaultDelay,this.applyToAll=!1},close(){this.$emit("close")}}},C=s(1241);const w=(0,C.A)(H,[["render",T],["__scopeId","data-v-c5a013c2"]]);var $=w,L={name:"GameLayout",components:{GameControls:h["default"],GameResultModal:c["default"],GameSettings:$},data(){return{isHeaderExpanded:!0,navHeight:0,headerHeight:0,footerHeight:0,resizeObserver:null,lastScrollTop:0,lastToggleTime:0,toggleCooldown:500,autoHideTimer:null,showSettings:!1,longPressTimer:null,isLongPress:!1,isHovered:!1,longPressDuration:500,navItems:[{path:"/month",icon:"🌛"},{path:"/fish",icon:"🐟"},{path:"/blackjack",icon:"♠️"},{path:"/point24",icon:"24"},{path:"/Tortoise",icon:"🐢"},{path:"/Sort",icon:"🐗"},{path:"/Pairs",icon:"🐰"},{path:"/Spider",icon:"🕷️"},{path:"/Chess",icon:"♟️"}]}},props:{title:{type:String,default:""},containerStyle:{type:Object,default:()=>({width:"100%"})},showTopControls:{type:Boolean,default:!1},showBottomControls:{type:Boolean,default:!0},gameControlsConfig:{type:Object,default:()=>({})},winflag:{type:Boolean,default:!1},loseflag:{type:Boolean,default:!1},drawflag:{type:Boolean,default:!1},winTitle:String,winSubtitle:String,winButtons:Array,winModalStyle:Object,winCustomClass:String,loseTitle:String,loseSubtitle:String,loseButtons:Array,loseModalStyle:Object,loseCustomClass:String,drawTitle:String,drawSubtitle:String,drawButtons:Array,drawModalStyle:Object,drawCustomClass:String,step:{type:Number,default:0},enableSmartScroll:{type:Boolean,default:!0},smartScrollThreshold:{type:Number,default:50},autoHideDelay:{type:Number,default:2e3}},computed:{contentWrapperStyle(){const e=this.navHeight+this.headerHeight,t=this.footerHeight;return{...this.containerStyle,paddingTop:e/16+"rem",paddingBottom:t/16+"rem"}},defaultWinButtons(){return[{text:"GO ON",callback:()=>this.$emit("goon"),disabled:!1}]},defaultLoseButtons(){return[{text:"RESTART",callback:()=>this.$emit("goon"),disabled:!1},{text:"UNDO",callback:()=>this.$emit("undo"),disabled:this.step<=0}]},defaultDrawButtons(){return[{text:"RESTART",callback:()=>this.$emit("goon"),disabled:!1},{text:"UNDO",callback:()=>this.$emit("undo"),disabled:this.step<=0}]},currentGameName(){return this.$route?.path?.substring(1)||""}},mounted(){this.updateHeights(),this.setupResizeObserver(),this.setupScrollListener(),this.startAutoHideTimer()},beforeUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.removeScrollListener(),this.clearAutoHideTimer(),this.clearLongPressTimer()},methods:{toggleHeader(){this.isHeaderExpanded?this.collapseHeader():this.expandHeader()},updateHeights(){this.$nextTick(()=>{this.$refs.gameNav&&(this.navHeight=this.$refs.gameNav.offsetHeight),this.$refs.gameHeader&&(this.headerHeight=this.$refs.gameHeader.offsetHeight),this.$refs.gameFooter&&(this.footerHeight=this.$refs.gameFooter.offsetHeight)})},setupResizeObserver(){"undefined"!==typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{this.updateHeights()}),this.$nextTick(()=>{this.$refs.gameNav&&this.resizeObserver.observe(this.$refs.gameNav),this.$refs.gameHeader&&this.resizeObserver.observe(this.$refs.gameHeader),this.$refs.gameFooter&&this.resizeObserver.observe(this.$refs.gameFooter)}))},setupScrollListener(){this.$nextTick(()=>{const e=this.$el?.querySelector(".game-content-wrapper");e&&(this._scrollHandler=this.handleScroll.bind(this),e.addEventListener("scroll",this._scrollHandler,{passive:!0}))})},removeScrollListener(){const e=this.$el?.querySelector(".game-content-wrapper");e&&this._scrollHandler&&e.removeEventListener("scroll",this._scrollHandler)},handleScroll(e){if(!this.enableSmartScroll)return;const t=e.target,s=t.scrollTop,o=t.scrollHeight,l=t.clientHeight,a=s-this.lastScrollTop,i=a>0,n=a<0,r=s<=this.smartScrollThreshold,d=s+l>=o-this.smartScrollThreshold,u=Date.now(),h=u-this.lastToggleTime>=this.toggleCooldown;h&&(r&&n||d&&i)&&!this.isHeaderExpanded&&(this.lastToggleTime=u,this.expandHeader()),this.lastScrollTop=s},expandHeader(){this.isHeaderExpanded=!0,this.$nextTick(()=>{this.updateHeights()}),this.isLongPress||this.isHovered||this.startAutoHideTimer()},collapseHeader(){this.isLongPress||this.isHovered||(this.isHeaderExpanded=!1,this.$nextTick(()=>{this.updateHeights()}),this.clearAutoHideTimer())},startAutoHideTimer(){this.clearAutoHideTimer(),this.isLongPress||this.isHovered||(this.autoHideTimer=setTimeout(()=>{this.collapseHeader()},this.autoHideDelay))},clearAutoHideTimer(){this.autoHideTimer&&(clearTimeout(this.autoHideTimer),this.autoHideTimer=null)},startLongPress(){this.isLongPress=!1,this.clearLongPressTimer(),this.longPressTimer=setTimeout(()=>{this.isLongPress=!0,this.expandHeader(),this.clearAutoHideTimer()},this.longPressDuration)},stopLongPress(){this.clearLongPressTimer(),this.isLongPress=!1,this.isHeaderExpanded&&!this.isHovered&&this.startAutoHideTimer()},clearLongPressTimer(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)},handleMouseEnter(){this.isHovered=!0,this.expandHeader(),this.clearAutoHideTimer()},handleMouseLeave(){this.isHovered=!1,this.stopLongPress(),this.isHeaderExpanded&&this.startAutoHideTimer()},openSettings(){this.showSettings=!0},closeSettings(){this.showSettings=!1},handleSettingsSaved(e){this.$emit("settings-changed",e)}},emits:["undo","goon","step","auto","settings-changed"]};const A=(0,C.A)(L,[["render",u],["__scopeId","data-v-0e80c1b2"]]);var B=A},5788:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var o=s(6768),l=s(5130),a=s(4232);const i={key:0},n={key:1,class:"small"},r={class:"modal-buttons"},d=["value","onClick","disabled"];function u(e,t,s,u,h,c){return(0,o.uX)(),(0,o.Wv)(l.eB,null,{default:(0,o.k6)(()=>[((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,a.C4)(["lose",s.customClass]),style:(0,a.Tr)(s.modalStyle)},[s.title?((0,o.uX)(),(0,o.CE)("h1",i,(0,a.v_)(s.title),1)):(0,o.Q3)("",!0),s.subtitle?((0,o.uX)(),(0,o.CE)("h1",n,(0,a.v_)(s.subtitle),1)):(0,o.Q3)("",!0),(0,o.RG)(e.$slots,"content",{},void 0,!0),(0,o.RG)(e.$slots,"cards",{},void 0,!0),(0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.buttons,(e,t)=>((0,o.uX)(),(0,o.CE)("input",{key:t,type:"button",value:e.text,onClick:e.callback,disabled:e.disabled,class:"modal-button"},null,8,d))),128))])],6))]),_:3})}var h={name:"GameResultModal",props:{title:{type:String,default:""},subtitle:{type:String,default:""},buttons:{type:Array,default:()=>[]},modalStyle:{type:Object,default:()=>({})},customClass:{type:String,default:""}}},c=s(1241);const m=(0,c.A)(h,[["render",u],["__scopeId","data-v-644f8500"]]);var p=m},9974:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var o=s(6768);const l={class:"btns"},a=["value","disabled","onClick"];function i(e,t,s,i,n,r){return(0,o.uX)(),(0,o.CE)("div",l,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.displayButtons,(e,t)=>((0,o.uX)(),(0,o.CE)("input",{key:e.id||t,type:"button",value:e.label,disabled:e.disabled,onClick:t=>r.handleButtonClick(e.action)},null,8,a))),128))])}s(4114);var n={name:"GameControls",props:{buttons:{type:Array,default:()=>[]},showUndo:{type:Boolean,default:!0},showRestart:{type:Boolean,default:!0},showStep:{type:Boolean,default:!0},showAuto:{type:Boolean,default:!0},undoDisabled:{type:Boolean,default:!1},restartDisabled:{type:Boolean,default:!1},stepDisabled:{type:Boolean,default:!1},autoDisabled:{type:Boolean,default:!1},isAutoRunning:{type:Boolean,default:!1}},computed:{displayButtons(){if(this.buttons&&this.buttons.length>0)return this.buttons;const e=[];return this.showUndo&&e.push({label:"◀︎",action:"undo",disabled:this.undoDisabled}),this.showRestart&&e.push({label:"RESTART",action:"goon",disabled:this.restartDisabled}),this.showAuto&&e.push({label:this.isAutoRunning?"STOP":"AUTO",action:"auto",disabled:this.autoDisabled}),this.showStep&&e.push({label:"►",action:"step",disabled:this.stepDisabled}),e}},methods:{handleButtonClick(e){this.$emit(e)},undo(){this.$emit("undo")},goon(){this.$emit("goon")},stepFn(){this.$emit("step")},pass(){this.$emit("auto")}}},r=s(1241);const d=(0,r.A)(n,[["render",i],["__scopeId","data-v-04caeaca"]]);var u=d}}]);
//# sourceMappingURL=163.f55e1024.js.map